         MACRO
         HIERSEQ &PC,&PPC,&PLEV
         GBLA  &HSEQ(16)           SEGMENT LEVEL TABLE
         GBLA  &ORG                DATA BASE ORGANIZATION
         GBLB  &GB1(16)
         LCLA  &N
.*
.*
.*
         AIF   (&ORG NE 7 AND &ORG NE 12 AND &PC NE 1 AND &PLEV EQ 0).D
         AIF   (&PLEV GT 14 OR &PPC GE &PC).D
         AIF   (&ORG NE 7 AND &ORG NE 12 AND &PC NE 1).A  ROOT SEGMENT?
&HSEQ(1) SETA  1                   LOWEST ALLOWABLE PC AT THIS LEVEL
&N       SETA  2
         AGO   .B
.A       AIF   (&PPC NE &HSEQ(&PLEV)).D      IS PARENT LEGAL ?
&HSEQ(&PLEV)   SETA  &PPC     LOWEST ALLOWABLE PC AT THIS LEVEL
&HSEQ(&PLEV+1) SETA  &PC      LOWEST ALLOWABLE PC AT THIS LEVEL
&N       SETA  &PLEV+2
.B       ANOP
&HSEQ(&N) SETA 65535          SET REMAINDER OF LEVEL TABLE
&N       SETA  &N+1            TO NULL VALUES.
         AIF   (&N LE 16).B
.C       MEXIT
.D       MNOTE 8,'SEGM320 - HIERARCHY SEQUENCE ERROR. '
&GB1(16) SETB  1
         AIF   (&PLEV EQ 0 OR &PLEV GT 14).C
&HSEQ(&PLEV)  SETA  &PPC      LOWEST ALLOWABLE PC AT THIS LEVEL
         AGO   .A
         MEXIT
         MEND
