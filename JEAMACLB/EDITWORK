         MACRO
         EDITWORK &DSECT=YES
         AIF   ('&DSECT' NE 'YES').NODSCT
WDSECT   DSECT
         AGO   .CONT1
.NODSCT  ANOP
WDSECT   DS    0D
.CONT1   ANOP
OPERANDS DS    F                   ADDRESS OF NEXT OPERAND FIELD
ERROPNDS DS    F                   ADDRESS OF  LAST FIELD DELIMITED
OPERENDS DS    F                   END OF OPERANDS DETECTED BY SETDELIM
STACKTOP DS    F                   ADDRESS OF TOP OF CONSOLE STACK
FREESTAK DS    F                   ADDRESS OF FREE STACK ENTRY CHAIN
DATASTAK DS    F                   ADDRESS OF STACK OF DATA BLOCKS
CURRENT  DS    3F                  CURRENT RECORD ADDRESSES
DUMMY    DS    3F                  ANCHOR FOR CHAIN OF RECORDS
FILEREGS DS    2F                  SAVE AREA FOR GETMAIN REGISTERS
STACKREG DS    2F                  SAVE AREA FOR GATMAIN REGISTERS
SCRNREGS DS    2F                  SAVE AREA FOE GETMAIN REGISTERS
$DPREGS  DS    2F                  SAVE AREA FOR GETMAIN REGISTERS
$DPSAVE  DS    2F                  SAVE AREA FOR BLOCK OF RECORDS
$DPOFFST DS    F                   WORK AREA FOR $MOVE
INSTRING DS    F                   ADDRESS OF CHANGE INPUT STRING
OUSTRING DS    F                   ADDRESS OF CHANGE OUT STRING
INLENGTH DS    F                   LENGTH OF INPUT STRING
OULENGTH DS    F                   LENGTH OF REPLACE STRING
LOCLENTH DS    F                   LENGTH OF LOCATE COMMAND DATA
LOCDATA  DS    F                   ADDRESS OF LOCATE COMMAND DATA
CARDCNT  DS    F                   NUMBER OF CHANGE PER CARD
RECCNT   DS    F                   NUMBER OF RECORDS TO CHANGE
POINT    DS    F                   ADDRESS OF REPLACE POINT
RESTART  DS    F                   RESTART ADDRESS FOR COMPARE
WORKAREA DS    CL80                SAVE AREA FOR MANIPULATING CARDS
DBLWORD  DS    D                   WORK AREA
TPUTLEN  DS    F                   LENGTH OF SCREEN I/O AREA
SCREEN   DS    F                   ADDRESS OF GETMAINED SCREEN AREA
ERRMSG   DS    F                   ADDRESS OF ERROR MESSAGE AREA
DSNAREA  DS    F                   ADDRESS OF DATA SET NAME AREA
DATAAREA DS    F                   ADDRESS OF DATA PORTION OF SCREEN
CMNDLINE DS    F                   ADDRESS OF COMMAND LINE IN OUT BUF
DELADDR1 DS    F                   FIRST BLOCK IN A STRING TO BE FREED
DELADDR2 DS    F                   LAST  BLOCK IN A STRING TO BE FREED
SCSAVECR DS    3F                  SAVEAREA FOR 'CURRENT'
SFSAVECR DS    3F                  SAVEAREA FOR 'CURRENT'
GETSAVE  DS    F                   WORK SAVE AREA
LRECL    DS    H                   LENGTH OF A RECORD
RENWORK  DS    CL9                 WORK AREA FOR RENUMBER
DSNAME   DS    CL80                RETURNED NAME OF THE DATA SET
DATALNTH DS    H                   EFFECTIVE LENGTH OF THIS IO
COMMANDX DS    0CL126              RESTORE AREA FOR STACK ENTRY
AID      DS    XL6
COMMAND  DS    CL120                  RETURN AREA FOR COMMANDS
         DS    C                    OVERFLOW AREA
SAVECMND DS    CL120               SAVE AREA FOR COMMANDS AGAINST '='
TGETDATA DS    0CL6                START OF TGET PARAMETER AREAS
IOAID    DS    X                  INPUT DATA TYPE IDENTIFIER
CURSORID DS    XL2
INPUTSBA DS    XL3
IOAREA   DS    CL120              INPUT IOAREA FROM CONSOLE
         SPACE 2
***********************************************************************
* WORK AREAS.    THESE AREAS MUST BE INTIIALISED FOR EACH USER
***********************************************************************
         SPACE 2
TOBEINIT DS    0D                  START OF AREA TO BE INITIALISED
ENDZONE  DC    F'80'               END ZONE DEFAULT VALUE
STRTZONE DC    F'0'                START ZONE DEFAULT VALUE
COLSTART DC    F'0'                DEFAULT START COLUMN FOR DISPLAY
WORKFLAG DC    X'00'               PROCESSING FLAG
SAVEFLG  EQU   X'80'               SAVE OPERATION REQUESTED
IN1LINE  EQU   X'40'               SINGLE LINE INPUT MODE
SUBMTFLG EQU   X'20'               SUBMIT IN OPERATION
PFKCASE  EQU   X'10'               PA2 HAS BEEN HIT PRIOR TO A PFK
DANGER   EQU   X'08'               CHANGED DATA MAY NOT BE RE-READ
TABCOL1  EQU   X'04'               TAB HAS JUST MOVED CURSOR TO COL 1
$DPFLAG  DC    X'00'
$DPMOVE  EQU   X'80'               A DP OPERATION REQUIRING DELETION
OPENLIST OPEN  (0,INPUT),MF=L      OPEN PARAMETER LIST
CLOSLIST CLOSE (0),MF=L            CLOSE PARAMETER LIST
SYSUT1   DCB   DDNAME=SYSUT1,DSORG=PS,MACRF=(GM,PM)
         AIF   ('&DSECT' NE 'YES').NODSCT2
UT501D   CALL  ,(0,0,0,0,0),VL,MF=L
         AGO   .CONT2
.NODSCT2 ANOP
UT501D   CALL  ,(JCLDATA,FUNCTION,RETCODE,A,B),VL,MF=L
.CONT2   ANOP
UT501S   LINK  EP=UT501,SF=L
JCLDATA  DC    H'80'               LENGTH OF JCL CARD
         DC    C'//SYSUT1 DD DISP=SHR,DSN='
JCLDSN   DC    CL54' '             SPACE FOR DATA SET NAME
         DC    C' '                PADDING JUST IN CASE
RETCODE  DC    X'00'               RETURN CODE FROM UT501
A        DS    F                   NOT USED
B        DS    F                   NOT USED
PFKSCRN  DS    0F                   START OF SCREEN AREA
         DC    X'40115D7F1140401DC813'
         DC    C'SET PF1 IMM '
PFAREA1  DC    CL80'LE20'           PFK DATA
         DC    X'11C1501DC8'
         DC    C'SET PF2 IMM '
PFAREA2  DC    CL80'RI20'           PFK DATA
         DC    X'11C2601DC8'
         DC    C'SET PF3 IMM '
PFAREA3  DC    CL80'T'              PFK DATA
         DC    X'11C3F01DC8'
         DC    C'SET PF4 IMM '
PFAREA4  DC    CL80'N12'            PFK DATA
         DC    X'11C5401DC8'
         DC    C'SET PF5 IMM '
PFAREA5  DC    CL80'U12'            PFK DATA
         DC    X'11C6501DC8'
         DC    C'SET PF6 IMM '
PFAREA6  DC    CL80'B'              PFK DATA
         DC    X'11C7601DC8'
         DC    C'SET PF7 IMM '
PFAREA7  DC    CL80'TAB 1 10 16 36 71'  PFK DATA
         DC    X'11C8F01DC8'
         DC    C'SET PF8 IMM '
PFAREA8  DC    CL80'$DUP'           PFK DATA
         DC    X'114A401DC8'
         DC    C'SET PF9 IMM '
PFAREA9  DC    CL80'QUIT'           PFK DATA
         DC    X'114B501DC8'
         DC    C'SET PF10 IMM '
PFAREA10 DC    CL80'='              PFK DATA
         DC    X'114C601DC8'
         DC    C'SET PF11 IMM '
PFAREA11 DC    CL80'FILE'           PFK DATA
         DC    X'114DF01DC8'
         DC    C'SET PF12 IMM '
PFAREA12 DC    CL80'PFK'            PFK DATA
         DC    X'114F401DC8'
         DC    C'SET PF13 IMM '
PFAREA13 DC    CL80' '              PFK DATA
         DC    X'1150501DC8'
         DC    C'SET PF14 IMM '
PFAREA14 DC    CL80' '              PFK DATA
         DC    X'11D1601DC8'
         DC    C'SET PF15 IMM '
PFAREA15 DC    CL80' '              PFK DATA
         DC    X'11D2F01DC8'
         DC    C'SET PF16 IMM '
PFAREA16 DC    CL80' '              PFK DATA
         DC    X'11D4401DC8'
         DC    C'SET PF17 IMM '
PFAREA17 DC    CL80' '              PFK DATA
         DC    X'11D5501DC8'
         DC    C'SET PF18 IMM '
PFAREA18 DC    CL80' '              PFK DATA
         DC    X'11D6601DC8'
         DC    C'SET PF19 IMM '
PFAREA19 DC    CL80' '              PFK DATA
         DC    X'11D7F01DC8'
         DC    C'SET PF20 IMM '
PFAREA20 DC    CL80' '              PFK DATA
         DC    X'11D9401DC8'
         DC    C'SET PF21 IMM '
PFAREA21 DC    CL80' '              PFK DATA
         DC    X'115A501DC8'
         DC    C'SET PF22 IMM '
PFAREA22 DC    CL80' '              PFK DATA
         DC    X'115B601DC8'
         DC    C'SET PF23 IMM '
PFAREA23 DC    CL80' '              PFK DATA
PFKSCLEN EQU   *-PFKSCRN+40          LENGTH FOR WRITE
         DC    X'115CF01DC8'
         DC    C'SET PF24 IMM '
PFAREA24 DC    CL80'Z 1 71@SET PF6 IMM RENUM 1000 1000@L''ZCSECT''' PFK
         MEND
