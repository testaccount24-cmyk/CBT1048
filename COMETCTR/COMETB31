*
*        START 'COMETB31' BUDGIE3 CONTROL CARDS
*
MS01  THE PURPOSE OF THIS BUDGIE IS TO REFORMAT VARIOUS TWENTY80 ANALYSES
SKIP3
*        THE PARM FIELD MUST SPECIFY:
*              COM=*,NOSEQ,CB=5220
SKIP3
*        SYSUT2 DCB MUST SPECIFY:
*              RECFM=FBA,LRECL=133,BLKSIZE=133
SKIP3
*        THE REPORTS PROCESSED ARE:-
SKIP1
*              T375P31 - ACTIVITY ON INPUT LINES
*              T375P32 - ACTIVITY ON IN/OUT AND OUTPUT LINES
*              T375P33 - ACTIVITY ON LEASED LINES
*              T375P34 - ANALYSIS OF CALL DURATION ( SUMMING CALL DURATION )
*              T375P35 - ANALYSIS OF CALL DURATION ( SUMMING CALL COST )
SKIP3
*        WORKING STORAGE
SKIP1
*              134-141 - REPORT NAME
*              142-148 - MATHS WORK AREA
*              149-150 - UNUSED
EJECT
*        A LINE WITH A '1' IN POSITION 1 ( ASA EJCT ) IS TREASED AS A BATCH CA
SKIP1
MS020111                     1331        228            150
SKIP3
*        THE REPORT NAME IS PRESERVED IN WORKING STORAGE TO DETERMINE PROCESSING
SKIP1
MS13                                     C3  M1   *PRESERVE REPORT NAME
MS33M102208MV13408
SKIP3
*        AN UNQUALIFIED MS11 TREATS EVERYTHING ELSE AS DETAIL
SKIP1
MS11
MS131347        EQT375P31                S   P1   *PROCESS REPORT TYPE  T375P31
MS131347        EQT375P32                S   P1   *PROCESS REPORT TYPE  T375P32
MS131347        EQT375P33                S   P1   *PROCESS REPORT TYPE  T375P33
MS131347        EQT375P34                S   S1   *PROCESS REPORT TYPE  T375P34
MS131347        EQT375P35                S   T1   *PROCESS REPORT TYPE  T375P35
TITLET375P31/32/33 PROCESSING - CONVERT SECONDS TO MINUTES, AND ALTER CXTU
SKIP3
*        THIS SUBROUTINE IS THE MAIN-LINE LOGIC FOR REPORT TYPES T375P31/32/33
SKIP1
MS40P1
SKIP3
*        PROCESS THE 'RANGEH LINE TO ALTER HEADINDS
SKIP1
MS130135        EQRANGE                  S   P2   *REPLACE THE HEADINGS
SKIP3
*        PROCESS THE DETAIL LINES
SKIP1
MS130134        EQTHAN                   S   P3   *ALTER VALUES
MS130134        EQ  TO                   S   P3   *ALTER VALUES
MS130135        EQ  AND                  S   P3   *ALTER VALUES
MS130194        EQOVER              01909E3           OTHER
MS41P1
SKIP3
*        REPLACE REPORT HEADINGS
SKIP1
MS40P2
MS13                                01305E2       *BLANK OUT 'RANGE'
MS13                                02404E3       CXTU
MS13                                03407E3         CALLS
MS13                                05208E3       DURATION
MS13                                07407E3         CALLS
MS13                                09308E3       DURATION
MS41P2
SKIP3
*        CONVERT SECONDS TO HOURS, MINUTES AND SECONDS, AND INSERT LEADING '0'
SKIP1
MS40P3
MS13                                02404NB       *ZEROISE LEADINGS BLANKS CXTU
MS13                                     S   S4   *CONVERT VALUE TO MINUTES
MS13                                     S   S5   *CONVERT CUM VALUE TO MINUTES
MS13                                00217E2       *BLANK OUT START OF LINE
MS41P3
TITLET375P34 PROCESSING - CONVERT SECONDS TO HOURS, MINUTES, AND SECONDS
SKIP3
*        THIS SUBROUTINE IS THE MAIN-LINE LOGIC FOR REPORT TYPE T575P34
SKIP1
MS40S1
SKIP3
*        PROCESS THE 'LESS THAN' LONE
SKIP1
MS130134        EQTHAN                   S   S3   *CONVERT UPPER RANGE TO MINS
MS130134        EQTHAN                   S   S4   *CONVERT VALUE TO MINS
MS130134        EQTHAN                   S   S5   *CONVERT CUM VALUE TO MINS
SKIP3
*        PROCESS THE 'X TO Y' LINES
SKIP1
MS130134        EQ  TO                   S   S2   *CONVERT LOWER RANGE TO MINS
MS130134        EQ  TO                   S   S3   *CONVERT UPPER RANGE TO MINUTE
MS130134        EQ  TO                   S   S4   *CONVERT VALUE TO MINS
MS130134        EQ  TO                   S   S5   *CONVERT CUM VALUE TO MINS
SKIP3
*        PROCESS THE 'AND OVER ' LINE
SKIP1
MS130135        EQ  AND                  S   S2   *CONVERT LOWER RANGE TO MINS
MS130135        EQ  AND                  S   S4   *CONVERT VALUE TO MINS
MS130135        EQ  AND                  S   S5   *CONVERT CUM VALUE TO MINS
SKIP3
*        PROCESS THE 'RANGE' LINE - TO ALTER THE HEADINGS
SKIP1
MS130135        EQRANGE                  S   S6   *REPLACE THE HEADINGS
SKIP3
*        END OF MAIN-LINE FOR T375P34
MS41S1
EJECT
*        CONVERT THE 'FROM' RANGE TO MINUTES AND SECONDS
MS40S2
SKIP3
*        CONVERT SECONDS TO MINUTES AND SECONDS
SKIP1
MS13                                     C7  M2   *CONVERT SECS TO MINS
MS36M2/00804  LIT    00702  N              6001002
SKIP3
*        ADD PUNCTUATION
SKIP1
MS13                                00901E2  .    *ADD PUNCTUATION
SKIP3
*        BLANK OUT ANY LEADING ZEROES IN THE MINUTES FIELD
SKIP1
MS130072        EQ00                00702E2       *BLANK OUT 2 LEADING ZEROES
MS130071        EQ0                 00701E2       *BLANK OUT 1 LEADING ZERO
MS41S2
SKIP3
*        CONVERT THE 'TO' RANGE TO MINUTES AND SECONDS
MS40S3
SKIP3
*        CONVERT SECONDS TO MINUTES AND SECONDS
SKIP1
MS13                                     C7  M4   *DIVIDE UPPER RANGE BY 60 FOR
MS36M4/02404  LIT    02302  N              6002602
SKIP3
*        ADD PUNCTUATION AND BLANK OUT LEADING ZEROES
SKIP1
MS13                                02501E2  .    *ADD PUNCTUATION
MS130232        EQ00                02302E2       *BLANK OUT 2 LEADING ZEROES
MS130231        EQ0                 02301E2       *BLANK OUT 1 LEADING ZERO
MS41S3
EJECT
*        CONVERT VALUE TO HOURS, MINUTES, AND SECONDS
MS40S4
SKIP3
*        CONVERT SECONDS INTO HOURS, MINUTES AND SECONDS
SKIP1
MS13                                     C7  A1   *DIVIDE SECS INTO MINS
MS13                                     C7  A2   *DIVIDE MINS INTO HOURS
MS36A1/05109  LIT    14207  N              6005802
MS36A2/14207  LIT    05103  N              6005502
SKIP3
*        ADD PUNCTUATION, AND BLANK OUT LEADING ZEROES
SKIP1
MS13                                05401E2  .    *ADD PUNCTUATION
MS13                                05701E2  .    *ADD PUNCTUATION
MS130513        EQ000               05104E2       *BLANK OUT 3 LEADING ZEROES
MS130512        EQ00                05102E2       *BLANK OUT 2 LEADING ZEROES
MS130511        EQ0                 05101E2       *BLANK OUT 1 LEADING ZERO
MS41S4
SKIP3
SKIP3
*        CONVERT CUMULATIVE VALUE INTO HOURS, MINUTES AND SECONDS
MS40S5
SKIP3
*        CONVERT SECONDS INTO HOURS, MINUTES AND SECONDS
SKIP1
MS13                                     C7  B1   *DIVIDE SECS INTO MINS
MS13                                     C7  B2   *DIVIDE MINS INTO HOURS
MS36B1/09209  LIT    14207  N              6009902
MS36B2/14207  LIT    09104  N              6009602
SKIP3
*        ADD PUNCTUATION, AND BLANK OUT LEADING ZEROES
SKIP1
MS13                                09501E2  .    *ADD 1ST PUNCTUATION
MS13                                09801E2  .    *ADD 2ND PUNCTUATION
MS130914        EQ0000              09105E2       *BLANK OUT 4 LEADING ZEROES
MS130913        EQ000               09103E2       *BLANK OUT 3 LEADING ZEROES
MS130912        EQ00                09102E2       *BLANK OUT 2 LEADING ZEROES
MS130911        EQ0                 09101E2       *BLANK OUT 1 LEADING ZERO
MS41S5
SKIP3
SKIP3
*        ALTER HEADINGS
MS40S6
MS13                                01213E3       CALL DURATION
MS13                                03407E3         CALLS
MS13                                05208E3       DURATION
MS13                                07407E3         CALLS
MS13                                09308E3       DURATION
MS41S6
TITLET375P35 PROCESSING - CONVERT SECONDS TO MINUTES AND SECONDS
SKIP3
*        THIS SUB-ROUTINE IS THE MAIN-LINE LOGIC FOR REPORT TYPE T375P35
SKIP1
MS40T1
SKIP3
*        PROCESS THE 'LESS THAN' LINE
SKIP1
MS130134        EQTHAN                   S   S3   *CONVERT UPPER RANGE TO MINUTE
SKIP3
*        PROCESS THE 'X TO Y' LINES
SKIP1
MS130134        EQ  TO                   S   S2   *CONVERT LOWER RANGE TO MINS
MS130134        EQ  TO                   S   S3   *CONVERT UPPER RANGE TO MINS
SKIP3
*        PROCESS THE 'AND OVER' LINE
SKIP1
MS130135        EQ  AND                  S   S2   *CONVERT LOWERRANGE TO MINS
SKIP3
*        PROCESS THE RANGE LINE'
SKIP1
MS130135        EQRANGE                  S   T2   *REPLACE HEADINGS
SKIP1
*        END OF MAIN-LINE FOR T375P35
MS41T1
SKIP3
*        ALTER HEADINGS
SKIP1
MS40T2
MS13                                01213E3       CALL DURATION
MS13                                03407E3         CALLS
MS13                                05209E3       COST (BF)
MS13                                07407E3         CALLS
MS13                                09309E3       COST (BF)
MS41T2
*
*        END OF 'COMETB31' BUDGIE3 CONTROL CARDS
*
