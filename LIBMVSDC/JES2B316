***(ID)                            JES2B316
***(SUBSYSTEM)                     JES2
***(DESIGNER)                      D.A.MOORCROFT
***(AUTHOR)                        J.NOLS
*
***(DATE WRITTEN)                  JUNE 1977.
***(DATE TESTED)                   JUNE 1977.
***(DATE INSTALLED)                JUNE 1977.
*
***(ABSTRACT)
*
*        WE ASSIGN A RETENTION PERIOD TO ALL OUR PERMANENT DATA SETS
*         WHEN THEY ARE CREATED, BY SPECIFYING A RETENTION PERIOD IN THE
*         JCL. ( IF NO RETENTION PERIOD IS SPECIFIED, THEN THE DATA SET
*         WILL BE ELIGIBLE FOR SCRATCH ON THE NEXT DAY ).  HOWEVER, WE DO
*         NOT WISH TO OVERBURDEN THE OPERATOR WITH CONSTANT REQUESTS FOR
*         PERMISSION TO MODIFY DATE-PROTECTED DATA SETS, SO IN HASP WE
*         CONVERT A RETPD PARAMETER OF THE FORM
*              RETPD=NN
*         TO AN EXPDT PARAMETER OF THE FORM
*              EXPDT=000NN
*
*        OUR DAILY DISK CLEAR-UP JOB ADDS THE EXPIRY DATE TO THE CREATION
*         DATE TO OBTAIN THE TRUE EXPIRY DATE, AND THEN DECIDES WHETHER
*         THE DATA SET IS ELIGIBLE FOR SCRATCH.
*
*        NOTES:-
*         1. IF THE RETENTION PERIOD IS GREATER THAN 365, THEN IT IS NOT
*            CONVERTED INTO AN EXPIRY DATE.
*         2. THIS SYSTEM IS PART OF OUR IMPLEMENTATION OF EXPIRY-DATE
*            PROCESSING.  DATA SETS THAT ARE TO BE KEPT PERMANENTLY
*            WITHOUT OPERATOR-LEVEL DATE-PROTECTION ARE ASSIGNED AN EXPIRY
*            DATE OF '11111', WHILE PERMANENT DATA SETS WITH OPERATOR-LEVEL
*            DATE-PROTECTION ARE ASSIGNED EXPIRY DATES OF '99365'.
*            DATA SETS THAT ARE TO BE KEPT FOR A NUMBER OF CALENDAR YEARS
*            ARE ASSIGNED AN EXPIRY DATE OF THE FORM
*              EXPDT=0N000
*
*        ( UNDER HASP 3.1 THIS WAS PART OF MODIFICATION 'M064' ).
*
***(LOGIC SUMMARY)
*
*        AT APPROPRIATE POINT IN THE HASP JCL CONVERSION ROUTINE
*         IN HASPXEQ MODULE, INVOKE THIS EXIT WITH AN UNQUALIFIED
*         $CBAL, THUS ;-
*
*          $CBAL  JES2B316
*
*        WITHIN THE EXIT ITSELF, SCAN THE TEXT OF CURRENT DD STATEMENT
*         LOOKING FOR 'RETPD' PARAMETER.
*           IF NOT FOUND, RETURN TO JES2.
*           IF FOUND, REPLACE 'RETPD' BY 'EXPDT' AND  SET AS VALUE OF
*            'EXPDT' THE SAME VALUE AS 'RETPD', BUT 'EXPDT' VALUE-FIELD
*            MUST BE 5 POSITIONS PADDED WITH '00000' BEFORE MOVE
*            RIGHT OF 'RETPD' VALUE.
*
*        SEPTEMBER 1977.
*        ===============
*
*         BECAUSE THE VALUE ENTERED WITH 'RETPD' PARAMETER IS CONSIDERED
*          AS NUMBER OF WORKING DAYS, B316 HAS BEEN MODIFIED TO CONVERT
*          THE VALUE IN CALENDAR-DAYS.
*
*         TO ESTABLISH THE NUMBER OF CALENDAR-DAYS THE FOLLOWING FORMULAS
*          WILL BE USED :-
*
*              WORKING-DAYS
*       DIVIDE ------------ = NUMBER OF WEEK(S), IF QUOTIENT IS 0 :-
*                BY 5         =================
*                                     *           THE NUMBER OF CALENDAR-DAYS
*                                    ** *          WILL BE THE NUMBER OF
*                                     *            WORKING-DAYS + 2.
*                             IF NOT 0 :-
*
*                           NUMBER OF WEEK(S)
*                          MULTIPLY BY 7 DAYS
*                        ---------------------
*                         =     XYZ
*                         +  REMAINDER OF PRECEDING DIVISION
*                        ---------------------
*                         = NUMBER OF CALENDAR-DAYS
*
*
***(INSTALLATION)
*
*        THIS IS A MONSANTO JES2 MOD DYNAMICALLY LOADED AT
*        INITIALISATION TIME UPON REQUEST VIA AN 'EXIT=' CONTROL CARD.
*
***(TESTING)
*
*
*        TO TEST :-
*
*         SUBMIT AND EXECUTE 'TESTB316' JOB WITH THE JES2
*          TEST SYSTEM.
*
*           YOU WILL FIND THIS JOB IN 'LIBRARYN.MVS' DATA SET,
*            MEMBER 'TESTB316', PASSWORD 'T316'
*
*        RESULT TO BE OBTAINED :-
*
*          SEE JCL PRINT-OUT OF THIS JOB.
