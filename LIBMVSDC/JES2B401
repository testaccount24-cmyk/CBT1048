***(ID)                            JES2B401
***(SUBSYSTEM)                     JES2
***(DESIGNER)                      D.A.MOORCROFT
***(AUTHOR)                        D.A.MOORCROFT
*
***(DATE WRITTEN)                   3 JUNE 77
***(DATE TESTED)                    4 JUNE 77
***(DATE INSTALLED)                 4 JUNE 77
*
***(ABSTRACT)
*
*
*        TO MINIMISE THE IMPACT OF MVS TO OUR USERS, WE INTEND TO USE THE
*         SAME JOB CARD ACCOUNTING INFORMATION FORMAT THAT WE USE UNDER HASP.
*         OUR FORMAT DIFFERS SIGNIFICANTLY FROM THE HASP/JES2 DEFAULT, AND
*         THIS MODIFICATION RECOGNISES OUR FIELDS, ASSIGNS DEFAULT VALUES
*         WHERE APPROPRAITE, AND STORES THEM IN THE JCT AS NECESSARY.
*
*        NOTE THAT THIS ROUTINE DOES NOT VALIDATE THE ACCOUNTING DATA
*         IN ANY WAY ( OTHER THAN TO ENSURE THAT IT DOES NOT ABEND
*         WITH AN 0C7 ).  ALL ACCOUNTING DATA FIELD VALIDATION IS PERFORMED
*         BY OUR JOB/STEP VALIDATION EXIT IEFUJI.
*
*        THE FORMAT OF OUR ACCOUNTING DATA IS :-
*         .CHARGE-CODE             - 4 NUMERIC CHARACTERS
*         .CATEGORY-CODE           - NUMERIC, LENGTH 1 - 4
*         .MAJOR COST CENTRE       - NUMERIC, LENGTH 3
*         .MINOR COST CENTRE       - NUMERIC, LENGTH 2
*         .ENTITY CODE             - 'E' FOLLOWED BY 2-DIGIT NUMBER
*                                    ( IGNORED IF 1ST CHARACTER NOT 'E' )
*         .FORMS TYPE              - ALPHAMERIC, LENGTH 4
*         .NUMBER OF COPIES        - MUMERIC, LENGTH 1 - 4
*         .CPU-TIME LIMIT          - NUMERIC, LENGTH 1 - 4
*                                    DEFAULTS: 5-MINS FOR TESTS
*                                              NO LIMIT FOR PRODUCTION
*         .NO. OF LINES LIMIT      - OUTPUT LINECOUNT LIMIT IN THOUSANDS
*                                    DEFAULTS: 10 FOR TESTS
*                                              NO LIMIT FOR PRODUCTION
*         .NO. OF CARDS LIMIT      - OUTPUT CARD COUNT LIMIT
*                                    DEFAULTS: 1000 FOR TESTS
*                                              NO LIMIT FOR PRODUCTION
*         .SUPPRESS JOB LOG        - 'N' SUPPRESSES JOB LOG IN OUTPUT
*         .LINECNT LIMIT FOR PAGE  - NUMBER OF LINES TO BE PRINTED BEFORE
*                                    A PAGE-SKIP IS FORCED.  BY DEFAULT, NO
*                                    PAGE-SKIPPING IS FORCED.
*
*        ( UNDER HASP 3.1 THIS WAS PART OF MOD NUMBERS 'M007' & 'M068')
*
***(LOGIC SUMMARY)
*
*        THE ROUTINE IS INVOKED FROM THE JES2 ACCOUNTING FIELD SCAN ROUTINE
*         ( HASPRSCN ) IN HASPRDR BY A $CBAL OF THE FORM
*              $CBAL B401,YES=RSCNRET
*        THIS $CBAL FOLLOWS THE CODE THAT ESTABLISHES DEFAULT VALUES IN
*         JCT, POINTS R1 AT THE FIRST CHARACTER IN THE ACCOUNTING DATA,
*         SETS A DELIMITER OF X'FF' AT THE END OF THE ACCOUNTING DATA,
*         AND POINTS R15 AT THE DELIMITER.  IT IMMEDIATELY PRECEDES THE
*         TEST OF THE JES2 JOB CARD SCAN OPTION.
*        THE ROUTINE ALWAYS RETURNS A 'YES' CONDITION ( COND CODE EQUAL ),
*         AND THUS THE JES2 VALIDATION IS BYPASSED.
*
*        THE ROUTINE EXAMINES EVERY FIELD IN THE ACCOUNTING FIELD, AND
*         STORES EACH IN THE RELEVANT SLOT IN THE JCT.  THE SECOND PARAMETER
*         ( CATEGORY CODE ) IS EXAMINED, AND IF IT IS < 9 THE JOB IS ASSUMED
*         NOT TO BE A PRODUCTION JOB, AND THE DEFAULT VALUES FOR TIME, LINES
*         AND CARDS - WHICH HAVE BEEN ESTABLISHED BY HASPRSCN - ARE CHANGED
*         TO THE NON-PRODUCTION DEFAULT VALUES.
*
***(INSTALLATION)
*
*
*        THIS IS A MONSANTO JES2 MODIFICATION DYNAMICALLY LOADED AT
*        INITIALISATION TIME UPON REQUEST VIA AN 'EXIT=' CONTROL CARD.
*
*
***(TESTING)
*
*
*        TO TEST :-
*
*         SUBMIT AND EXECUTE THE JOBS 'TESTB401' IN THE JES2 TEST SYSTEM.
*
*         YOU WILL FIND THESE JOBS IN 'LIBRARYN.MVS' DATA SET,
*           MEMBER 'TESTB401', PASSWORD 'T401'.
*
*
*        RESULT TO BE OBTAINED :-
*
*        EACH JOB TESTS ONE OR MORE OF THE ACCOUNTING FIELDS,
*         AND IS SELF-DOCUMENTING.
