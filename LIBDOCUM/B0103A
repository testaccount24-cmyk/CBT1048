1************
 * B0103A   *
 ************
0B0103A
 ------
01. PURPOSE
 ----------
0   SUBROUTINE B0103A CREATES A DATA SET ON DIRECT ACCESS
    DEVICES USING THE ISAM MACROS.  THE ISAM FILE CAN THEN
    BE ACCESSED BY THE B0103C SUBROUTINE.
02. LIMITATIONS
 --------------
0   1.   THE ISAM FILE WILL BE CONSTRUCTED WITH FIXED LENGTH
         BLOCKED RECORDS.
0   2.   RECORDS MUST BE IN SEQUENTIAL ORDER BY KEY AT THE
         TIME THE ISAM DATA SET IS CREATED.
0   3.   USERS MUST SUPPLY DD CARDS FOR SYSOUT AND SYSABEND
         IF THE CATALOGUED PROCEDURE USED DOES NOT.
03. INPUT DATA
 -------------
0   NONE.
04. OUTPUT DATA
 --------------
0   THE OUTPUT IS AN INDEXED SEQUENTIAL DATA SET AS DESCRIBED
    BY THE USER ON THE DD CARD FOR THE FILE.  THE DCB ATTRIBUTES
    THAT MUST BE PRESENT ARE DESCRIBED IN SECTION VI.
05. OPERATION
 ------------
0   CALLING SEQUENCE:
0   COBOL
 --------
         ENTER LINKAGE.
         CALL 'B0103A' USING ARG1, ARG2, ARG3, ARG4.
         ENTER COBOL.
0   ARG1      THE NAME OF AN 8 CHARACTER LENGTH FIELD WHICH
              CONTAINS THE EXTERNAL DDNAME, LEFT-JUSTIFIED,
              THAT REFERENCES THE DATA SET.
1************
 * B0103A   *
 ************
0   ARG2      THE NAME OF A 1 POSITION ALPHA FIELD WHICH CONTAINS
              ONE OF THE FOLLOWING VALUES:
              O - OPEN REQUEST OF THE FILE IDENTIFIED
                  BY ARG1.
              W - WRITE REQUEST OF THE RECORD IDENTIFIED
                  BY ARG3 FOR THE FILE IN ARG1.
              C - CLOSE REQUEST OF THE FILE IDENTIFIED BY
                  ARG1.  CLOSE MUST BE ISSUED BY USER BEFORE
                  TERMINATING JOB.
0   ARG3      THE NAME OF THE FIELD FROM WHICH THE RECORD TO BE
              WRITTEN WILL BE TAKEN.
0   ARG4      THE NAME OF A ONE POSITION ALPHA FIELD THAT WILL
              CONTAIN THE RETURN CODE.  THE FOLLOWING IS A LIST
              OF THESE CODES AND THEIR MEANING:
              0 - SUCCESSFUL COMPLETION OF THE REQUESTED
                  OPERATION
              U - UNEXPLAINABLE I/O ERROR
              N - SUFFICIENT SPACE NOT ALLOCATED FOR DATA SET
              P - UNCORRECTABLE OUTPUT ERROR
              S - RECORD KEYS OUT OF SEQUENCE
              D - RECORD KEYS DUPLICATED
              C - DCB CLOSED WHEN ERROR ROUTINE ENTERED
0   NOTE:     DO NOT CONTINUE PROCESSING IF OPERATION REQUESTED
              IS NOT SUCCESSFUL.  RESULTS ARE UNPREDICTABLE.  THE
              USER SHOULD RECORD THE ERROR CODE FOR DATA DEBUG.
1************
 * B0103A   *
 ************
06. THE FOLLOWING DCB PARAMETERS MUST BE PRESENT IN THE USER'S
0   JCL:
         DSORG=IS       INDEXED SEQUENTIAL METHOD
         OPTCD=W        PERFORM WRITE VALIDITY CHECK
               M        CREATE MASTER INDEXES AS REQUIRED
               Y        USE CYLINDER OVERFLOW AREAS
               I        USE INDEPENDENT OVERFLOW AREA
               L        DELETE OPTION ON RECORDS
               R        PROVIDE REORGANIZATION CRITERIA FEEDBACK
         (OPTCD=WMYILR IS THE RECOMMENDED STANDARD)
         RECFM=FB       FIXED LENGTH BLOCKED RECORDS
         LRECL=         LOGICAL RECORD LENGTH + 1
         BLKSIZE=       INTEGRAL MULTIPLE OF LRECL
         RKP=           RELATIVE KEY POSITION IN THE RECORD; E.G.
                        KEY STARTS IN COLUMN 1 OF RECORD, RKP=1
         KEYLEN=        THE LENGTH OF THE RECORD KEY
         NTM=           NUMBER OF TRACKS TO BE CONTAINED IN A
                        CYLINDER INDEX BEFORE HIGHER LEVEL INDEX
                        IS  CREATED
         CYLOFL=        NUMBER OF TRACKS TO BE RESERVED ON EACH
                        CYLINDER TO HOLD OVERFLOW RECORDS FROM
                        TRACKS ON THAT CYLINDER.
07. EXAMPLE
 ----------
0   COBOL:
    ------
         01   ARG1      PICTURE X(8)   VALUE 'ISAM23  '.
         01   ARG2      PICTURE X      VALUE 'W'.
         01   ARG3.
              03 RECORD-KEY            PICTURE 9(12).
              03 DATA1                 PICTURE X(10).
              03 DATA2.
                 05     AREA-1         PICTURE X(12).
                 05     AREA-2         PICTURE 9(6).
              03 DATA3                 PICTURE X(120).
1************
 * B0103A   *
 ************
0   COBOL (CONT.)
    -----
         01   ARG4      PICTURE X      VALUE '0'.
                   .
                   .
                   .
         ENTER LINKAGE.
         CALL 'B0103A' USING ARG1, ARG2, ARG3, ARG4.
         ENTER COBOL.
         IF ARG4 NOT = '0'    GO TO IOERROR.
         MOVE INPUT-RECORD TO ARG3.
                   .
                   .
                   .
0   JCL:
         //SYSABEND     DD   SYSOUT=A
         //SYSOUT       DD   SYSOUT=A,DCB=(,LRECL=120,BLKSIZE=120)
         //ISAM23       DD   DSNAME=ISAMFILE(PRIME),DISP=(NEW,KEEP),
         //                  SPACE=(CYL,8,,CONTIG),UNIT=194
                             VOLUME=SER=DSK001,
         //                  DCB=(,DSORG=IS,OPTCD=WMYILR,RECFM=FB,NTM=20,
         //                  RKP=1,KEYLEN=12,CYCLOFL=2,
         //                  LRECL=161,BLKSIZE=3542
         //             DD   DSNAME=ISAMFILE(OVFLOW),DISP=(NEW,KEEP),
         //                  DCB=(,DSORG=IS),VOLUME=SER=DSK002,UNIT=194,
         //                  SPACE=(CYL,4,,CONTIG)
         //USERDD1
                   .
                   .
                   .
         //USERDD2
1************
 * B0103A   *
 ************
08. OPERATIONAL REQUIREMENTS AND COMMENTS
 ----------------------------------------
0   1.   THE INTERNAL FILE NAME AND THE EXTERNAL DDNAME MUST
         BE IDENTICAL.  THE INTERNAL FILE NAME IS CONTAINED
         IN ARG1, LEFT-JUSTIFIED IN AN 8 POSITION FIELD IN
         THE APPLICATION PROGRAM.
0   2.   THE RECORD KEY MAY NOT EXCEED 40 BYTES AND MUST BE
         PART OF THE RECORD.
0   3.   THE USER SHOULD MAKE NO ATTEMPT TO CONTINUE PROCESSING
         AFTER AN I/O ERROR IN ORDER TO AVOID UNPREDICTABLE
         RESULTS.
0   4.   DUPLICATE RECORD KEYS ARE NOT ALLOWED.
0   5.   THE RKP VALUE IN THE DCB PARAMETER MUST NOT EXCEED
         THE RECORD LENGTH MINUS THE KEY LENGTH.
0   6.   THE SPACE PARAMETER MUST BE IN THE FOLLOWING FORM:
              SPACE=(CYL, NO. OF CYLINDERS,,CONTIG)
0   7.   ISAM DATA SETS SHOULD NOT BE CATALOGUED THROUGH USER
         JCL WITH DISP=(NEW,CATLG).  PASS OR KEEP MUST BE USED.
         DATA SETS MAY BE CATALOGUED WITH THE IEHPROGM UTILITY.
0   8.   THE FIRST ENTRY TO THIS ROUTINE MUST BE AN 'OPEN' AND
         AN ENTRY MUST BE MADE TO 'CLOSE' THE DATA SET AFTER
         PROCESSING IS COMPLETE.
0   9.   THE DATA SET MAY BE MULTI-VOLUME.
0   10.  THE LRECL ON THE DD CARD FOR THE INDEXED SEQUENTIAL
         DATA SET DETERMINES THE NUMBER OF BYTES OF THE INPUT
         LOGICAL RECORD THAT WILL BE USED IN CONSTRUCTING THE
         LOGICAL RECORDS OF THE INDEXED SEQUENTIAL DATA SET;
         E.G. A USER WITH A CARD INPUT DATA SET OR A PRE-EDITED
         DATA SET CONSISTING OF 100 BYTE LOGICAL RECORDS MAY
         CONSTRUCT AN ISAM SET WITH 60 BYTE LOGICAL RECORDS BY
         SPECIFYING IN THE DCB THAT LRECL=61.  ONLY THE FIRST
         60 BYTES OF EITHER TYPE OF INPUT IS USED.
1************
 * B0103A   *
 ************
09. BIBLIOGRAPHY
 ---------------
0   1.   CONTROL PROGRAM SERVICES, C28-6541-2 INCLUDING
         N28-2204,N28-2195,N28-2122,N28-2121, SECTION 3 QISAM.
0   2.   JOB CONTROL LANGUAGE, C28-6539-4 INCLUDING
         N28-2126,N28-2128,N28-2149, SPECIAL APPLICATIONS
         OF THE CONTROL STATEMENTS (INDEX SEQUENTIAL DATA SETS).
