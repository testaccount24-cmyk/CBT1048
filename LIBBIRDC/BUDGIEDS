./ ADD NAME=CCB                                                         BD000010
         MACRO                                                          BD000020
&NAME    CCB   &DSECT=YES                                               BD000030
         AIF   ('&DSECT' EQ 'NO').DSN01                                 BD000040
CCBNTRY  DSECT                                                          BD000050
         AGO   .DSY01                                                   BD000060
.DSN01   ANOP                                                           BD000070
CCBNTRY  EQU   *                   START OF CENTRAL CONTROL BLOCK       BD000080
.DSY01   ANOP                                                           BD000090
$SAVAREA DC    18F'0'              REGISTER SAVE AREA                   BD000100
         SPACE 1                                                        BD000110
$WRKDUBL DS    PL8                 DOUBLE WORD WORK AREA                BD000120
$FPFP    DC    D'0'                FLOATING POINT NUMBER                BD000130
$FPVAL1  DC    D'0'                FLOATING POINT WORK AREA             BD000140
$FPVAL2  DC    D'0'                FLOATING POINT WORK AREA             BD000150
$FPDEC   DC    PL16'0'             PACKED DECIMAL EQUIVALENT OF FP NO.  BD000160
$WRKPACK DS    2F                  PACKED DECIMAL WORK AREA             BD000170
$WRKPCKL DS    4F                  LONG PACKED DECIMAL WORK AREA        BD000180
$WRKSNGL DS    F                   SINGLE WORD WORK AREA                BD000190
         EJECT                                                          BD000200
*********************************************************************** BD000210
*        CSECT ADDRESSES AND STORAGE POOL DEFINITIONS                 * BD000220
*********************************************************************** BD000230
         SPACE 1                                                        BD000240
$ADRVCON DS    0F                  ADDRESS OF 1ST CSECT DEFINITION      BD000250
$NUMPOOL DC    AL1(($POOLEND-$VBUDG3A)/8) NUMBER OF STORAGE POOL DEF'NS BD000260
         DC    AL3($1STCSCT)       ADDRESS OF 1ST FOLLOWING CSECT DEFIN BD000270
$1STCSCT DS    0F                  FIRST CSECT DEFINITION               BD000280
       POOLFER A,FREE              DEFINE CSECT BUDGIE3A                BD000290
       POOLFER B,FREE              DEFINE CSECT BUDGIE3B                BD000300
       POOLFER C,FREE              DEFINE CSECT BUDGIE3C                BD000310
       POOLFER D,FREE              DEFINE CSECT BUDGIE3D                BD000320
       POOLFER E                   DEFINE CSECT BUDGIE3E                BD000330
       POOLFER F                   DEFINE CSECT BUDGIE3F                BD000340
       POOLFER G                   DEFINE CSECT BUDGIE3G                BD000350
       POOLFER H                   DEFINE CSECT BUDGIE3H                BD000360
       POOLFER I                   DEFINE CSECT BUDGIE3I                BD000370
       POOLFER J                   DEFINE CSECT BUDGIE3J                BD000380
       POOLFER K                   DEFINE CSECT BUDGIE3K                BD000390
       POOLFER L                   DEFINE CSECT BUDGIE3L                BD000400
       POOLFER M,FREE              DEFINE CSECT BUDGIE3M                BD000410
       POOLFER N                   DEFINE CSECT BUDGIE3N                BD000420
       POOLFER O,FREE              DEFINE CSECT BUDGIE3O                BD000430
       POOLFER P,FREE              DEFINE CSECT BUDGIE3P                BD000440
       POOLFER Q,FREE              DEFINE CSECT BUDGIE3Q                BD000450
       POOLFER R,FREE              DEFINE CSECT BUDGIE3R                BD000460
       POOLFER S                   DEFINE CSECT BUDGIE3S                BD000470
       POOLFER T                   DEFINE CSECT BUDGIE3T                BD000480
       POOLFER U,FREE              DEFINE CSECT BUDGIE3U                BD000490
       POOLFER V                   DEFINE CSECT BUDGIE3V                BD000500
       POOLFER W                   DEFINE CSECT BUDGIE3W                BD000510
       POOLFER X                   DEFINE CSECT BUDGIE3X                BD000520
       POOLFER Y                   DEFINE CSECT BUDGIE3Y                BD000530
       POOLFER Z                   DEFINE CSECT BUDGIE3Z                BD000540
         SPACE 1                                                        BD000550
*        SPARE FIELDS FOR EXTRA CSECT DEFINITIONS                       BD000560
         SPACE 1                                                        BD000570
         DC    A(0),A(0),A(0),A(0) SPARE FIELDS FOR EXTRA CSECT DEFIN'N BD000580
         DC    A(0),A(0),A(0),A(0) SPARE FIELDS FOR EXTRA CSECT DEFIN'N BD000590
         DC    A(0),A(0),A(0),A(0) SPARE FIELDS FOR EXTRA CSECT DEFIN'N BD000600
         DC    A(0),A(0),A(0),A(0) SPARE FIELDS FOR EXTRA CSECT DEFIN'N BD000610
         SPACE 1                                                        BD000620
$GETCORE DC    A(0),A(5000),A(0),A(0) GETMAINED CORE FOR C/B'S          BD000630
$GETPL1  DC    A(0),A(0),A(0),A(0) DYNAMICALLY ACQUIRED POOL            BD000640
         DC    A(0),A(0),A(0),A(0) DYNAMICALLY ACQUIRED POOL            BD000650
         DC    A(0),A(0),A(0),A(0) DYNAMICALLY ACQUIRED POOL            BD000660
         DC    A(0),A(0),A(0),A(0) DYNAMICALLY ACQUIRED POOL            BD000670
         DC    A(0),A(0),A(0),A(0) DYNAMICALLY ACQUIRED POOL            BD000680
$POOLEND EQU   *                   END OF CSECT/POOL DEFINITIONS        BD000690
         SPACE 1                                                        BD000700
$POOLNO  DC    AL2(($POOLEND-$VBUDG3A)/8) NUMBER OF STORAGE POOL DEF'NS BD000710
$POOLRCL DC    H'0'                LENGTH OF RECORDS IN POOL            BD000720
$POOLCNT DC    F'0'                CURRENT WORKFILE RECORD COUNT        BD000730
$POOLEOD DC    F'0'                NO OF RECS IN WORKFILE (DEFINES EOD) BD000740
$POOLMAX DC    F'0'                TOTAL CAPACITY OF INTERNAL WORKFILE  BD000750
         EJECT                                                          BD000760
*********************************************************************** BD000770
*        ROUTINE ADDRESSES                                            * BD000780
*********************************************************************** BD000790
         SPACE 1                                                        BD000800
$ADRRTNS DS    0F                  ADDRESS OF FIRST RTN DESCRIPTOR      BD000810
$NUMRTNS DC    AL1(($RTNEND-$RTNSTRT)/8) NO. OF ROUTINE DESCRIPTORS     BD000820
         DC    AL3($RTNSTRT)       ADDRESS OF FIRST RTN DESCRIPTOR      BD000830
$RTNSTRT EQU   *                   START OF ROUTINE DESCRIPTORS         BD000840
        RTNDEF BATCHI F            BATCH INITIALISATION                 BD000850
        RTNDEF BATCHT F            BATCH TERMINATION                    BD000860
        RTNDEF BCSCAN F            DETERMINE IF RECORD IS BATCH CARD    BD000870
        RTNDEF BLDLOG L            BUILD BATCH LOG STATUS REPORT DETAIL BD000880
        RTNDEF CB13TST E           PROCESS CHAIN OF CB13'S              BD000890
        RTNDEF CLOSE L             CLOSE SEQUENTAIL DATA SETS           BD000900
        RTNDEF COMPARE G           DETERMINE RESULT OF COMPARE          BD000910
        RTNDEF CTESTC7 Q           PERFORM MATHEMATICAL OOERATOIN       BD000920
        RTNDEF CTESTE1 P           PARTIAL KEY MATCHING ROUTINE         BD000930
        RTNDEF CTESTI M            PERFRM ISAM LOOKUP                   BD000940
        RTNDEF CTESTL9 H           CURRENCY CONVERSION, ETC             BD000950
        RTNDEF DETAIL E            PROCESS DETAIL REORD                 BD000960
        RTNDEF EXTRACT G           EXTRACT FIELD FROM RECORD            BD000970
        RTNDEF DUMP N              ABNORMAL TERMINATION ROUTINE         BD000980
        RTNDEF GETLOG L            READ FROM LOGIN                      BD000990
        RTNDEF GETMAIN O           SUBALLOCATE STORAGE POOL / GETMAIN   BD001000
        RTNDEF GETSUSP L           READ FROM SUSPIN                     BD001010
        RTNDEF HEADBB L            B/B REPORT HEADING ROUTINE           BD001020
        RTNDEF HEADLOG L           BATCH LOG STATUS REPORT HEADING RTN  BD001030
        RTNDEF INITPH1 A           1ST PHASE OF INITIALISATION          BD001040
        RTNDEF INITPH2 A           2ND PHASE OF INITIALISATION          BD001050
        RTNDEF INITPH3 A           3RD PHASE OF INITIALISATION          BD001060
        RTNDEF INITPRM O           PARM FIELD PROCESSING                BD001070
        RTNDEF IOERRTN L           I/O ERROR ANALYSIS ROUTINE           BD001080
        RTNDEF ISCLOSE M           CLOSE ISAM DATA SETS                 BD001090
        RTNDEF ISDCB M             CONSTRUCT ISAM DCB DYNAMICALLY       BD001100
        RTNDEF JOINCB R            INTERCONNECT CONTROL BLOCKS          BD001110
        RTNDEF NUMERIC G           VERIFY FIELD IS NUMERIC              BD001120
        RTNDEF NUMRICS G           VERIFY FIELD IS SIGNED NUMERIC       BD001130
        RTNDEF OPEN L              OPEN SEQUENTIAL DATA SETS            BD001140
        RTNDEF PPLLPL O            CONVERT PPLL TO PL                   BD001150
        RTNDEF PPLPL O             CONVERT PPL TO PL                    BD001160
        RTNDEF PPPLLPL O           CONVERT PPPLL TO PL                  BD001170
        RTNDEF PPPLPL O            CONVERT PPPL TO PL                   BD001180
        RTNDEF PRINT L             WRITE TO SYSPRINT                    BD001190
        RTNDEF PRNTBBL L           WRITE B/B REPORT (PRINT)             BD001200
        RTNDEF PRNTLOG L           PRINT BATCH LOG STATUS REPORT        BD001210
         EJECT                                                          BD001220
*********************************************************************** BD001230
*        ROUTINE ADDRESSES ( CONT'D )                                 * BD001240
*********************************************************************** BD001250
         SPACE 1                                                        BD001260
        RTNDEF PUTDLET L           WRITE TO DELETED                     BD001270
        RTNDEF PUTDUP L            WRITE TO DUPLICAT                    BD001280
        RTNDEF PUTINTR L           WRITE TO INTERNAL READER             BD001290
        RTNDEF PUTLOG L            WRITE TO LOGOUT                      BD001300
        RTNDEF PUTMON L            WRITE TO MONITOR DATA SET            BD001310
        RTNDEF PUTSUSP L           WRITE TO SUSPOUT                     BD001320
        RTNDEF PUTUT2 L            WRITE TO SYSUT2                      BD001330
        RTNDEF READCC B            PROCESS CONTROL CARDS                BD001340
        RTNDEF READCC2 C           PROCESS CONTROL CARDS ( CONT'D )     BD001350
        RTNDEF READCC3 D           PROCESS CONTROL CARDS ( CONT'D )     BD001360
        RTNDEF READIN L            READ FROM SYSIN                      BD001370
        RTNDEF READLIN L           READ AND PRINT BUDGIE LOGO           BD001380
        RTNDEF READUT1 L           READ INPUT BATCHES                   BD001390
        RTNDEF SETINDS J           SET INDICATOR AT BATCH & DETAIL LEVL BD001400
        RTNDEF SFVERIF G           VERIFY SUBFIELD IS NUMERIC           BD001410
        RTNDEF STAE S              STAE ERROR ANALYSIS ROUTINE          BD001420
        RTNDEF TERMPH1 N           1ST PHASE OF TERMINATION             BD001430
        RTNDEF TESTIND J           TEST DETAIL LEVEL INDICATOR          BD001440
        RTNDEF TESTREQ R           DETERMINE INTERNAL TEST CODE         BD001450
        RTNDEF TESTRTN G           PREPARE TO RETRUN AFTER TEST/OPERATN BD001460
        RTNDEF TESTSEL G           SELECT AND PERFORM APPROPRIATE ROUTI BD001470
        RTNDEF TESTSL2 H           SELECT AND PERFROM REQUIRED TEST     BD001480
        RTNDEF TESTSL3 I           SELECT AND PERFROM REQUIRED TEST     BD001490
        RTNDEF TESTSL4 J           SELECT AND PERFROM REQUIRED TEST     BD001500
        RTNDEF TESTSN G            TEST FIELD FOR SIGNED NUMERIC        BD001510
        RTNDEF TESTUN G            TEST FIELD FOR UNSIGNED NUMERIC      BD001520
        RTNDEF TIOTSCN L           SCAN TIOT FOR DDNAME                 BD001530
        RTNDEF UNDRSCR G           UNDERLINE FIELD IN ERROR             BD001540
        RTNDEF URTCALL U           PERFORM USER ROUTINE                 BD001550
        RTNDEF URTDLET U           TERMINATE USER ROUTINE               BD001560
        RTNDEF URTLOAD U           INITIALISE USER ROUTINE              BD001570
        RTNDEF VARMOVE G           VARIABLR LENGTH MOVE ROUTINE         BD001580
        RTNDEF WORKCAP W           DETERMINE CAPACITY OF STORAGE POOLS  BD001590
        RTNDEF WORKGET W           READ FROM WORKPOOL / WORKFILE        BD001600
        RTNDEF WORKOPC W           CLOSE WORKPOOL / WORKFILE            BD001610
        RTNDEF WORKOPI W           OPEN WORKPOOL / WORKFILE FOR INPUT   BD001620
        RTNDEF WORKOPO W           OPEN WORKPOOL / WORKFILE FOR OUTPUT  BD001630
        RTNDEF WORKPUT W           WRITE TO WORK FILE                   BD001640
$RTNEND  EQU   *                   END OF ROUTINE DESCRIPTORS           BD001650
         EJECT                                                          BD001660
*********************************************************************** BD001670
*        BRANCHES TO CENTRAL CONTROL ROUTINES                         * BD001680
*********************************************************************** BD001690
         SPACE 1                                                        BD001700
         AIF   ('&DSECT' EQ 'YES').DSY02                                BD001710
$CBALINK B     CBALINK             ESTABLISH CBAL LINKAGE               BD001720
         SPACE 1                                                        BD001730
         USING $IOERROR,R15        ESTABLISH SYNAD EXIT ADDRESSABILITY  BD001740
#IOERROR EQU   *                   'ALIAS' OF $IOERROR FOR DCB ADCONS   BD001750
$IOERROR B     IOEREXIT            BR TO I/O ERROR INTERFACE ROUTINE    BD001760
         DROP  R15                 DROP SYNAD EXIT ADDRESSABILITY       BD001770
         SPACE 1                                                        BD001780
         USING $STAEXIT,R15        ESTABLISH ESTAE EXIT ADDRESSABILITY  BD001790
$STAEXIT B     STAEXIT             BR TO STAE INTERFACE ROUTINE         BD001800
         DROP  R15                 DROP ESTAE EXIT ADDRESSABILITY       BD001810
         SPACE 1                                                        BD001820
         USING $STIMEND,R15        ESTABLISH STIMER EXIT ADDRESSABILITY BD001830
$STIMEND B     STIMEND             INTERCEPT PROBABLE USER LOOP         BD001840
         DROP  R15                 DROP STIMER EXIT ADDRESSABILITY      BD001850
         SPACE 1                                                        BD001860
         USING $MONITOR,R15        ESTABLISH TEMPORARY ADDRESSABILITY   BD001870
$MONITOR B     MONITOR             BRANCH TO MONITORING ROUTINE         BD001880
         DROP  R15                 DROP TEMPORARY ADDRESSABILITY        BD001890
         AGO   .DSY03                                                   BD001900
.DSY02   ANOP                                                           BD001910
$CBALINK DS    F                   ESTABLISH CBAL LINKAGE               BD001920
$IOERROR DS    F                   BR TO I/O ERROR INTERFACE ROUTINE    BD001930
$STAEXIT DS    F                   BR TO STAE INTERFACE ROUTINE         BD001940
$STIMEND DS    F                   INTERCEPT PROBABLE USER LOOP         BD001950
$MONITOR DS    F                   BRANCH TO MONITORING ROUTINE         BD001960
.DSY03   ANOP                                                           BD001970
         EJECT                                                          BD001980
*********************************************************************** BD001990
*        CURRENT CONTROL BLOCK POINTERS                               * BD002000
*********************************************************************** BD002010
         SPACE 1                                                        BD002020
$PTRCB02 DC    A($FSTCB02)         ADDRESS OF CURRENT CB02              BD002030
$PTRCB03 DC    A(0)                ADDRESS OF CURRENT CB03              BD002040
$PTRCB04 DC    A(0)                ADDRESS OF CURRENT CB04              BD002050
$PTRCB05 DC    A(0)                ADDRESS OF CURRENT CB05              BD002060
$PTRCB11 DC    A(0)                ADDRESS OF CURRENT CB11              BD002070
$PTRSB11 DC    A(0)                ADDRESS OF CURRENT SB11              BD002080
$PTRCB13 DC    A(0)                ADDRESS OF CURRENT CB13              BD002090
$PTRCB14 DC    A(0)                ADDRESS OF CURRENT CB14              BD002100
$PTRCB15 DC    A(0)                ADDRESS OF CURRENT CB15              BD002110
$PTRCB16 DC    A(0)                ADDRESS OF CURRENT CB16              BD002120
$PTRCB21 DC    A(0)                ADDRESS OF CURRENT CB21              BD002130
$PTRCB41 DC    A(0)                ADDRESS OF CURRENT CB41              BD002140
$PTRCB30 DS    0F                  ADDRESS OF CURRENT CB30              BD002150
$PTRCB31 DS    0F                  ADDRESS OF CURRENT CB31              BD002160
$PTRCB32 DS    0F                  ADDRESS OF CURRENT CB32              BD002170
$PTRCB33 DS    0F                  ADDRESS OF CURRENT CB33              BD002180
$PTRCB34 DS    0F                  ADDRESS OF CURRENT CB34              BD002190
$PTRCB35 DS    0F                  ADDRESS OF CURRENT CB35              BD002200
$PTRCB36 DS    0F                  ADDRESS OF CURRENT CB36              BD002210
$PTRCB40 DS    0F                  ADDRESS OF CURRENT CB40              BD002220
$PTRCB20 DC    A($FSTCB20)         ADDRESS OF CURRENT CB20/30/31/32/33/ BD002230
         SPACE 1                                                        BD002240
$NXTCB02 DC    A(0)                ADDRESS OF NEXT CB02                 BD002250
$CBP1ST  DC    F'0'                ADDRESS OF 1ST C/B PREFIX            BD002260
$CBPLAST DC    A($CBP1ST)          ADDRESS OF LAST C/B PREFIX           BD002270
         SPACE 5                                                        BD002280
*********************************************************************** BD002290
*        CONTROL BLOCK CHAINS                                         * BD002300
*********************************************************************** BD002310
         SPACE 1                                                        BD002320
$FSTCB02 DC    A(0)                ADDRESS OF 1ST CB02                  BD002330
$FSTCB20 DC    A(0)                ADDRESS OF 1ST CB20/30/31/32/33/34/. BD002340
         EJECT                                                          BD002350
*********************************************************************** BD002360
*        DCBSW SUB-CONTROL BLOCKS                                     * BD002370
*********************************************************************** BD002380
         SPACE 1                                                        BD002390
         PUSH  PRINT               PRESERVE PRINT OPTIONS               BD002400
         PRINT NOGEN               SUPPRESS MACRO EXPANSION             BD002410
SYSUT1   IOM   DCBSW,SYSUT1,DCB01,INPUT,MANDAT                          BD002420
SYSUT2   IOM   DCBSW,SYSUT2,DCB02,OUTPUT                                BD002430
SYSPRINT IOM   DCBSW,SYSPRINT,DCB03,OUTPUT                              BD002440
SYSIN    IOM   DCBSW,SYSIN,DCB04,INPUT,MANDAT                           BD002450
LOGIN    IOM   DCBSW,LOGIN,DCB05,INPUT                                  BD002460
LOGOUT   IOM   DCBSW,LOGOUT,DCB06,OUTPUT                                BD002470
LOGLIST  IOM   DCBSW,LOGLIST,DCB07,OUTPUT                               BD002480
PRINTBB  IOM   DCBSW,PRINT,DCB08,OUTPUT                                 BD002490
WORK     IOM   DCBSW,WORK,DCB09,OUTPUT                                  BD002500
SUSPIN   IOM   DCBSW,SUSPIN,DCB10,INPUT                                 BD002510
SUSPOUT  IOM   DCBSW,SUSPOUT,DCB11,OUTPUT                               BD002520
DELETED  IOM   DCBSW,DELETED,DCB12,OUTPUT                               BD002530
SYSLIN   IOM   DCBSW,SYSLIN,DCB13,INPUT                                 BD002540
DUPLICAT IOM   DCBSW,DUPLICAT,DCB14,OUTPUT                              BD002550
INTRDR   IOM   DCBSW,INTRDR,DCB15,OUTPUT                                BD002560
SYSMONTR IOM   DCBSW,SYSMONTR,DCB16,OUTPUT                              BD002570
         SPACE 5                                                        BD002580
         DC    7A(0)               SPARE IOM FOR FUTURE EXPANSION       BD002590
         DC    7A(0)               SPARE IOM FOR FUTURE EXPANSION       BD002600
         DC    7A(0)               SPARE IOM FOR FUTURE EXPANSION       BD002610
         DC    7A(0)               SPARE IOM FOR FUTURE EXPANSION       BD002620
         DC    7A(0)               SPARE IOM FOR FUTURE EXPANSION       BD002630
         POP   PRINT               RE-ESTABLISH MACRO GENERATION        BD002640
         EJECT                                                          BD002650
*********************************************************************** BD002660
*        MISCELLANEOUS FIELDS                                         * BD002670
*********************************************************************** BD002680
         SPACE 1                                                        BD002690
$ABNDCDE DC    A(0)                ABEND CODE, WITH DUMP FLAG           BD002700
FULLDUMP EQU   X'80'               PRODUCE FULL CORE DUMP               BD002710
$ADRIGAM DC    A(0)                ADDRESS OF RIGAM                     BD002720
$ADUT458 DC    A(0)                ADDRESS OF UT458 ( DATE ROUINE )     BD002730
$ADUT460 DC    A(0)                ADDRESS OF UT460                     BD002740
$AWORKBC DC    A(0)                ADDRESS OF B/C IN STORAGE POOL       BD002750
$BVALUE  DC    F'0'                VALUE FROM NUMERIC TEST ROUTINES     BD002760
$CBALRTD DC    A(0)                ADDRESS OF MOST RECENT RTN DESCRIPTR BD002770
$CBALRTN DC    A(0)                ADDRESS OF MOST RECENTLY CBAL'ED RTN BD002780
$CBALR12 DC    A(0)                BASE REGISTER OF ISSUER OF LAST CBAL BD002790
$CBALR4  DC    A(0)                CURRENT CBAL RETURN ADDRESS          BD002800
$DBUFF   DC    A(0)                ADDRESS OF DUMMY BUFFER              BD002810
$GETMDYN DC    A(0)                AMOUNT OF CORE DYNAMICALLY ACQUIRED  BD002820
$GETMMC  DC    F'51200'            MAX TO DYNAMICALLY ACQUIRE           BD002830
$GETMUSD DC    A(0)                AMOUNT OF CORE USED FOR C/B ETC      BD002840
$GETMXES DC    A(0)                AMOUNT OF C/B CORE ACQUIRED BY OS GM BD002850
$MONINT  DC    F'38'               MONITORING INTERVAL ( 1/1000 SEC )   BD002860
$PMUT460 DC    A(0)                ADDRESS OF UT460 LINKAGE AREA        BD002870
$PTRPARM DC    A(0)                ADDRESS OF USER RTN PARM AREA        BD002880
$PTRPRMU DC    A(0)                ADDRESS OF USER RTN CONTROL DATA     BD002890
$PTRPRM2 DC    A(0)                ADDR OF OUTPUT||INPUT RECS (SF=IN)   BD002900
$RBADDR  DC    A(0)                ADDRESS OF BUDGIE'S RB               BD002910
$SIZEISX DC    A(0)                SIZE OF ISAM MASTER INDICES          BD002920
$WRKMBLK DC    F'1693'             MAX BLKSIZE FOR WORKFILE             BD002930
         SPACE 1                                                        BD002940
$COMPCDE DC    H'0'                COMPLETION CODE                      BD002950
$RECLINT DC    H'0'                INTERNAL (PSEUDO) RECORD LENGTH      BD002960
$RECLUT1 DC    H'0'                SYSUT1 RECORD LENGTH                 BD002970
$RECLUT2 DC    H'80'               SYSUT2 RECORD LENGTH                 BD002980
         EJECT                                                          BD002990
*********************************************************************** BD003000
*        MISCELLANEOUS FIELDS ( CONT'D )                              * BD003010
*********************************************************************** BD003020
         SPACE 1                                                        BD003030
$BLNECNT DC    PL2'0'              NO OF LINES FOR THIS RECORD          BD003040
$BNOPRT  DC    CL22' '             BATCH NO (WITH HYPHENS) FOR PRINTING BD003050
$CNTACC  DC    PL3'0'              NUMBER OF ACCEPTED BATCHES           BD003060
$CNTREJ  DC    PL3'0'              NUMBER OF REJECTED BATCHES           BD003070
$DATEREP DC    C'01 JAN 99'        IPL DATE IN REPORT FORMAT            BD003080
$DINTVL  DC    C'00000500'         INTERVAL OF 5 SECS FRO STIMER        BD003090
$DTBSPCE DC    X'01'               BASIC SKUP CHAR FOR B/B REPORRT      BD003100
$FLDP    DC    2X'00'              PL FROM CURRENT CB13                 BD003110
$FPDISP  DC    CL33'0'             SIGNED DISPLAY NUMERIC EQUIV TO FP   BD003120
$FPEDISP DC    CL45'0'             EDITED SIGNED DISPLAY NUMERIC FP EQI BD003130
$FPNDEC  DC    BL1'0'              NUMBER OF DECIMAL PLACES IN FP NUMBE BD003140
$IPLDATE DC    C'99001'            IPL DATE IN FORM YYDDD               BD003150
$LOGSUSP DC    C'S'                'R' / 'S' - BATCH LOG STATUS FLAG    BD003160
$MAXDMPS DC    PL2'10'             MAX NUMBER OF ABENDS BEFORE TERMIN'N BD003170
$MMDDYY  DC    C'010199'           IPL DATE IN FORM MMDDYY              BD003180
$ONE     DC    PL1'1'              PACKED CONSTANT OF 1                 BD003190
$PGELMIT DC    PL2'60'             LINES/PAGE FOR EVERY REPROT          BD003200
$PVALUE  DC    PL8'0'              VALUE FROM NUMERIC TEST ROUTINES     BD003210
$SFDFLT  DC    X'11'               DEFAULT TST CODE FOR SIGNED FIELDS   BD003220
$SFTEST  DC    X'00'               TEST CODE FOR SFVERIF                BD003230
$SFUDFLT DC    X'4A'               TEST CODE FOR UNSIGNED TEST          BD003240
$SPACES  DC    CL80' '             CONSTANT OF SPACES                   BD003250
$SUBID   DC    CL20' '             SUBMITTOR ID FROM BATCH CARD         BD003260
$SUBIDP  DC    CL20' '             SUBMITTOR ID (WITH HYPHEND) FOR PRTG BD003270
$TSTAREA DC    CL100' '            GENERAL PURPOSE TEST AREA            BD003280
$TSTTSTX DC    C'X'                USED TO SET COND CODE                BD003290
$ULINEPL DC    2X'00'              PL OF FIELD TO BE UNDERLINED         BD003300
$ULNDECR DC    PL1'1'              DECREMENT LNE CNT AFTER UNDERSCORE   BD003310
$UNDRLNE DC    C'_'                UNDRDESCORE CHARACTER                BD003320
$VERSNO  DC    C'99/99'            VERSION NUMBER FROM UT460            BD003330
$WORKPL  DC    CL2' '              WORK AREA FOR PL                     BD003340
$WRKAREA DC    CL18' '             GENERAL PURPOSE WORK AREA            BD003350
$WRKEDIT DC    CL6' '              WORK AREA FOR EDIT NASKS             BD003360
$ZERO    DC    PL1'0'              PACKED CONSTANT OF ZERO              BD003370
$ZEROES  DC    20C'0'              CONSTANT OF EBCDIC ZEROES            BD003380
         EJECT                                                          BD003390
*********************************************************************** BD003400
*        BATCH NUMBER SAVE/WORK AREAS                                 * BD003410
*********************************************************************** BD003420
         SPACE 1                                                        BD003430
$CURLIN  DC    16X'00'             LOGIN    - CURRENT BATCH NUMBER      BD003440
$CURSCAN DC    16X'00'             BCSCAN   - CURRENT BATCH NUMBER      BD003450
$CURSUSP DC    16X'00'             SUSPIN   - CURRENT BATCH NUMBER      BD003460
$CURUT1  DC    16X'00'             SYSUT1   - CURRENT BATCH NUMBER      BD003470
$NXTLIN  DC    CL16' '             LOGIN    - NEXT BATCH NUMBER         BD003480
$NXTSCAN DC    CL16' '             BCSCAN   - NEXT BATCH NUMBER         BD003490
$NXTSUSP DC    CL16' '             SUSPIN   - NEXT BATCH NUMBER         BD003500
$NXTUT1  DC    CL16' '             SYSUT1   - NEXT BATCH NUMBER         BD003510
$PRVLIN  DC    CL16' '             LOGIN    - PREVIUS BATCH NUMBER      BD003520
$PRVSCAN DC    CL16' '             BCSCAN   - PREVIUS BATCH NUMBER      BD003530
$PRVSUSP DC    CL16' '             SUSPIN   - PREVIUS BATCH NUMBER      BD003540
$PRVUT1  DC    CL16' '             SYSUT1   - PREVIUS BATCH NUMBER      BD003550
         EJECT                                                          BD003560
*********************************************************************** BD003570
*        SWITCHES                                                     * BD003580
*********************************************************************** BD003590
         SPACE 1                                                        BD003600
*********************************************************************** BD003610
MASTER   DC    X'00'               MASTER CONTROL SWITCH                BD003620
*********************************************************************** BD003630
         SPACE 1                                                        BD003640
SWMNLIST EQU   1                   DATA IS NOT TO BE LISTED             BD003650
SWMHARD  EQU   2                   BATCH CONTAINS HARD ERROR            BD003660
SWMSOFT  EQU   4                   BATCH CONTAINS SOFT ERROR            BD003670
SWMBALNC EQU   8                   BATCH IS OUT OF BALANCE              BD003680
SWMDUPIN EQU   16                  CURRENT BATCH NO. SAME AS LAST       BD003690
SWMDETL  EQU   32                  PROCESSING DETAIL RECORD (EOP RTN)   BD003700
SWMPRINT EQU   64                  WRITE ERROR TO B/B REPORT            BD003710
SWMDUPLG EQU   128                 BATCH NO. DUPLICATED ON LOG          BD003720
         SPACE 1                                                        BD003730
SWMBATCH EQU   SWMHARD+SWMSOFT+SWMBALNC+SWMDUPIN+SWMDUPLG               BD003740
         SPACE 5                                                        BD003750
*********************************************************************** BD003760
SWINIT   DC    X'00'               INITIALISATION FLAGS                 BD003770
*********************************************************************** BD003780
         SPACE 1                                                        BD003790
SWMS11   EQU   1                   MS11 CARD BEING PROCESSED            BD003800
SWLDRIGM EQU   2                   RIGAM IS TO BE LOADED                BD003810
SWLDDATE EQU   4                   UT457 IS TO LOADED                   BD003820
SWLD435  EQU   8                   UT435 IS TO BE LOADED                BD003830
SWONMS11 EQU   16                  MS11 FOUND FOR THIS MS02             BD003840
SWONURTN EQU   32                  USER ROUTINE(S) ARE TO BE INVOKED    BD003850
SWMS11PL EQU   64                  MS11 CONTAINS 'PPPL' AND NOT 'PPLL'  BD003860
SWCCPRNT EQU   128                 CURRENTLY PRINTING CONTROL CARDS     BD003870
         EJECT                                                          BD003880
*********************************************************************** BD003890
SWERROR  DC    X'00'               BYTE OF ERROR FLAGS                  BD003900
*********************************************************************** BD003910
         SPACE 1                                                        BD003920
SWEGETM  EQU   1                   STORAGE POOL TOO SMALL FOR C/B'S     BD003930
SWEURTN  EQU   2                   USER ROUTINE PASSED NON-NUMERIC PPLL BD003940
SWEFLUSH EQU   4                   TERMINATE AFTER CONTROL CARD SCAN    BD003950
SWEUNA   EQU   8                   UNALLOCATED TEST CODE SPECIFIED      BD003960
SWEUNS   EQU   16                  UNSUPPORTED TEST CODE SPECIFIED      BD003970
SWEDBCN  EQU   32                  MS11 SPECIFIES UNMATCHED B/C FLD NME BD003980
SWEDBRN  EQU   64                  MS11 SPECIFIES UNMATCHED C/R FLD NME BD003990
SWENMSXX EQU   128                 MS13 REQUIRES A MISSING MSXX CARD    BD004000
         SPACE 5                                                        BD004010
*********************************************************************** BD004020
SWERROR2 DC    X'00'               SECOND BYTE OF ERROR FLAGS           BD004030
*********************************************************************** BD004040
         SPACE 1                                                        BD004050
SWEUNREC EQU   1                   MS13 SPECIFIES UNKNOWN TEST CODE     BD004060
SWETMS11 EQU   2                   MS11 SPECIFIES TEST THAT NEEDS MSXX  BD004070
MERRCBAL EQU   4                   NON-EXISTENT RTN INVOKED BY CBAL     BD004080
SWE2IOER EQU   8                   I/O ERROR OCCURRED:PREVENT RECURSION BD004090
SWE2ABER EQU   16                  STAE RTN INVOKED: PREVENT RECURSION  BD004100
SWE2S999 EQU   32                  MORE THAN 999 SEQUENCED C/C          BD004110
MERREOFL EQU   64                  EXPONENT OVERFLOW DETECTED           BD004120
MERRBRTN EQU   128                 UNLOCATABLE RTN DESCRIBED BY RTNDEF  BD004130
         EJECT                                                          BD004140
*********************************************************************** BD004150
PSWITCH  DC    X'00'               RECORD PROCESSING FLAGS              BD004160
*********************************************************************** BD004170
         SPACE 1                                                        BD004180
PSWSOFT  EQU   1                   RECORD CONTAINS SOFT ERROR           BD004190
PSWHARD  EQU   2                   RECORD CONTAINS HARD ERROR           BD004200
PSWDLETE EQU   4                   RECORD IS TO BE DELETED              BD004210
PSWIGN   EQU   8                   RECORD IS TO BE IGNORED              BD004220
PSWULINE EQU   16                  UNDERLINE CHAR NOT '_' OR ' '        BD004230
*                                  DO NOT FORCE FORWARD SPACE IF NO ERR BD004240
PSWNEG   EQU   32                  NEGATIEV IDENTIFIER SHOWS NEGATIVE   BD004250
PSWKIGN  EQU   64                  KNOWN RECORD TYPE BEING IGNORED      BD004260
PSWBCARD EQU   128                 PROCESSING BATCH CARD                BD004270
         SPACE 1                                                        BD004280
PSWPRNT  EQU   PSWSOFT+PSWHARD+PSWDLETE+PSWIGN+PSWULINE                 BD004290
         SPACE 5                                                        BD004300
*********************************************************************** BD004310
BRSWITCH DC    X'00'               REPORT PROCESSING FLAGS              BD004320
*********************************************************************** BD004330
         SPACE 1                                                        BD004340
SWBRRCNT EQU   1                   PUT RECORD COUNT IN THIS TOTAL LINE  BD004350
SWBRDETL EQU   2                   PUT CARD IMAGE IN THIS LINE          BD004360
SWBRNOBC EQU   4                   NO BATCH CARD SUPPLIED WITH RUN      BD004370
SWBRKB   EQU   8                   RECOGNISE NEW BATCH BY CHANGE OF KEY BD004380
SWBRCRT  EQU   16                  CONTROL RECORD TRAILS BATCH          BD004390
SWBRWRKP EQU   32                  WORK DD STATEMENT PRESENT            BD004400
SWBRPCRD EQU   64                  CARD IMAGE BEING PLACED IN LNE AGAIN BD004410
         EJECT                                                          BD004420
*********************************************************************** BD004430
PRINTSW  DC    X'00'               FLAGS TO CONTROL LINE SPACING        BD004440
*********************************************************************** BD004450
         SPACE 1                                                        BD004460
PRSWSPC2 EQU   1                   DOUBLE SPACING REQUESTED             BD004470
PRSWSPC3 EQU   2                   TRIPLE SPACING REQUESTED             BD004480
PRSWBLS2 EQU   4                   DOUBLE SPACING FOR BATCH LOG LIST    BD004490
PRSWBLS3 EQU   8                   TRIPLE SPACE FOR BATCH LOG LIST      BD004500
PRSWSPBL EQU   16                  DOUBLE/TRIPLE SPACE WITH BLANK LINES BD004510
PRSWNDTA EQU   32                  PRINT CONTROL TOTALS ONLY            BD004520
         SPACE 5                                                        BD004530
*********************************************************************** BD004540
APSWITCH DC    X'00'               ANOTHER PROCESSING SWITCH            BD004550
*********************************************************************** BD004560
         SPACE 1                                                        BD004570
APSWSID  EQU   1                   SUBMITTOR'S ID TO BE PLACED IN RECS  BD004580
APSWSIDB EQU   3                   SUBMITTOR'S ID IN BATCH CARDS ONLY   BD004590
APSWBCID EQU   2                   BCID PARM FOUND                      BD004600
APSWMS05 EQU   4                   MS05 CARDS PRESENT                   BD004610
APSWNSEQ EQU   8                   PERFORM NO SEQUENCE CHECKING         BD004620
APSWMS1S EQU   16                  ALL MS11 TESTS ARE TO BE SOFT ERRORS BD004630
APSWSRTN EQU   32                  CURRENTLY WITHIN AN MS40 SUBROUTINE  BD004640
APSWJUST EQU   64                  RIGHT JUSTIFY BEFORE TESTING NUMERIC BD004650
APSWLOG  EQU   128                 BATCH LOG RECORD REQUIRED            BD004660
         EJECT                                                          BD004670
*********************************************************************** BD004680
YPSWITCH DC    X'00'               ANOTHER PROCESSING SWITCH            BD004690
*********************************************************************** BD004700
         SPACE 1                                                        BD004710
YPSWCC19 EQU   1                   CONVERT CURR CODE 19 TO 98           BD004720
YPSWNOIX EQU   2                   DO NOT BUILD I.S. INDEX IN CORE      BD004730
YPSWFREE EQU   4                   FREEMAIN OVERLAYABLE CSECTS          BD004740
YPSWNOLD EQU   8                   DO NOT PRELOAD USER ROUTINES         BD004750
YPSWSFIN EQU   16                  SUSPENSE FILE = INPUT IMAGES         BD004760
YPSWCLST EQU   32                  SWMNLIST + CARD IMAGE WRITTEN        BD004770
YPSWNEOF EQU   64                  NO '/*EOF' TO BE WRITTEN TO INTRDR   BD004780
YPSWPLOP EQU   128                 PPL MAY HAVE OVERPUNCH FOR LEADING D BD004790
         SPACE 5                                                        BD004800
*********************************************************************** BD004810
AFSWITCH DC    AL1(AFSWTIMR)       FORCE LOOP DETECTION FOR TESTING     BD004820
*********************************************************************** BD004830
         SPACE 1                                                        BD004840
AFSWKIND EQU   1                   PARM=KEEPINDS SPECIFIED              BD004850
AFSWSEQA EQU   2                   SEQUENCE NUMBER ALL CONTROL CARDS    BD004860
AFSWFDMP EQU   4                   USER DUMP 4 IN TERMINATION REQ'D     BD004870
AFSWNABM EQU   8                   NO ABEND MESSAGES TO BE ISSUED       BD004880
AFSWTIMR EQU   16                  USE 5-SECOND TIMER TO DETECT LOOPS   BD004890
AFSWMLAB EQU   32                  MS11/12 CONTAIN ONLY FIELD LABELS    BD004900
AFSWTURN EQU   64                  CREATE TURNAROUND DOCUMENT           BD004910
         EJECT                                                          BD004920
*********************************************************************** BD004930
A2SWITCH DC    X'00'               ANOTHER PROCESSING SWITCH            BD004940
*********************************************************************** BD004950
         SPACE 1                                                        BD004960
A2SWNDFL EQU   1                   PARM=NODELFLAG SPECIFIED             BD004970
A2SWNDRS EQU   2                   PARM=NODELRSEQ SPECIFIED             BD004980
         SPACE 5                                                        BD004990
*********************************************************************** BD005000
SWPARM   DC    X'00'               MISCELLANEOUS PARM SWITCHES          BD005010
*********************************************************************** BD005020
         SPACE 1                                                        BD005030
MPRMCBD  EQU   1                   PRODUCE CONTROL BLOCK DUMP IN TERM'N BD005040
         SPACE 5                                                        BD005050
*********************************************************************** BD005060
OSLEVEL  DC    X'00'               OPERATING SYSTEM ( FROM CVT )        BD005070
*********************************************************************** BD005080
         SPACE 1                                                        BD005090
OSLMFT   EQU   X'20'               OS / MFT                             BD005100
OSLMVT   EQU   X'10'               OS / MVT                             BD005110
OSLMP65  EQU   X'04'               MULTIPROCESSING /65                  BD005120
OSLMVTMP EQU   X'14'               OS MVT MULTI-PROCESSOR               BD005130
OSLVS1   EQU   X'02'               OS / VS1                             BD005140
OSLSVS   EQU   X'02'               OS / VS2 SVS                         BD005150
OSLMVS   EQU   X'01'               OS / VS2 MVS                         BD005160
OSLPCP   EQU   X'40'               OS / PCP                             BD005170
         SPACE 1                                                        BD005180
CVTDCB   EQU   X'74'               O.S. LEVEL FLAG IN CVT               BD005190
         EJECT                                                          BD005200
*********************************************************************** BD005210
*        PATCH AREA                                                   * BD005220
*********************************************************************** BD005230
         AIF   ('&DSECT' EQ 'NO').DSY04                                 BD005240
         USING CCBNTRY,13          ESTABLISH ADDRESSABILITY FOR S-TYPE  BD005250
.DSY04   ANOP                                                           BD005260
$PATCH   DC    S(*),S(*)                                                BD005270
         DC    S(*),S(*)                                                BD005280
         DC    S(*),S(*)                                                BD005290
         DC    S(*),S(*)                                                BD005300
         DC    S(*),S(*)                                                BD005310
         DC    S(*),S(*)                                                BD005320
         DC    S(*),S(*)                                                BD005330
         DC    S(*),S(*)                                                BD005340
         DC    S(*),S(*)                                                BD005350
         DC    S(*),S(*)                                                BD005360
         DC    S(*),S(*)                                                BD005370
         DC    S(*),S(*)                                                BD005380
         DC    S(*),S(*)                                                BD005390
         DC    S(*),S(*)                                                BD005400
         DC    S(*),S(*)                                                BD005410
         DC    S(*),S(*)                                                BD005420
         DC    S(*),S(*)                                                BD005430
         DC    S(*),S(*)                                                BD005440
         DC    S(*),S(*)                                                BD005450
         DC    S(*),S(*)                                                BD005460
         DC    S(*),S(*)                                                BD005470
         DC    S(*),S(*)                                                BD005480
         DC    S(*),S(*)                                                BD005490
         DC    S(*),S(*)                                                BD005500
         DC    S(*),S(*)                                                BD005510
         DC    S(*),S(*)                                                BD005520
         DC    S(*),S(*)                                                BD005530
         DC    S(*),S(*)                                                BD005540
         DC    S(*),S(*)                                                BD005550
         DC    S(*),S(*)                                                BD005560
         DC    S(*),S(*)                                                BD005570
         DC    S(*),S(*)                                                BD005580
         DC    S(*),S(*)                                                BD005590
         DC    S(*),S(*)                                                BD005600
         DC    S(*),S(*)                                                BD005610
         DC    S(*),S(*)                                                BD005620
         DC    S(*),S(*)                                                BD005630
         DC    S(*),S(*)                                                BD005640
         DC    S(*),S(*)                                                BD005650
         DC    S(*),S(*)                                                BD005660
         DC    S(*),S(*)                                                BD005670
         DC    S(*),S(*)                                                BD005680
         DC    S(*),S(*)                                                BD005690
         DC    S(*),S(*)                                                BD005700
         DC    S(*),S(*)                                                BD005710
         DC    S(*),S(*)                                                BD005720
         DC    S(*),S(*)                                                BD005730
         DC    S(*),S(*)                                                BD005740
         DC    S(*),S(*)                                                BD005750
         DC    S(*),S(*)                                                BD005760
         EJECT                                                          BD005770
*********************************************************************** BD005780
*        SPARE FIELDS                                                 * BD005790
*********************************************************************** BD005800
         SPACE 1                                                        BD005810
*        THESE SPARE FIELDS ARE INTENDED TO ALLOW ADDITIONAL FIELDS     BD005820
*         TO BE ADDED TO THE CCB WITHOUT NECESSITATING A RECOMPILATION  BD005830
*         OF EVERY BUDGIE MODULE.  WHENEVER ALL THE MODULES ARE         BD005840
*         RECOMPILED, ANY FIELDS HEREIN SHOULD BE MOVED TO THE          BD005850
*         APPROPRIATE LOCATION IN THE CCB.                              BD005860
         SPACE 1                                                        BD005870
*        ( THIS EXPANSION AREA CONTAINS 40 FULLWORDS ).                 BD005880
         SPACE 1                                                        BD005890
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD005900
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD005910
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD005920
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD005930
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD005940
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD005950
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD005960
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD005970
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD005980
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD005990
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006000
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006010
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006020
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006030
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006040
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006050
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006060
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006070
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006080
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006090
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006100
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006110
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006120
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006130
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006140
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006150
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006160
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006170
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006180
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006190
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006200
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006210
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006220
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006230
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006240
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006250
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006260
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006270
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006280
         DC    F'0'                SPARE TO ALLOW FOR EXPANSION         BD006290
         EJECT                                                          BD006300
*********************************************************************** BD006310
*        SPARE ROUTINE DESCRIPTORS                                    * BD006320
*********************************************************************** BD006330
         SPACE 1                                                        BD006340
*        THESE ADDITIONAL ROUTINE DESCRIPTORS ARE INTENDED TO ALLOW     BD006350
*         ADDITIONAL CBAL'ABLE ROUTINES TO BE DEFINED WITHOUT           BD006360
*         NECESSITATING A RECOMPILATION OF EVERY BUDGIE MODULE.         BD006370
*        WHENEVER ALL THE MODULES ARE RECOMPILED, ANY ROUTINES DEFINED  BD006380
*         HEREUNDER SHOULD BE MOVED TO THEIR PROPER LOCATION IN THE CCB BD006390
         SPACE 1                                                        BD006400
$ADRSRTN DS    0F                  ADDRESS OF 1ST ADDITIONAL RTN DESC   BD006410
$NUMSRTN DC    AL1(($SRTNEND-$SRTNSTR)/8) NO. OF ADDITIONAL RTNS        BD006420
         DC    AL3($SRTNSTR)       ADDRESS OF 1ST ADDITIONAL RTN DESC   BD006430
$SRTNSTR EQU   *                   START OF ADDITIONAL RTN DESCRIPTORS  BD006440
*        |                                                              BD006450
*        |                                                              BD006460
*        |                                                              BD006470
*        V                                                              BD006480
**********                                                              BD006490
*        A                                                              BD006500
*        |                                                              BD006510
*        |                                                              BD006520
*        |                                                              BD006530
$SRTNEND EQU   *                   END OF ADDITIONAL RTN DESCRIPTORS    BD006540
         SPACE 5                                                        BD006550
CCBLGTH  EQU   *-CCBNTRY           LENGTH OF CCB                        BD006560
$CCBEND  EQU   *                   END OF CCB                           BD006570
         MEND                                                           BD006580
./ ADD NAME=XCBPREFI                                                    BD006590
         MACRO                                                          BD006600
&NAME CBPREFIX &DUMMY                                                   BD006610
*********************************************************************** BD006620
*        FORMAT OF COMMON CONTROL BLOCK PREFIX                        * BD006630
*********************************************************************** BD006640
         SPACE 1                                                        BD006650
CBPREFIX DSECT                                                          BD006660
CBPRCBPR DS    F                   ADDRESS OF NEXT CHAINED C/B PREFIX   BD006670
CBPRLEN  DS    H                   LENGTH OF CONTROL BLOCK ( INCL PREFI BD006680
CBPRCCNO DS    PL2                 SEQUENCE NO. OF ASSOCIATED CONTROL C BD006690
CBPRNAME DS    CL4                 EBCDIC CONTROL BLOCK DENTIFIER       BD006700
CBPRLGTH EQU   *-CBPREFIX          LENGTH OF C/B PREFIX                 BD006710
         MEND                                                           BD006720
./ ADD NAME=CB02                                                        BD006730
         MACRO                                                          BD006740
&NAME    CB02  &DUMMY                                                   BD006750
*********************************************************************** BD006760
*        FORMAT OF MS02 CONTROL BLOCK                                 * BD006770
*********************************************************************** BD006780
         SPACE 1                                                        BD006790
CB02NTRY DSECT                     BATCH CARD CHAIN ELEMENT             BD006800
CB02FLAG DS    0CL1                CONTROL BLOCK FLAG                   BD006810
CB02CB02 DS    F                   ADDRESS OF NEXT CB02 ENTRY           BD006820
CB02CB11 DS    F                   ADDRESS OF 1ST ASSOC MS11 ENTRY      BD006830
CB02CB03 DS    F                   ADDRESS OF ASSOC CB03 ENTRY          BD006840
CB02CB05 DS    F                   ADDRESS OF FIRST CB05 ENTRY          BD006850
CB02CB13 DS    F                   ADDRESS OF 1ST ASSOC CB13 ENTRY      BD006860
CB02CB14 DS    F                   ADDRESS OF 1ST ASSOC CB14 ENTRY      BD006870
CB02ARTN DS    F                   ADDRESS OF USER ROUTINE ENTRY POINT  BD006880
CB02CCNO DS    PL2                 CONTROL CARD SEQUENCE NUMBBER        BD006890
CB02BCI  DS    CL8                 LITERAL BATCH CARD IDENTIFIER        BD006900
CB02URTN DS    CL8                 NAME OF USER SUBROUTINE              BD006910
CB02CNT  DS    PL4                 COUNT OF RECORDS OF THIS TYPE        BD006920
CB02HCNT DS    PL3                 COUNT OF HARD ERRORS IN BATCH        BD006930
CB02SCNT DS    PL3                 COUNT OF SOFT ERRORS IN BATCH        BD006940
CB02RCNT DS    PL3                 RECORD COUNT ( CURRENT BATCH )       BD006950
CB02CNTR DS    PL3                 RECORD COUNT FROM BATCH CARD         BD006960
CB02LCNT DS    PL4                 CARD NO WITHIN BATCH ( FOR SUSPENSE  BD006970
CB02RETC DS    PL3                 NO OD CARDS RETAINED                 BD006980
CB02CNTP DS    CL1                 POSN OF RECORD COUNT IN BATCH CARD   BD006990
CB02CNTL DS    CL1                 LGTH OF RECORD COUNT IN BATCH CARD   BD007000
CB02PBCI DS    CL1                 POSN OF BATCH CARD IDENTIFIER        BD007010
CB02LBCI DS    CL1                 LGTH OF BATCH CARD IDENTIFIER        BD007020
CB02PBN1 DS    CL1                 POSN OF 1ST SEGMENT OF BATCH NO      BD007030
CB02LBN1 DS    CL1                 LGTH OF 1ST SEGMENT OF BATCH NO      BD007040
CB02PBN2 DS    CL1                 POSN OF 2ND SEGMENT OF BATCH NO      BD007050
CB02LBN2 DS    CL1                 LGTH OF 2ND SEGMENT OF BATCH NO      BD007060
CB02PBN3 DS    CL1                 POSN OF 3RD SEGMENT OF BATCH NO      BD007070
CB02LBN3 DS    CL1                 LGTH OF 3RD SEGMENT OF BATCH NO      BD007080
CB02PBN4 DS    CL1                 POSN OF 4TH SEGMENT OF BATCH NO      BD007090
CB02LBN4 DS    CL1                 LGTH OF 4TH SEGMENT OF BATCH NO      BD007100
CB02PBN5 DS    CL1                 POSN OF 5TH SEGMENT OF BATCH NO      BD007110
CB02LBN5 DS    CL1                 LGTH OF 5TH SEGMENT OF BATCH NO      BD007120
CB02PCRN DS    CL1                 POSN OF CORRECTION DATA REC NO.      BD007130
CB02LCRN DS    CL1                 LGTH OF CORRECTION DATA REC NO.      BD007140
CB02PID1 DS    CL1                 POSN OF 1ST SEGMENT OF SUBMITTOR ID  BD007150
CB02LID1 DS    CL1                 LGTH OF 1ST SEGMENT OF SUBMITTOR ID  BD007160
CB02PID2 DS    CL1                 POSN OF 2ND SEGMENT OF SUBMITTOR ID  BD007170
CB02LID2 DS    CL1                 LGTH OF 2ND SEGMENT OF SUBMITTOR ID  BD007180
CB02PID3 DS    CL1                 POSN OF 3RD SEGMENT OF SUBMITTOR ID  BD007190
CB02LID3 DS    CL1                 LGTH OF 3RD SEGMENT OF SUBMITTOR ID  BD007200
CB02SW   DS    CL1                 SWITCH BYTE                          BD007210
CB02SW2  DS    CL1                 2ND SWITCH BYTE                      BD007220
CB02INDB DS    CL13                104 INDICATORS AT BATCH LEVEL        BD007230
CB02INDD DS    CL13                104 INDICATORS AT DETAIL LEVEL       BD007240
CB02LGTH EQU   *-CB02NTRY          LENGTH OF CONTROL BLOCK              BD007250
         EJECT                                                          BD007260
*********************************************************************** BD007270
*        FORMAT OF MS02 CONTROL BLOCK ( CONT'D )                      * BD007280
*********************************************************************** BD007290
         SPACE 1                                                        BD007300
SW02WDC  EQU   1                   WRITE DETAIL CARDS                   BD007310
SW02WBC  EQU   2                   WRITE BATCH CARD                     BD007320
SW02WCR  EQU   4                   WRITE CONTROL RECORD                 BD007330
SW02URTN EQU   8                   CALL USER PROGRAM                    BD007340
SW02DROP EQU   16                  DROP UNKNOWN CARD TYPES              BD007350
SW02IRTN EQU   32                  USER PGM HAS BEEN INITIALISED        BD007360
SW02RCNT EQU   64                  BATCH CARD HES RECORD COUNT          BD007370
SW02RCSF EQU   128                 RECORD COUNT IS SOFT ERROR           BD007380
SW02PID  EQU   1                   PUT SUBMITTOR ID IN HEADING LINE     BD007390
         MEND                                                           BD007400
./ ADD NAME=CB03                                                        BD007410
         MACRO                                                          BD007420
&NAME    CB03  &DUMMY                                                   BD007430
*********************************************************************** BD007440
*        FORMAT OF MS03 CONTROL BLOCK                                 * BD007450
*********************************************************************** BD007460
         SPACE 1                                                        BD007470
CB03NTRY DSECT                     CONTROL RECORD CHAIN ELEMENT         BD007480
CB03FLAG DS    0CL1                CONTROL BLOCK FLAG                   BD007490
CB03CB04 DS    F                   ADDRESS OF 1ST ASSOC CB04 ENTRY      BD007500
CB03CCNO DS    PL2                 CONTROL CARD SEQUENCE NUMBBER        BD007510
CB03SW   DS    CL1                 SWITCH BYTE                          BD007520
CB03PCRK DS    CL1                 POSN OF CONTROL RECORD KEY           BD007530
CB03LCRK DS    CL1                 LGTH OF CONTROL RECORD KEY           BD007540
CB03CRK  DS    CL70                CONTROL RECORD KEY (VARIANLE LGTH)   BD007550
CB03LGTH EQU   *-CB03NTRY          LENGTH OF CONTROL BLOCK              BD007560
         MEND                                                           BD007570
./ ADD NAME=CB04                                                        BD007580
         MACRO                                                          BD007590
&NAME    CB04  &DUMMY                                                   BD007600
*********************************************************************** BD007610
*        FORMAT OF MS04 CONTROL BLOCK                                 * BD007620
*********************************************************************** BD007630
         SPACE 1                                                        BD007640
CB04NTRY DSECT                     MS03 CONTROL BLOCK SUB-ELEMENT       BD007650
CB04FLAG DS    0CL1                CONTROL BLOCK FLAG                   BD007660
CB04CB04 DS    F                   ADDRESS OF NEXT ASSOC CB04           BD007670
CB04CCNO DS    PL2                 CONTROL CARD SEQUENCE NUMBBER        BD007680
CB04PSRC DS    CL1                 POSN OF SOURCE FIELD                 BD007690
CB04PCRF DS    CL1                 POSN OF CONTROL RECORD FIELD         BD007700
CB04LCRF DS    CL1                 LGTH OF CONTROL RECORD FIELD         BD007710
CB04NDEC DS    PL1                 NO. OF DECIMALS                      BD007720
CB04FNO  DS    CL2                 FIELD NAME CODE                      BD007730
CB04BACC DS    PL8                 FIELD ACCUMULATOR FRO THIS BATCH     BD007740
CB04SW   DS    CL1                 SWITCH BYTE                          BD007750
CB04LGTH EQU   *-CB04NTRY          LENGTH OF CONTROL BLOCK SUB-ELEMENT  BD007760
         SPACE 5                                                        BD007770
SW03LIST EQU   1                   CONRRLO RECORD TO BE WRITTEN         BD007780
SW03POSN EQU   2                   ON  - CONTROL RECORD PRECEDES BATCH  BD007790
*                                  OFF - CONTROL RECORD FOLLOWS BATCH   BD007800
SW04PACK EQU   1                   CONTROL FIELD IS TO BE PACKED        BD007810
SW04BNO  EQU   2                   INSERT BATCH NUMBER                  BD007820
SW04SRC  EQU   4                   FIELD IS TO BE RETRIEVD FROM W/S     BD007830
         MEND                                                           BD007840
./ ADD NAME=CB05                                                        BD007850
         MACRO                                                          BD007860
&NAME    CB05  &DUMMY                                                   BD007870
*********************************************************************** BD007880
*        FORMAT OF MS05 CONTROL BLOCK                                 * BD007890
*********************************************************************** BD007900
         SPACE 1                                                        BD007910
CB05NTRY DSECT                     BATCH CARD FIELD CHAIN ELEMENT       BD007920
CB05FLAG DS    0CL1                CONTROL BLOCK FLAG                   BD007930
CB05CB05 DS    F                   ADDRESS OF NEXT ASSOC CB05 ENTRY     BD007940
CB05CCNO DS    PL2                 CONTROL CARD SEQUENCE NUMBBER        BD007950
CB05FNO  DS    CL2                 FIELD NAME OR TEST ID                BD007960
CB05TID  DS    CL1                 INTERNAL CODE FOR TEST ID            BD007970
CB05PBCF DS    CL1                 POSN OF BATCH CARD TOTAL FIELD       BD007980
CB05LBCF DS    CL1                 LGTH OF BATCH CARD TOTAL FIELD       BD007990
CB05NDEC DS    PL1                 NO. OF (IMPLIED) DECIMALS            BD008000
CB05SW   DS    CL1                 SWITCH BYTE                          BD008010
CB05BVAL DS    PL8                 FIELD VALUE FROM BATCH CARD          BD008020
CB05BACC DS    PL8                 FIELD VALUE ACCUMULATED              BD008030
CB05LVAL DS    PL8                 LITERAL VALUE AGAINST WHICH TO BALNC BD008040
CB05NA1  DS    0CL32               HEADING LINES FOR FIELD A1           BD008050
CB05LNE1 DS    CL16                FIRST LINE OF NAME                   BD008060
CB05LNE2 DS    CL16                SECOND LINE OF NAME                  BD008070
CB05PNEG DS    CL1                 POSN OF -VE IDENTIFIER               BD008080
CB05LNEG DS    CL1                 LGTH OF -VE IDENTIFIER               BD008090
CB05IDNG DS    CL6                 LITERAL -VE IDENTIFIER               BD008100
CB05LGTH EQU   *-CB05NTRY          LENGTH OF CONTROL BLOCK              BD008110
         SPACE 5                                                        BD008120
SW05BAL  EQU   1                   ON=BALANCING / OFF=ALGEBRAIC         BD008130
SW05SOFT EQU   2                   ON=SOFT      / OFF=HARD              BD008140
SW05VALU EQU   4                   MS05 CONTAINED BALANCING VALUE       BD008150
SW05FLD  EQU   8                   FIELD ID                             BD008160
SW05TST  EQU   16                  TEST REQUEST                         BD008170
SW05NGID EQU   32                  SEPARATE NEGATIVE ID PRESENT         BD008180
SW05NGNZ EQU   64                  NON-ZERO FIELD AUTOMATICCALLY -VE    BD008190
SW05DPRT EQU   128                 ONLY PRINT TOTAL IF DISCREPANCY      BD008200
         MEND                                                           BD008210
./ ADD NAME=CB11                                                        BD008220
         MACRO                                                          BD008230
&NAME    CB11  &DUMMY                                                   BD008240
*********************************************************************** BD008250
*        FORMAT OF MS11 CONTROL BLOCK                                 * BD008260
*********************************************************************** BD008270
         SPACE 1                                                        BD008280
CB11NTRY DSECT                     DETAIL CARD FIELD CHAIN ELEMENT      BD008290
CB11FLAG DS    0CL1                CONTROL BLOCK FLAG                   BD008300
CB11CB11 DS    F                   ADDRESS OF NEXT CB11 ELEMENT         BD008310
CB11SB11 DS    F                   ADDRESS OF 1ST ASSOC SUB-BLOCK       BD008320
CB11CB13 DS    F                   ADDRESS OF 1ST ASSOC CB13 BLOCK      BD008330
CB11CB14 DS    F                   ADDRESS OF 1ST ASSOC CB14 B/B        BD008340
CB11CCNO DS    PL2                 CONTROL CARD SEQUENCE NUMBBER        BD008350
CB11PRTI DS    CL1                 POSN OF RECORD TYPE IDENTIFIER       BD008360
CB11LRTI DS    CL1                 LGTH OF RECORD TYPE IDENTIFIER       BD008370
CB11RTI  DS    CL8                 LITERAL RECORD TYPE IDENTIFIER       BD008380
CB11CNT  DS    PL4                 COUNT OF RECORDS OF THIS TYPE        BD008390
CB11SW   DS    CL1                 SWITCH BYTE                          BD008400
CB11LGTH EQU   *-CB11NTRY          LENGTH OF CONTROL BLOCK              BD008410
         MEND                                                           BD008420
./ ADD NAME=SB11                                                        BD008430
         MACRO                                                          BD008440
&NAME    SB11  &DUMMY                                                   BD008450
*********************************************************************** BD008460
*        FORMAT OF MS11 SUB-BLOCK                                     * BD008470
*********************************************************************** BD008480
         SPACE 1                                                        BD008490
SB11NTRY DSECT                     SUB-BLOCK FOR CB11 DEFINING 1 FIELD  BD008500
SB11FLAG DS    0CL1                CONTROL BLOCK FLAG                   BD008510
SB11SB11 DS    F                   ADDRESS OF NEXT ASSOC SB11           BD008520
SB11CB05 DS    F                   ADDRESS OF ASSOC MS05 DETAIL FIELD   BD008530
SB11CB04 DS    F                   ADDRESS OF ASSOC CB04 BATCH FIELD    BD008540
SB11CCNO DS    PL2                 CONTROL CARD SEQUENCE NUMBBER        BD008550
SB11FNO  DS    CL2                 FIELD NAME OR TEST TYPE              BD008560
SB11CRFN DS    CL2                 FIELD NAME OF C/R FIELD              BD008570
SB11TID  DS    CL1                 INTERNAL CODE FOR TEST ID            BD008580
SB11PDC  DS    CL1                 POSN OF DETAIL FIELD                 BD008590
SB11LDC  DS    CL1                 LGTH OF DETAIL FIELD                 BD008600
SB11NDEC DS    PL1                 NO. OF (IMPLIED) DECIMALS            BD008610
SB11SW   DS    CL1                 SWITCH BYTE                          BD008620
SB11SW2  DS    CL1                 SECOND SWITCH BYTE                   BD008630
SB11LGTH EQU   *-SB11NTRY          LENGTH OF MS11 CONTROL BLOCK         BD008640
SB12PNEG DS    CL1                 POSN OF -VE INDICATOR IS             BD008650
SB12LNEG DS    CL1                 LGTH OF -VE INDICATOR IS             BD008660
SB12NGID DS    CL7                 LITERAL -VE INDICATOR IS             BD008670
SB12LGTH EQU   *-SB11NTRY          LENGTH OF MS12 CONTROL BLOCK         BD008680
         SPACE 4                                                        BD008690
SW11IGN  EQU   1                   DO NOT PROCESS THIS RECORD TYPE      BD008700
SW11DMOD EQU   1                   ACCUMULATE ABSOLUTE VALUES           BD008710
SW11SOFT EQU   2                   ON = SOFT / OFF = HARD               BD008720
SW11DBCN EQU   4                   B/C FIELD NO SUPPLIED                BD008730
SW11DCRN EQU   8                   C/R FIELD NO SUPPLIED                BD008740
SW11DTID EQU   16                  TEST IS REQUESTED                    BD008750
SW11INPD EQU   32                  INPUT FIELD IS PACKED DECIMAL        BD008760
SW11NGID EQU   64                  -VE INDICATED BY A SEPARATE FIELD    BD008770
SW11NGNZ EQU   128                 NONZERO FIELD AUTOMATICALLY NEGATIV  BD008780
SW11COND EQU   1                   ACCUMULATOR CONDITIONAL ON R6-R9 OPC BD008790
         MEND                                                           BD008800
./ ADD NAME=CB13                                                        BD008810
         MACRO                                                          BD008820
&NAME    CB13  &DUMMY                                                   BD008830
*********************************************************************** BD008840
*        FORMAT OF MS13 CONTROL BLOCK                                 * BD008850
*********************************************************************** BD008860
         SPACE 1                                                        BD008870
CB13NTRY DSECT                     DETAIL CARD TEST SPECIFICATION       BD008880
CB13FLAG DS    0CL1                CONTROL BLOCK FLAG                   BD008890
CB13CB13 DS    F                   ADDRESS OF NEXT CB13                 BD008900
CB13CBXX DS    F                   POINTER TO ASSOCIATED CB2X0CB3X IF R BD008910
CB13CCNO DS    PL2                 CONTROL CARD SEQUENCE NUMBBER        BD008920
CB13PRT1 DS    CL1                 POSN OF 1ST SEGMENT OF COMPARAND     BD008930
CB13LRT1 DS    CL1                 LGTH OF 1ST SEGMENT OF COMPARAND     BD008940
CB13PRT2 DS    CL1                 POSN OF 2ND SEGMENT OF COMPARAND     BD008950
CB13LRT2 DS    CL1                 LGTH OF 2ND SEGMENT OF COMPARAND     BD008960
CB13PRT3 DS    CL1                 POSN OF 3RD SEGMENT OF COMPARAND     BD008970
CB13LRT3 DS    CL1                 LGTH OF 3RD SEGMENT OF COMPARAND     BD008980
CB13LTYP DS    CL1                 INTERNAL REPRESENTATION OF LIT TEST  BD008990
CB13LIT  DS    CL18                LITERAL COMPARAND ( CONCATENATED )   BD009000
CB13IND0 DS    0CL2                IST INDICATOT DEFINITION             BD009010
CB13IND  DS    CL1                 INDICATOR NUMBER TO BE TESTED        BD009020
CB13ONOF DS    CL1                 INTERNAL REP OF DESIRED INDICATOR ST BD009030
CB13IND1 DS    CL2                 AS CB13IND - CB13ONOF                BD009040
CB13IND2 DS    CL2                 AS CB13IND - CB13ONOF                BD009050
CB13PFLD DS    CL1                 POSN OF FIELD TO BE TESTED           BD009060
CB13LFLD DS    CL1                 LGTH OF FIELD TO BE TESTED           BD009070
CB13TEST DS    CL1                 TEST TYPE ( INTERNAL REPRESENTATION) BD009080
CB13TST0 DS    0CL2                TEST TYPE IN CHARACTER               BD009090
CB13TST1 DS    CL1                 1ST CHAR OF TEST TYPE                BD009100
CB13TST2 DS    CL1                 2ND CHAR OF TEST TYPE                BD009110
CB13CBID DS    CL2                 ID OF ASSOC MS2X/3X IF RELEVANT      BD009120
CB13TMOD DS    CL1                 MODIFIER FOR NUMERIC TESTS           BD009130
CB13RIND DS    CL1                 RESULT ( ERROR ) INDICATOR NUMBER    BD009140
CB13SW   DS    CL1                 SWITCH BYTE                          BD009150
CB13SW2  DS    CL1                 2ND SWITCH BYTE                      BD009160
CB13LGTH EQU   *-CB13NTRY          LENGTH OF BASIC CONTROL BLOCK        BD009170
CB13MESS DS    CL30                OPTIONAL ERROR MESSAGE               BD009180
         SPACE 5                                                        BD009190
SW13MESS EQU   1                   OPTIONAL MESSAGE IS PRESENT          BD009200
SW13LIT  EQU   2                   BLOCK CONTAINS COMPARAND             BD009210
SW13SOFT EQU   4                   ON=SOFT       /OFF=HARD              BD009220
SW13DLET EQU   8                   DELETE RECORD IF TEST NOT SATISFIED  BD009230
SW13NTST EQU   16                  C/B NO-OPED - INVALID TEST REQUETS   BD009240
SW13OIND EQU   32                  SET RESULT INDICATOR  ONLY           BD009250
SW13RIND EQU   64                  SET INDICATOR IF TEST SATISFIED      BD009260
SW13CBXX EQU   128                 ASSOC CBXX ADDRESS REQUIRED          BD009270
SW13INDS EQU   1                   INDICATOR TESTS ARE TO BE MADE       BD009280
SW132TMB EQU   2                   TERMINATE PROCESSING OF THIS TEST FA BD009290
SW132TMG EQU   4                   TERMINATE IF THE TEST SUCCEDDS       BD009300
         MEND                                                           BD009310
./ ADD NAME=CB14                                                        BD009320
         MACRO                                                          BD009330
&NAME    CB14  &DUMMY                                                   BD009340
*********************************************************************** BD009350
*        FORMAT OF MS14 CONTROL BLOCK                                 * BD009360
*********************************************************************** BD009370
         SPACE 1                                                        BD009380
CB14NTRY DSECT                                                          BD009390
CB14FLAG DS    0CL1                CONTROL BLOCK FLAG                   BD009400
CB14CB14 DS    F                   ADDRESS OF NEXT CB14                 BD009410
CB14CCNO DS    PL2                 CONTROL CARD SEQUENCE NUMBBER        BD009420
CB14SW   DS    CL1                 SWITCH BYTE                          BD009430
CB14TST0 DS    0CL2                DEFINITION OF 1ST INDICATOR TEST     BD009440
CB14IND  DS    CL1                 INDICATOR NUMBER                     BD009450
CB14ONOF DS    CL1                 INTERNAL REPRESENTATION OF DESIRED S BD009460
CB14TST1 DS    CL2                 AS CB14IND - CB14ONOF                BD009470
CB14TST2 DS    CL2                 AS CB14IND - CB14ONOF                BD009480
CB14TST3 DS    CL2                 AS CB14IND - CB14ONOF                BD009490
CB14TST4 DS    CL2                 AS CB14IND - CB14ONOF                BD009500
CB14TST5 DS    CL2                 AS CB14IND - CB14ONOF                BD009510
CB14TST6 DS    CL2                 AS CB14IND - CB14ONOF                BD009520
CB14TST7 DS    CL2                 AS CB14IND - CB14ONOF                BD009530
CB14TST8 DS    CL2                 AS CB14IND - CB14ONOF                BD009540
CB14TST9 DS    CL2                 AS CB14IND - CB14ONOF                BD009550
CB14LGTH EQU   *-CB14NTRY          LENGTH OF DSECT                      BD009560
         SPACE 5                                                        BD009570
SW14BTCH EQU   1                   OFF=DETAIL LEVEL / ON=BATCH LEVEL    BD009580
         MEND                                                           BD009590
./ ADD NAME=CB20                                                        BD009600
         MACRO                                                          BD009610
&NAME    CB20  &DUMMY                                                   BD009620
*********************************************************************** BD009630
*        FORMAT OF MS20 CONTROL BLOCK                                 * BD009640
*********************************************************************** BD009650
         SPACE 1                                                        BD009660
*        THIS C/B IS COMMON TO ISAM & RIGAM FILES, & INTERNAL TABLES    BD009670
         SPACE 1                                                        BD009680
CB20NTRY DSECT                     ISAM FILL KEY CONSTRUCTION           BD009690
CB20FLAG DS    0CL1                CONTROL BLOCK FLAG                   BD009700
CB20CB20 DS    F                   ADDRESS OF NEXT CB2X/CB3X            BD009710
CB20TID  DS    CL2                 TEST ID ( LABEL )                    BD009720
CB20CCNO DS    PL2                 CONTROL CARD SEQUENCE NUMBBER        BD009730
CB20CB21 DS    F                   ADDRES  OF 1ST CB21 C/B              BD009740
CB20POOL DS    F                   ADDR OF LITERAL POOL OF KEY COMPONS  BD009750
CB20TKEY DS    F                   ADDRESS OF CURRENT KEY               BD009760
CB20LKEY DS    F                   ADDRESS OF PREVIOUS KEY              BD009770
CB20DCBS DS    0CL28               I/O CONTROL BLOCK ( DCBSW )          BD009780
CB20ISW  DS    CL1                 I/O COMTROL SWITCH                   BD009790
         DS    CL1                 EOF INDICATOR ( UNUSED )             BD009800
CB20XORY DS    CL1                 RESULT OF IS LOOKUP                  BD009810
         DS    CL1                 UNDEFINED IN DCBSW                   BD009820
CB20IDCB DS    F                   ADDRESS OF DCB                       BD009830
CB20IDDN DS    0CL8                DDNAME ( FOR I/S ONLY )              BD009840
CB20RFNO DS    CL2                 FILE NUMBER                          BD009850
CB20RFID DS    CL3                 RIGAM FILE ID                        BD009860
CB20RFLN DS    CL3                 RIGAM RECORD LENGTH                  BD009870
CB20IREC DS    F                   ADDRESS OF CURRENT RECORD S/A        BD009880
CB20ICNT DS    PL4                 RECORD COUNT                         BD009890
CB20I4SA DS    F                   SAVE AREA FOR REG 4                  BD009900
CB20BADR DS    F                   ADDRESS OF CURRENT REC IN BUFFER     BD009910
CB20SW   DS    CL1                 SWITCH BYTE                          BD009920
CB20KLEN DS    CL1                 KEY LENGTH                           BD009930
CB20FLD1 DS    0CL3                DESCRIPTION OF 1ST KEY COMPONENT     BD009940
CB20POS  DS    CL1                 POSN OF COMPONENT IN SOURCE          BD009950
CB20LEN  DS    CL1                 LGTH OF COMPONENT IN SOURCE          BD009960
CB20TYP  DS    CL1                 NATURE OF SOURCE ( B/C, D/C, LITERL) BD009970
CB20FLD2 DS    CL3                 AS CB20POS - CB20TYP                 BD009980
CB20FLD3 DS    CL3                 AS CB20POS - CB20TYP                 BD009990
CB20FLD4 DS    CL3                 AS CB20POS - CB20TYP                 BD010000
CB20FLD5 DS    CL3                 AS CB20POS - CB20TYP                 BD010010
CB20FLD6 DS    CL3                 AS CB20POS - CB20TYP                 BD010020
CB20FLD7 DS    CL3                 AS CB20POS - CB20TYP                 BD010030
CB20FLD8 DS    CL3                 AS CB20POS - CB20TYP                 BD010040
CB20LGTH EQU   *-CB20NTRY          LENGTH OF BASIC DSECT                BD010050
         SPACE 5                                                        BD010060
SW20IS   EQU   1                   ON = ISAM / OFF = RIGAM              BD010070
         MEND                                                           BD010080
./ ADD NAME=CB21                                                        BD010090
         MACRO                                                          BD010100
&NAME    CB21  &DUMMY                                                   BD010110
*********************************************************************** BD010120
*        FORMAT OF MS21 CONTROL BLOCK                                 * BD010130
*********************************************************************** BD010140
         SPACE 1                                                        BD010150
*        THIS C/B IS COMMON TO ISAM & RIGAM FILES, & INTERNAL TABLES    BD010160
         SPACE 1                                                        BD010170
CB21NTRY DSECT                     DEFINITION OF DATA TO BE EXTRACTED   BD010180
CB21FLAG DS    0CL1                CONTROL BLOCK FLAG                   BD010190
CB21CB21 DS    F                   ADDRESS OF NEXT CB21                 BD010200
CB21CCNO DS    PL2                 CONTROL CARD SEQUENCE NUMBBER        BD010210
CB21SPOS DS    CL1                 POSN OF FIELD IN FILE                BD010220
CB21SLEN DS    CL1                 LGTH OF FIELD IN FILE                BD010230
CB21DPOS DS    CL1                 POSN OF FIELD IN OUTPUT RECORD       BD010240
CB21SW   DS    CL1                 SWITCH BYTE                          BD010250
CB21LGTH EQU   *-CB21NTRY          LENGTH OF BASIC DSECT                BD010260
CB21PADC DS    0CL1                PAD CHARACTER IF RELEVANT            BD010270
CB21LIT  DS    CL20                DEFAULT LITERAL VALUE IF RELEVANT    BD010280
         SPACE 5                                                        BD010290
SW21PACK EQU   1                   PACK SOURCE BEFORE MOVE              BD010300
SW21UNP  EQU   2                   UNPACK SOURCE BEFORE MOVE            BD010310
SW21LIT  EQU   4                   USE DEFAULT LITERAL IF NO MATCH      BD010320
SW21PAD  EQU   8                   PAD DERIVED FIELD IF NO MATCH        BD010330
         MEND                                                           BD010340
./ ADD NAME=CB30                                                        BD010350
         MACRO                                                          BD010360
&NAME    CB30  &DUMMY                                                   BD010370
*********************************************************************** BD010380
*        FORMAT OF MS30 CONTROL BLOCK                                 * BD010390
*********************************************************************** BD010400
         SPACE 1                                                        BD010410
CB30NTRY DSECT                                                          BD010420
CB30FLAG DS    0CL1                CONTROL BLOCK FLLAG                  BD010430
CB30CB30 DS    F                   ADDRESS OF NEXT CBXX C/B             BD010440
CB30TID  DS    CL2                 TEST ID ( LABEL )                    BD010450
CB30CCNO DS    PL2                 CONTROL CARD SEQUENCE NUMBBER        BD010460
CB30SW   DS    CL1                 SWITCH BYTE                          BD010470
CB30RNG1 DS    CL16                RANGE 1 ( START OF RANGE OR LITERAL) BD010480
CB30RNG2 DS    CL16                RANGE 2 ( END OF RANGE )             BD010490
CB30LGTH EQU   *-CB30NTRY          LENGTH OF DSECT                      BD010500
         SPACE 5                                                        BD010510
SW30PAKD EQU   1                   ON  = PACKED DECIMAL COMPARE         BD010520
*                                  OFF = CHARACTER COMPARE              BD010530
SW30EXT  EQU   2                   ON  = R1 < R2 & FLD < R1 | R2 < FLD  BD010540
*                                  OFF = R1 <= FLD <= R2                BD010550
         MEND                                                           BD010560
./ ADD NAME=CB32                                                        BD010570
         MACRO                                                          BD010580
&NAME    CB32  &DUMMY                                                   BD010590
*********************************************************************** BD010600
*        FORMAT OF MS32 CONTROL BLOCK                                 * BD010610
*********************************************************************** BD010620
         SPACE 1                                                        BD010630
CB32NTRY DSECT                                                          BD010640
CB32FLAG DS    0CL1                CONTROL BLOCK FLAG                   BD010650
CB32CB32 DS    F                   ADDRESS OF NEXT CB2X/CB3X C/B        BD010660
CB32TID  DS    CL2                 TEST ID ( LABEL )                    BD010670
CB32CCNO DS    PL2                 CONTROL CARD SEQUENCE NUMBBER        BD010680
CB32SW1  DS    CL1                 SWITCH BYET                          BD010690
CB32SW2  DS    CL1                 ANOTHER SWITCH BYTE                  BD010700
CB32SW3  DS    CL1                 YET ANOTHER SWITCH BYTE              BD010710
CB32ICP  DS    CL1                 POSN OF INPUT CURRENCY CODE          BD010720
CB32OCP  DS    CL1                 POSN OF OUTPUT CURRENCY CODE         BD010730
CB32INP  DS    CL1                 POSN OF INPUT VALUE                  BD010740
CB32INL  DS    CL1                 LGTH OF INPUT VALUE                  BD010750
CB32OUTP DS    CL1                 POSN OF OUTPUT VALUE                 BD010760
CB32OUTL DS    CL1                 LGTH OF OUTPUT VALUE                 BD010770
CB32RTEP DS    CL1                 POSN OF CONVERSION RATE              BD010780
CB32RTEL DS    CL1                 LGTH OF CONVERSION RATE              BD010790
CB32OUTA DS    CL1                 OUTPUT ALIGNMENT                     BD010800
CB32NMIP DS    CL1                 POSN OF NAME OF INPUT CURRENCY CODE  BD010810
CB32NMOP DS    CL1                 POSN OF NAME OF OUTPUT CURRENCY CODD BD010820
CB32VNOP DS    CL1                 POSN OF VERSION NUMBER               BD010830
CB32ICDE DS    CL2                 LITERAL INPUT CURRENCY CODE          BD010840
CB32OCDE DS    CL2                 LITERAL OUTPUT CURRENCY CODE         BD010850
CB32RNDN DS    PL1                 NO. OF DIGITS TO BE ZEROISED IN ROUN BD010860
CB32LGTH EQU   *-CB32NTRY          LENGTH OF DSECT                      BD010870
         SPACE 5                                                        BD010880
SW321ICL EQU   1                   INPUT CUDRENCT CODE IS A LITERAL     BD010890
SW321OCL EQU   2                   OUTPUT CURRENCY COE IS A LITERAL     BD010900
SW321ICS EQU   4                   TAKE INPUT CURRENCY CODE FROM MS13   BD010910
SW321OCS EQU   8                   TAKE OUTPUT CURRENCY CODE FROM MS13  BD010920
SW321IVS EQU   16                  TAKE INPUT VALUE FROM MS13           BD010930
SW321RTE EQU   32                  PERFORM CURRENCY CONVERSION RATE EXT BD010940
SW321NOC EQU   64                  NO CURRENCY CONVERSION REQUIRED      BD010950
SW321ZRO EQU   128                 ZEROISE RECEIVING FIELD IF CONV ERRO BD010960
SW322IVP EQU   1                   INPUT VALUE IS PACKED                BD010970
SW322OVP EQU   2                   OUTPUT VALUE IS PACKED               BD010980
SW322RTP EQU   4                   CONVERSION RATE IS TP BE OUTPUT PACK BD010990
SW322VNO EQU   8                   CURRENCY TABLE VERSION NAUMBER IS RE BD011000
SW322INM EQU   16                  NAME OF INPUT  CODE IS REQUIRDD      BD011010
SW322ONM EQU   32                  NAME OF OUTPUT CODE IS REQUIRDD      BD011020
SW322OVS EQU   64                  TAKE OUTPUT FIELD PL FROM MS13       BD011030
SW322RTS EQU   128                 POSN OF RATE TO BE EXTRACTED FROM MS BD011040
SW323RND EQU   1                   ROUNDING IS REQUIRED                 BD011050
SW323COM EQU   3                   'COMMERCIAL' ROUNDING ONLY           BD011060
         MEND                                                           BD011070
./ ADD NAME=CB33                                                        BD011080
         MACRO                                                          BD011090
&NAME    CB33  &DUMMY                                                   BD011100
*********************************************************************** BD011110
*        FORMAT OF MS33 CONTROL BLOCK                                 * BD011120
*********************************************************************** BD011130
         SPACE 1                                                        BD011140
CB33NTRY DSECT                                                          BD011150
CB33FLAG DS    0CL1                CONTROL BLOCK FLAG                   BD011160
CB33CB33 DS    F                   ADDRESS OF NEXT CBXX C/B             BD011170
CB33TID  DS    CL2                 TEST ID (LABEL )                     BD011180
CB33CCNO DS    PL2                 CONTROL CARD SEQUENCE NUMBBER        BD011190
CB33POS1 DS    CL1                 POSN OF 'FROM'FIELD                  BD011200
CB33LEN1 DS    CL1                 LGTH OF 'FROM'FIELD                  BD011210
CB33POS2 DS    CL1                 POSN OF 'TO' FIELD                   BD011220
CB33LEN2 DS    CL1                 LGTH OF 'TO' FIELD                   BD011230
CB33TYPE DS    CL1                 TEST TYPE ( IF COMPARISON )          BD011240
CB33SW   DS    CL1                 SWITCH BYTE                          BD011250
CB33LGTH EQU   *-CB33NTRY          LENGTH OF BASIC DSECT                BD011260
CB33LIT  DS    CL1                 VARIABLE LENGTH OPTIONAL LITERAL     BD011270
         SPACE 5                                                        BD011280
SW33MOVE EQU   1                   OFF - FIELDS ARE TO BE COMPARED      BD011290
*                                  ON  - FIELDS ARE TO BE MOVED         BD011300
SW33LIT  EQU   2                   'FROM' FIELD IS LITERAL CONSTANAT    BD011310
SW33MP   EQU   4                   IN UNPACKED, OUT PACKED              BD011320
SW33MU   EQU   8                   IN PACKED, OUT UNPACKED              BD011330
SW33CNUM EQU   16                  NUMERIC COMPARE: FLDS UNPACKED       BD011340
SW33CPD  EQU   32                  NUMERIC COMPARE: FLDS PACKED         BD011350
         MEND                                                           BD011360
./ ADD NAME=CB34                                                        BD011370
         MACRO                                                          BD011380
&NAME    CB34  &DUMMY                                                   BD011390
*********************************************************************** BD011400
*        FORMAT OF MS34 CONTROL BLOCK                                 * BD011410
*********************************************************************** BD011420
         SPACE 1                                                        BD011430
CB34NTRY DSECT                                                          BD011440
CB34FLAG DS    0CL1                CONTROL BLOCK FLAG                   BD011450
CB34CB34 DS    F                   ADDRESS OF NEXT CB2X/3X/4X           BD011460
CB34TID  DS    CL2                 TEST ID ( LABEL )                    BD011470
CB34CCNO DS    PL2                 CONTROL CARD SEQUENCE NUMBBER        BD011480
CB34LENO DS    F                   OUTSTANDING ( UNFILLED ) LENGTH      BD011490
CB34NPOS DS    F                   ADDRESS OF NEXT AVAILABLE BYTE       BD011500
CB34NLST DS    CL1                 NUMBER OF ENTRIES IN LIST            BD011510
CB34LLST DS    CL1                 LENGTH OF EACH ENTRYY                BD011520
CB34SW   DS    CL1                 SWITCH BYTE                          BD011530
CB34LGTH EQU   *-CB34NTRY          LENGTH OF BASIC C/B                  BD011540
CB34LIST DS    CL1                 VARIABLE LENGTH CONCATENATED LIST    BD011550
         SPACE 5                                                        BD011560
SW34BBLD EQU   1                   REBUILD LIST FOR EACH BATCH          BD011570
         MEND                                                           BD011580
./ ADD NAME=CB36                                                        BD011590
         MACRO                                                          BD011600
&NAME    CB36  &DUMMY                                                   BD011610
*********************************************************************** BD011620
*        FORMAT OF MS36 CONTROL BLOCK                                 * BD011630
*********************************************************************** BD011640
         SPACE 1                                                        BD011650
CB36NTRY DSECT                                                          BD011660
CB36FLAG DS    0CL1                CONTROL BLOCK FLAG                   BD011670
CB36CB36 DS    F                   ADDRESS OF NEXT CB2X/3X              BD011680
CB36TID  DS    CL2                 TEST ID ( LABEL )                    BD011690
CB36CCNO DS    PL2                 CONTROL CARD SEQUENCE NUMBBER        BD011700
CB36SW   DS    CL1                 SWITCH BYTE                          BD011710
CB36OPCD DS    CL1                 INTERNAL REPRESANTATION OF OPERATION BD011720
CB36POS1 DS    CL1                 POSN F 1ST OPERAND                   BD011730
CB36LEN1 DS    CL1                 LGTH F 1ST OPERAND                   BD011740
CB36NDC1 DS    CL2 (HALFWORD ALIG) NO OF DECIMAL PLACES OF 1ST OPERAND  BD011750
CB36POS2 DS    CL1                 POSN OF 2ND OPERAND                  BD011760
CB36LEN2 DS    CL1                 LGTH OF 2ND OPERAND                  BD011770
CB36NDC2 DS    CL2 (HALFWORD ALIGN) NO OF DECIMAL PLACES OF 2ND OPERAND BD011780
CB36POS3 DS    CL1                 POSN OF RESULT FIELD                 BD011790
CB36LEN3 DS    CL1                 LGTH OF RESULT FIELD                 BD011800
CB36NDC3 DS    CL2 (HALFWORD ALIGN) NO OF DECIMAL PLACES IN RESULT      BD011810
CB36POS4 DS    CL1                 POSN OF REMAINDER                    BD011820
CB36LEN4 DS    CL1                 LGTH OF REMAINDER                    BD011830
CB36NDC4 DS    CL2 ( HALFWORD ALIGNNDEC OF REMAINDER                    BD011840
CB36RNDN DS    CL1                 NO OF PLACES TO BE ROUNDED           BD011850
CB36LGTH EQU   *-CB36NTRY          LENGTH OF DSECT                      BD011860
CB36LIT  DS    PL8                 OPTIONAL LITERAL VALUE FOR OPERAND 2 BD011870
         SPACE 5                                                        BD011880
SW36PCK1 EQU   1                   1ST OPERAND IS PACKED                BD011890
SW36PCK2 EQU   2                   2ND OPERAND IS PACKED                BD011900
SW36PCK3 EQU   4                   RESULT IS TO BE PAC-ED               BD011910
SW36RND  EQU   8                   ROUNDING IS REQUIRED                 BD011920
SW36LIT  EQU   16                  OPERAND 2 IS SUPPLIED LITERAL        BD011930
SW36NRND EQU   32                  ALL ROUNDING TO BE SUPPRESSED        BD011940
SW36REM  EQU   64                  REMAINDER IS REQUIRED                BD011950
SW36REMP EQU   128                 REMAINDER IS TO BE PACKED            BD011960
         MEND                                                           BD011970
./ ADD NAME=CB37                                                        BD011980
         MACRO                                                          BD011990
&NAME    CB37  &DUMMY                                                   BD012000
*********************************************************************** BD012010
*        FORMAT OF MS37 CONTROL BLOCK                                 * BD012020
*********************************************************************** BD012030
         SPACE 1                                                        BD012040
CB37NTRY DSECT                                                          BD012050
CB37FLAG DS    0CL1                CONTROL BLOCK FLAG                   BD012060
CB37CB37 DS    F                   ADDRESS OF NEXT CB2X/3X/4X           BD012070
CB37TID  DS    CL2                 TEST ID ( LABEL )                    BD012080
CB37CCNO DS    PL2                 CONTROL CARD SEQUENCE NUMBBER        BD012090
CB37POS1 DS    CL1                 POSN OF INPUT FIELD                  BD012100
CB37LEN1 DS    CL1                 LGTH OF INPUT FIELD                  BD012110
CB37POS2 DS    CL1                 POSN OF OUTPUT FIELD                 BD012120
CB37LEN2 DS    CL1                 LGTH OF OUTPUT FIELD                 BD012130
CB37DEC1 DS    CL1                 DEFAULT NO OF DECIMAL PLACES IN INPT BD012140
CB37DEC2 DS    CL1                 NO OF DECIMAL PLACES IN OUTPUT FIELD BD012150
CB37DECC DS    CL1                 COMPUTED NO OF DEC PLACES IN INPUT   BD012160
CB37SW   DS    CL1                 SWITCH BYTE                          BD012170
CB37LGTH EQU   *-CB37NTRY          LENGTH OF CONTROL BLOCK              BD012180
         SPACE 5                                                        BD012190
SW37PACK EQU   1                   OUTPUT IS TO BE PACKED               BD012200
         MEND                                                           BD012210
./ ADD NAME=CB40                                                        BD012220
         MACRO                                                          BD012230
&NAME    CB40  &DUMMY                                                   BD012240
*********************************************************************** BD012250
*        FORMAT OF MS40 CONTROL BLOCK                                 * BD012260
*********************************************************************** BD012270
         SPACE 1                                                        BD012280
CB40NTRY DSECT                     DEFINE CB13 SUBROUTINE               BD012290
CB40FLAG DS    0CL1                CONTROL BLOCK ID                     BD012300
CB40CB40 DS    F                   ADDRESS OF NEXT CBXX                 BD012310
CB40TID  DS    CL2                 SUBROUTINE NAME ( LABEL )            BD012320
CB40CCNO DS    PL2                 CONTROL CARD SEQUENCE NUMBBER        BD012330
CB40SW   DS    CL1                 SWITCH BYTE                          BD012340
         DS    CL1                 UNUSED                               BD012350
CB40FRST DS    F                   ADDRESS OF 1ST CB13 IN RUTINE        BD012360
CB40LAST DS    F                   ADDRESS OF LAST CB13 IN ROUTINE      BD012370
CB40LGTH EQU   *-CB40NTRY          LENGTH OF CONTROL BLOCK              BD012380
         MEND                                                           BD012390
./ ADD NAME=URTNPARM                                                    BD012400
         MACRO                                                          BD012410
&NAME URTNPARM &DUMMY                                                   BD012420
*********************************************************************** BD012430
*        FORMAT OF USER ROUTINE PARAMETER AREA                        * BD012440
*********************************************************************** BD012450
         SPACE 1                                                        BD012460
*        NOTE THAT THIS AREA IS IMMEDIATELY PRECEDED BY THE INPUT       BD012470
*         RECORD IMAGE.                                                 BD012480
*                                                                       BD012490
*        NOTE ALSO THAT THIS COMPOSITE AREA IS USED BY BASIC BUDGIE     BD012500
*         REGARDLESS OF WHETHER OR NOT USER MODULES ARE SPECIFIED.      BD012510
*         THE INPUT RECORD IMAGE IS LEFT UNMODIFIED, AND ALL EDITING    BD012520
*         AND INSERTION TAKES PLACE IN THE 'OUTPUT' AREA. THUS WHEN THE BD012530
*         USER RECEIVES CONTROL, THE OUTPUT AREA ARREADY CONTAINS VALID BD012540
*         DATA.                                                         BD012550
         SPACE 1                                                        BD012560
URTNPARM DSECT                     LINKAGE AREA                         BD012570
URTNCSW  DS    CL1                 CALL SWITCH:  1 - INITIALISE         BD012580
*                                                2 - BATCH CARD         BD012590
*                                                3 - DETAIL CARD        BD012600
*                                                4 - END                BD012610
*                                                5 - CALLED BY R5 OPCDE BD012620
*                                                6 - END OF BATCH       BD012630
URTNRSW1 DS    CL1                 RETURN CODE:  0 - RECORD OK          BD012640
*                                                1 - REJECT BATCH       BD012650
*                                                2 - DELETE RECORD ONLY BD012660
URTNRSW2 DS    CL1                 RETURN CODE:  0 - FINISHED WITH RECD BD012670
*                                               ^0 - PASS RECORD AGAIN  BD012680
URTNMESS DS    CL30                ERROR MESSAGE                        BD012690
URTNPOS  DS    CL2                 POSITION OF FIELD IN ERROR           BD012700
URTNLEN  DS    CL2                 LENGTH OF FIELD IN ERROR             BD012710
URTNOUT  DS    CL1                 OUTPUT RECORD - UNLIMITED LENGTH     BD012720
*                                  ... OPTIONALLY FOLLOWED BY WORK AREA BD012730
         MEND                                                           BD012740
./ ADD NAME=UT460                                                       BD012750
         MACRO                                                          BD012760
&NAME    UT460 &DUMMY                                                   BD012770
*********************************************************************** BD012780
*        FORMAT OF CURRENCY CONVERSION ROUTINE PARAMETER AREA         * BD012790
*********************************************************************** BD012800
         SPACE 1                                                        BD012810
UT460LNK DSECT                                                          BD012820
UT460INV DS    PL8                 INPUT VALUE - S9(10)V9(5)            BD012830
UT460INC DS    CL2                 INPUT CURRENCY CODE                  BD012840
UT460OTC DS    CL2                 OUTPUT CURRENCT CODE                 BD012850
UT460RTC DS    CL1                 RETRUN CODE                          BD012860
*                                   '1' - CONVERSION SUCCESSFUL         BD012870
*                                   '2' - INPUT CODE INVALID            BD012880
*                                   '3' - OUTPUT CODE INVALID           BD012890
UT460OTV DS    PL8                 OUTPUT VALUE - S9(10)V9(5)           BD012900
UT460DSI DS    CL4                 DESCRIPTION OF INPUT CURRENCY CODE   BD012910
UT460DSO DS    CL4                 DESCRIPTION OF OUTPUT CURRENCY CODE  BD012920
UT460RND DS    CL1                 ROUNDING FLAG                        BD012930
*                                   'C' - SUBJECT TO COMMERCIAL RNDING  BD012940
UT460LGT EQU   *-UT460LNK          LENGTH OF DSECT                      BD012950
         MEND                                                           BD012960
./ ADD NAME=RIGAM                                                       BD012970
         MACRO                                                          BD012980
&NAME    RIGAM &DUMMY                                                   BD012990
*********************************************************************** BD013000
*        FORMAT OF RIGAM PARAMETER AREA                               * BD013010
*********************************************************************** BD013020
         SPACE 1                                                        BD013030
RIGAMLNK DSECT                                                          BD013040
RIGMNOT1 DS    H                   NO OF TYPE 1 FILES                   BD013050
RIGMNOT2 DS    H                   NO OF TYPE 2 FILES                   BD013060
RIGMRECN DS    F                   ABSOLUTE RECORD NUMBER               BD013070
RIGMIND  DS    H                   RESULT INDICATOR                     BD013080
RIGMOPCD DS    CL3                 OPERATION CODE                       BD013090
RIGMFTYP DS    CL1                 FILE TYPE ( 1/2 )                    BD013100
RIGMFNO  DS    CL3                 FILE NUMBER                          BD013110
RIGMKEY  DS    CL35                RECORD KEY                           BD013120
RIGMMIO1 DS    CL1                 MUST BE 'N'                          BD013130
RIGMMIO2 DS    CL1                 MUST BE 'N'                          BD013140
RIGMLGTH EQU   *-RIGAMLNK          LENGTH OF DSECT                      BD013150
         MEND                                                           BD013160
./ ADD NAME=LOGCARD                                                     BD013170
         MACRO                                                          BD013180
&NAME  LOGCARD &DUMMY                                                   BD013190
*********************************************************************** BD013200
*        FORMAT OF BATCH LOG RECORD                                   * BD013210
*********************************************************************** BD013220
         SPACE 1                                                        BD013230
LOGCARD  DSECT                     BATCH LOG RECORD                     BD013240
LOGSW    DS    CL1                 'A' -ACCEPTED / 'S' - SUSPENSE       BD013250
*                                  'P' - SUSPENSE BATCH PASSED BY UPDAT BD013260
LOGBNO   DS    CL16                BATCH NUMBER                         BD013270
LOGIDTE1 DS    CL5                 DATE BATCH ENTERED INTO SYSTEM YYDDD BD013280
LOGADTE1 DS    CL5                 DATE BATCH ACCEPTED BY  SYSTEM YYDDD BD013290
LOGIDTE2 DS    CL9                 DATE BATCH ENTERED - REPORT FORMAT   BD013300
LOGADTE2 DS    CL9                 DATE BATCH ACCEPTED - REPORT FORMAT  BD013310
LOGRCNT  DS    PL3                 NUMBER OF RECORDS ENTERED            BD013320
LOGLCNT  DS    PL3                 NUMBER OF RECORDS RETRINED           BD013330
LOGHCNT  DS    PL3                 COUNT OF HARD ERRORS IN BATCH        BD013340
LOGSCNT  DS    PL3                 COUNT OF SOFT ERRORS IN BATCH        BD013350
LOGBTYPE DS    CL8                 BATCH CARD ID                        BD013360
LOGSUBID DS    CL10                SUBMITTOR ID                         BD013370
         DS    CL5                 UNUSED                               BD013380
LOGLGTH  EQU   *-LOGCARD           LENGTH OF LOG RECORD                 BD013390
         MEND                                                           BD013400
./ ADD NAME=LOGLINE                                                     BD013410
         MACRO                                                          BD013420
&NAME  LOGLINE &DUMMY                                                   BD013430
*********************************************************************** BD013440
*        FORMAT OF BATCH LOG STATUS REPORT DETAIL LINE                * BD013450
*********************************************************************** BD013460
         SPACE 1                                                        BD013470
LLOGLINE DSECT                                                          BD013480
LLOGCC   DS    CL1                 CARRIAGE CONTROL CHARACTER           BD013490
LLOGBNO  DS    CL16                BATCH NUMBER                         BD013500
         DS    CL3                 UNUSED                               BD013510
LLOGMACC DS    CL8                 'ACCEPTED' MESSAGE                   BD013520
         DS    CL2                 UNUSED                               BD013530
LLOGMSUS DS    CL8                 'SUSPENSE' MESSAGE                   BD013540
         DS    CL3                 UNUSED                               BD013550
LLOGEDTE DS    CL9                 DATE BATCH ENTERED - REPORT FORMAT   BD013560
         DS    CL3                 UNUSED                               BD013570
LLOGADTE DS    CL9                 DATE BATCH ACCEPTED - RETORT FORMAT  BD013580
         DS    CL3                 UNUSED                               BD013590
LLOGRCNT DS    CL6                 COUNT OF RECORDS ENTERED             BD013600
         DS    CL5                 UNUSED                               BD013610
LLOGLCNT DS    CL6                 COUNT OF RECORDS RETRINED            BD013620
         DS    CL3                 UNUSED                               BD013630
LLOGHCNT DS    CL6                 COUNT OF HARD ERRORS                 BD013640
         DS    CL3                 UNUSED                               BD013650
LLOGSCNT DS    CL6                 COUNT OF SOFT ERRORS                 BD013660
         DS    CL4                 UNUDED                               BD013670
LLOGTYPE DS    CL8                 BATCH CARD TYPE ( CARD IDENTIFIER )  BD013680
         DS    CL3                 UNUSED                               BD013690
LLOGSUB  DS    CL10                SUBMITTOR ID                         BD013700
LLOHLGTH EQU   *-LLOGLINE          LENGTH OF DSECT                      BD013710
         MEND                                                           BD013720
./ ADD NAME=DETAILBB                                                    BD013730
         MACRO                                                          BD013740
&NAME DETAILBB &DUMMY                                                   BD013750
*********************************************************************** BD013760
*        FORMAT OF DETAIL LINE OF B/B REPORT                          * BD013770
*********************************************************************** BD013780
         SPACE 1                                                        BD013790
DETAILBB DSECT                                                          BD013800
DTBBCC   DS    CL1                 CARRIAGE CONTROL CHARACTER           BD013810
         DS    CL2                 USED FOR CARD NO IF MORE THAN 4 DIGT BD013820
DTBBCNO  DS    CL4                 CARD NUMBER                          BD013830
         DS    CL5                 SPACES                               BD013840
DTBBCARD DS    CL80                CARD IMAGE                           BD013850
         DS    CL3                 SPACES                               BD013860
DTBBEMSS DS    CL30                ERROR MESSAGE                        BD013870
         DS    CL3                 SPACES                               BD013880
DTBBFLAG DS    CL4                 ERROR FLAG (****)                    BD013890
         DS    CL1                 SPACES                               BD013900
DTBBLGTH EQU   *-DETAILBB          LENGTH OF DSECT                      BD013910
         SPACE 5                                                        BD013920
*********************************************************************** BD013930
*        FORMAT OF TOTAL LINE OF B/B REPOTT                           * BD013940
*********************************************************************** BD013950
         SPACE 1                                                        BD013960
         ORG   DTBBCC              REDEFINE TO SATRT OF LINE            BD013970
TTBBCC   DS    CL1                 CARRIAGE CONTROL CHARACTER           BD013980
TTBBTEXT DS    CL11                DESCRIPTION OF LINE'S CONTENTS       BD013990
TTBBCNT  DS    CL8                 RECORD COUNT VALUE / HEADING         BD014000
TTBBFLD1 DS    0CL19               TOTAL LINE BUCKET                    BD014010
TTBBFLD  DS    CL16                1ST BUCKET VALUE / HEADING           BD014020
         DS    CL3                 UNUSED ( SPACES )                    BD014030
TTBBFLD2 DS    CL19                2ND TOTAL LINE BUCKET                BD014040
TTBBFLD3 DS    CL19                3RD TOTAL LINE BUCKET                BD014050
TTBBFLD4 DS    CL19                4TH TOTAL LINE BUCKET                BD014060
TTBBFLD5 DS    CL19                5TH TOTAL LINE BUCKET                BD014070
TTBBFLD6 DS    CL16                6TH TOTAL LINE BUCKET                BD014080
         DS    CL2                 UNUSED ( SPACES )                    BD014090
TTBBLGTH EQU   *-DETAILBB          LENGTH OF DSECT                      BD014100
         MEND                                                           BD014110
./ ADD NAME=CSECTID                                                     BD014120
         MACRO                                                          BD014130
&NAME  CSECTID &DUMMY                                                   BD014140
*********************************************************************** BD014150
*        CSECT IDENTIFICATION PREFIX                                  * BD014160
*********************************************************************** BD014170
         SPACE 1                                                        BD014180
CSECTID  DSECT                                                          BD014190
CSIDNAME DS    CL8                 CSECT NAME ( BUDGIE3X )              BD014200
CSIDVERS DS    CL8                 BUDGIE3 VERSION NUMBER               BD014210
CSIDDATE DS    CL8                 DATE OF ASSEMBLY OF THIS CSECT       BD014220
CSIDTIME DS    CL8                 TIME OF ASSEMBLY OF THIS CSECT       BD014230
CSIDLGTH EQU   *-CSECTID           LENGTH OF CSECT PREFIX               BD014240
         SPACE 5                                                        BD014250
*        EVERY SUB-CSECT IN BUDGIE3 STARTS WITH THIS 32-CHARACTER       BD014260
*         PREFIX TO IDENTIFY THE MODULE FOR DEBUGGING PURPOSES.  ALSO,  BD014270
*         THE CCB ( CENTRAL CONTROL BLOCK ) IN THE MAIN CSECT BUDGIE3   BD014280
*         IS IMMEDIATELY PRECEDED BY A SIMILAR PREFIX.                  BD014290
         MEND                                                           BD014300
./ ADD NAME=POOLDEFN                                                    BD014310
         MACRO                                                          BD014320
&NAME POOLDEFN &DUMMY                                                   BD014330
*********************************************************************** BD014340
*        FORMAT OF SUB-BLOCK DEFINING 'WORKFILE' STORAGE POOLS        * BD014350
*********************************************************************** BD014360
         SPACE 1                                                        BD014370
*        THIS CONTROL BLOCK IS USED TO DESCRIBE ACQUIRED STORAGE POOLS  BD014380
*         OR UNUSED CSECTS WHICH ARE AVAILABLE TO THE GETAMIN AND       BD014390
*         WORKFILE ROUTINES.                                            BD014400
         SPACE 1                                                        BD014410
POOLDEFN DSECT                     SUB-BLOCK DEFINING STORAGE POOL      BD014420
POOLSW   DS    0CL1                SWITCH BYTE                          BD014430
POOLADR  DS    F                   ADDRESS OF POOL                      BD014440
POOLSIZ  DS    F                   SIZE OF POOL                         BD014450
         ORG   POOLADR             REDEFINE OVER MULTI-USE FIELD        BD014460
GETMNPOS DS    F                   START OF AREA AVAILABLE FOR GETMAINS BD014470
GETMNLEN DS    F                   LGTH  OF AREA AVAILABLE FOR GETMAINS BD014480
POOLCAP  DS    F                   CAPACITY OF POOL ( IN RECORDS )      BD014490
POOLPTR  DS    F                   PTR TO NEXT AVAILABLE SLOT           BD014500
POOLLGTH EQU   *-POOLDEFN          LENGTH OF SUB-BLOCK                  BD014510
SPDLGTH  EQU   POOLLGTH            LENGTH OF SUB-BLOCK                  BD014520
         SPACE 5                                                        BD014530
POOLUSE  EQU   1                   STORAGE POOL AVAILABLE FOR USE       BD014540
POOLWORK EQU   2                   STORAGE POOL BEING USED BY WORK FILE BD014550
POOLGETM EQU   4                   STORAGE POOL MUST BE ACQUIRED BY GET BD014560
POOLPFRE EQU   8                   STORAGE POOL MAY BE FREEMAINED       BD014570
POOLFREE EQU   16                  STORAGE POOL HAS BEEN FREEMAINED     BD014580
POOLCSCT EQU   32                  STORAGE POOL DEFINES A CSECT         BD014590
POOLGTM  EQU   64                  STORAGE POOL AVAILABLE FOR INT GETMN BD014600
         SPACE 5                                                        BD014610
*        SECONDARY EQUATES FOR COMPATIBILITY WITH PARROT CODE           BD014620
         SPACE 1                                                        BD014630
MSPDUSE  EQU   POOLUSE             STORAGE POOL AVAILABLE FOR USE       BD014640
MSPDWORK EQU   POOLWORK            STORAGE POOL BEING USED BY WORK FILE BD014650
MSPDGETM EQU   POOLGETM            STORAGE POOL MUST BE ACQUIRED BY GET BD014660
MSPDPFRE EQU   POOLPFRE            STORAGE POOL MAY BE FREEMAINED       BD014670
MSPDFREE EQU   POOLFREE            STORAGE POOL HAS BEEN FREEMAINED     BD014680
MSPDCSCT EQU   POOLCSCT            STORAGE POOL DEFINES A CSECT         BD014690
MSPDGTM  EQU   POOLGTM             STORAGE POOL AVAILABLE FOR INT GETMN BD014700
         MEND                                                           BD014710
./ ADD NAME=EQUATES                                                     BD014720
         MACRO                                                          BD014730
&NAME  EQUATES &DUMMY                                                   BD014740
*********************************************************************** BD014750
*        REGISTER EQUATES AND USAGE                                   * BD014760
*********************************************************************** BD014770
         SPACE 1                                                        BD014780
R0       EQU   0                                                        BD014790
R1       EQU   1                   GP WORK REGISTER                     BD014800
R2       EQU   2                   GP WORK REGISTER                     BD014810
R3       EQU   3                   GP WORK REGISTER                     BD014820
R4       EQU   4                   CBAL RETURN ADDRESS                  BD014830
R5       EQU   5                   ADDRESS OF SYSPRINT BUFFRE           BD014840
R6       EQU   6                   ADDRESS OF SYSIN/SYSUT1 BUFFER       BD014850
R7       EQU   7                   ADDRESS OF PRINT BUFFER              BD014860
R8       EQU   8                   GP BUFFER/CB POINTER                 BD014870
R9       EQU   9                   GP WORK REGISTER / CBAL CONTROL DATA BD014880
R10      EQU   10                  GP WORK REG UNALTERED BY SUBRNS      BD014890
R11      EQU   11                  GP WORK REGISTER                     BD014900
R12      EQU   12                  SUB-CSECT BASE REGISTER              BD014910
R13      EQU   13                  CCB PTR / SAVE RAEA PTR / BASE REG   BD014920
R14      EQU   14                  BALR RETURN ADDRESS                  BD014930
R15      EQU   15                  BALR ROUTINE ADDRESS                 BD014940
         SPACE 5                                                        BD014950
*********************************************************************** BD014960
*        DCBSW EQUTES ( FOR IOM MACRO )                               * BD014970
*********************************************************************** BD014980
         SPACE 1                                                        BD014990
         IOM EQUATES,15,AUTOPEN=NO EQAUTES FOR IOM MACRO                BD015000
         EJECT                                                          BD015010
*********************************************************************** BD015020
*        MISCELLANEOUS EQUATES                                        * BD015030
*********************************************************************** BD015040
         SPACE 1                                                        BD015050
W        EQU   X'96'               USED FOR SETTING PSW COND CODE       BD015060
X        EQU   X'95'               USED FOR SETTING PSW COND CODE       BD015070
Y        EQU   X'94'               USED FOR SETTING PSW COND CODE       BD015080
*                                  E.G. CLI *,Y SET COND CODE HIGH      BD015090
SWNONNUM EQU   1                   SUB-FIELD NOT NUMERIC                BD015100
FF       EQU   255                 ALL-1 MASK                           BD015110
OO       EQU   0                   ALL-0 MASK                           BD015120
SWNOSUB EQU    2                   NO SUB-FIELD FOUND                   BD015130
SPCE0AFT EQU   X'01'               NO SPACE AFTER PRINT                 BD015140
SPCE1AFT EQU   X'09'               SPACE 1 AFTER PRINTING               BD015150
SPCE2AFT EQU   X'11'               SPACE 2 AFTER PRINTING               BD015160
SPCE3AFT EQU   X'19'               SPACE 3 AFTER PRINTING               BD015170
PAGESKIP EQU   X'8B'               SKIP TO NEW PAGE                     BD015180
SPCE1NPR EQU   X'0B'               SPACE 1 : NO PRINTING                BD015190
SPCE2NPR EQU   X'13'               SPACE 2 : NO PRINTING                BD015200
SPCE3NPR EQU   X'1B'               SPACE 3 : NO PRINTING                BD015210
         SPACE 5                                                        BD015220
*********************************************************************** BD015230
*        EQUATES USED TO ESATBLISH INDEXED BRANCHES AFTER A TEST      * BD015240
*********************************************************************** BD015250
         SPACE 1                                                        BD015260
EQ       EQU   1                   INTERNAL REPRESENTATION OF 'EQ'      BD015270
NE       EQU   2                   INTERNAL REPRESENTATION OF 'NE'      BD015280
GT       EQU   3                   INTERNAL REPRESENTATION OF 'GT'      BD015290
GE       EQU   4                   INTERNAL REPRESENTATION OF 'GE'      BD015300
LT       EQU   5                   INTERNAL REPRESENTATION OF 'LT'      BD015310
LE       EQU   6                   INTERNAL REPRESENTATION OF 'LE'      BD015320
ON       EQU   7                   INTERNAL REPRESENTATION OF 'ON'      BD015330
OF       EQU   8                   INTERNAL REPRESENTATION OF 'OF'      BD015340
         SPACE 5                                                        BD015350
*********************************************************************** BD015360
*        VALUES FOR SETTING THE COMPLETION CODE                       * BD015370
*********************************************************************** BD015380
         SPACE 1                                                        BD015390
COND4    EQU   4                   COMPLETION CODE OF 4                 BD015400
COND8    EQU   8                   COMPLETION CODE OF 8                 BD015410
COND12   EQU   12                  COMPLETION CODE OF 12                BD015420
COND16   EQU   16                  COMPLETION CODE OF 16                BD015430
         SPACE 5                                                        BD015440
*********************************************************************** BD015450
*        EQUATES FOR MATHEMATICAL OPERATIONS                          * BD015460
*********************************************************************** BD015470
         SPACE 1                                                        BD015480
ADD      EQU   1                   INTERNAL REPRESENTATION OF ADD       BD015490
SUBTRACT EQU   2                   INTERNAL REPRESENTATION OFSUBTRACT   BD015500
MULTIPLY EQU   3                   INTERNAL REPRESENTATION OFMULTIPLY   BD015510
DIVIDE   EQU   4                   INTERNAL REPRESENTATION OFDIVIDE     BD015520
         EJECT 'PROCESS CONTROLLING FLAGS'                              BD015530
*********************************************************************** BD015540
*        CONTROL BLOCK FLAGS                                          * BD015550
*********************************************************************** BD015560
         SPACE 1                                                        BD015570
*        NOTE THAT THOSE CONTROL BLOCKS THAT ARE USED TO DEFINE TESTS   BD015580
*         SPECIFIED IN MS13 CONTROL CARDS HAVE AN IDENTIFYING FLAG      BD015590
*         IDENTICAL TO THE INTERNAL TEST REPRESENTATION TO WHICH THEY   BD015600
*         REFER IN ORDER TO SIMPLIFY CHAINING.                          BD015610
         SPACE 1                                                        BD015620
FLAGCB02 EQU   1                   CONTROL BLOCK CB02                   BD015630
FLAGCB03 EQU   2                   CONTROL BLOCK CB03                   BD015640
FLAGCB05 EQU   4                   CONTROL BLOCK CB05                   BD015650
FLAGCB11 EQU   3                   CONTROL BLOCK CB11                   BD015660
FLAGCB04 EQU   16                  CONTROL BLOCK CB04                   BD015670
FLAGSB11 EQU   32                  CONTROL BLOCK SB11                   BD015680
FLAGCB13 EQU   64                  CONTROL BLOCK CB13                   BD015690
FLAGCB14 EQU   5                   CONTROL BLOCK CB14                   BD015700
FLAGCB15 EQU   6                   CONTROL BLOCK CB15                   BD015710
FLAGCB16 EQU   7                   CONTROL BLOCK CB16                   BD015720
FLAGCB20 EQU   X'2E'               CONTROL BLOCK CB20                   BD015730
FLAGCB2R EQU   X'2F'               CONTROL BLOCK CB20 FOR RIGAM         BD015740
FLAGCB21 EQU   9                   CONTROL BLOCK CB21                   BD015750
FLAGCB22 EQU   10                  CONTROL BLOCK CB22                   BD015760
FLAGCB23 EQU   X'13'               CONTROL BLOCK CB23                   BD015770
FLAGCB24 EQU   11                  CONTROL BLOCK CB24                   BD015780
FLAGCB30 EQU   X'1C'               CONTROL BLOCK CB30                   BD015790
FLAGCB31 EQU   X'40'               CONTROL BLOCK CB31                   BD015800
FLAGCB32 EQU   X'08'               CONTROL BLOCK CB32                   BD015810
FLAGCB33 EQU   X'16'               CONTROL BLOCK CB33                   BD015820
FLAGCB34 EQU   X'14'               CONTROL BLOCK CB34                   BD015830
FLAGCB36 EQU   X'1A'               CONTROL BLOCK CB36                   BD015840
FLAGCB37 EQU   X'1B'               CONTROL BLOCK CB37                   BD015850
FLAGCB38 EQU   X'30'               CONTROL BLOCK CB38                   BD015860
FLAGCB40 EQU   X'4C'               CONTROL BLOCK CB40                   BD015870
FLAGCB41 EQU   12                  CONTROL BLOCK CB41                   BD015880
         MEND                                                           BD015890
