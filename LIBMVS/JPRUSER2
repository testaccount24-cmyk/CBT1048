000100 IDENTIFICATION  DIVISION.
000200
000300 PROGRAM-ID. 'JPRUSER2'.
000400
000500 REMARKS.    THIS SUB-PROGRAM WILL BE CALLED BY RPG THRU
000600             THE ASSEMBLER UTILITY UT473 IN ORDER TO
000700             PRODUCE MISD CANARY REPORT AND PLOTTING
000800             BASED ON PRINT MATRIX TABLE.
000900
001000 ENVIRONMENT DIVISION.
001100
001200 CONFIGURATION SECTION.
001300 SOURCE-COMPUTER. IBM-360.
001400 OBJECT-COMPUTER. IBM-360.
001500
001600 INPUT-OUTPUT SECTION.
001700 FILE-CONTROL.
001800
001900     SELECT  TABLE   ASSIGN TO 'FMATRIX' UTILITY.
002000     SELECT  REPOUT  ASSIGN  TO  'FT06F001'  UTILITY.
002100
002200 DATA DIVISION.
002300 FILE SECTION.
002400
002500 FD  TABLE
002600     RECORDING F
002700     BLOCK 0 RECORDS
002800     LABEL RECORDS STANDARD
002900     DATA RECORD TABLE-REC.
003000
003100 01  TABLE-REC.
003200     03  TABREC-ID               PICTURE  XX.
003300     03  TABREC-CTRL-A           PICTURE  X.
003400     03  TABREC-RPT-LINE         PICTURE  XXX.
003500     03  TABREC-NAME             PICTURE  X(21).
003600     03  TABREC-CTRL-B           PICTURE  X.
003700     03  TABREC-CUMUL            PICTURE  XX.
003800     03  TABREC-DATA             PICTURE  X(50).
003900
004000 FD  REPOUT
004100     RECORDING F
004200     BLOCK 0 RECORDS
004300     LABEL RECORDS STANDARD
004400     DATA RECORD PRINT-LINE.
004500
004600 01  PRINT-LINE.
004700     03  PRINT-LINE-SKIP         PICTURE  X.
004800     03  PRINT-LINE-DATA         PICTURE  X(132).
004900 WORKING-STORAGE SECTION.
005000
005001 77  COBOL-DATE                  PICTURE  X(9)
005002                                           VALUE  'COBOLDATE'.
005100 77  I                       PICTURE S9(4)     COMPUTATIONAL.
005200 77  J                       PICTURE S9(4)     COMPUTATIONAL.
005300 77  K                       PICTURE S9(4)     COMPUTATIONAL.
005400 77  L                       PICTURE S9(4)     COMPUTATIONAL.
005500 77  M                       PICTURE S9(4)     COMPUTATIONAL.
005600 77  N                       PICTURE S9(4)     COMPUTATIONAL.
005700 77  O                       PICTURE S9(4)     COMPUTATIONAL.
005800 77  Y-DIF                                     COMPUTATIONAL-1.
005900 77  Y-GAP                                     COMPUTATIONAL-1.
006000 77  TEST-PRT                PICTURE  X.
006100 77  DASH                    PICTURE  X(9)  VALUE '-------- '.
006200 77  CEQUAL                  PICTURE  X(9)  VALUE '======== '.
006300 77  CTR-LINE                PICTURE S99  COMPUTATIONAL-3
006400                                          VALUE ZERO.
006500 77  CTR-PAGE                PICTURE S9999  COMPUTATIONAL-3
006600                                          VALUE ZERO.
006700 77  CTR-A-01                PICTURE S9(7)    COMPUTATIONAL-3.
006800 77  CTR-A-02                PICTURE S9(7)    COMPUTATIONAL-3.
006900 77  CTR-A-03                PICTURE S9(7)    COMPUTATIONAL-3.
007000 77  CTR-A-04                PICTURE S9(7)    COMPUTATIONAL-3.
007100 77  CTR-A-05                PICTURE S9(7)    COMPUTATIONAL-3.
007200 77  CTR-A-06                PICTURE S9(7)    COMPUTATIONAL-3.
007300 77  CTR-A-07                PICTURE S9(7)    COMPUTATIONAL-3.
007400 77  CTR-A-08                PICTURE S9(7)    COMPUTATIONAL-3.
007500 77  CTR-A-09                PICTURE S9(7)    COMPUTATIONAL-3.
007600 77  CTR-A-10                PICTURE S9(7)    COMPUTATIONAL-3.
007700 77  CTR-A-11                PICTURE S9(7)    COMPUTATIONAL-3.
007800 77  CTR-A-12                PICTURE S9(7)    COMPUTATIONAL-3.
007900 77  CTR-B-01                PICTURE S9(7)    COMPUTATIONAL-3.
008000 77  CTR-B-02                PICTURE S9(7)    COMPUTATIONAL-3.
008100 77  CTR-B-03                PICTURE S9(7)    COMPUTATIONAL-3.
008200 77  CTR-B-04                PICTURE S9(7)    COMPUTATIONAL-3.
008300 77  CTR-B-05                PICTURE S9(7)    COMPUTATIONAL-3.
008400 77  CTR-B-06                PICTURE S9(7)    COMPUTATIONAL-3.
008500 77  CTR-B-07                PICTURE S9(7)    COMPUTATIONAL-3.
008600 77  CTR-B-08                PICTURE S9(7)    COMPUTATIONAL-3.
008700 77  CTR-B-09                PICTURE S9(7)    COMPUTATIONAL-3.
008800 77  CTR-B-10                PICTURE S9(7)    COMPUTATIONAL-3.
008900 77  CTR-B-11                PICTURE S9(7)    COMPUTATIONAL-3.
009000 77  CTR-B-12                PICTURE S9(7)    COMPUTATIONAL-3.
009100 77  CTR-D-01                PICTURE S9(9)    COMPUTATIONAL-3.
009200 77  CTR-D-02                PICTURE S9(9)    COMPUTATIONAL-3.
009300 77  CTR-D-03                PICTURE S9(9)    COMPUTATIONAL-3.
009400 77  CTR-D-04                PICTURE S9(9)    COMPUTATIONAL-3.
009500 77  CTR-D-05                PICTURE S9(9)    COMPUTATIONAL-3.
009600 77  CTR-D-06                PICTURE S9(9)    COMPUTATIONAL-3.
009700 77  CTR-D-07                PICTURE S9(9)    COMPUTATIONAL-3.
009800 77  CTR-D-08                PICTURE S9(9)    COMPUTATIONAL-3.
009900 77  CTR-D-09                PICTURE S9(9)    COMPUTATIONAL-3.
010000 77  CTR-D-10                PICTURE S9(9)    COMPUTATIONAL-3.
010100 77  CTR-D-11                PICTURE S9(9)    COMPUTATIONAL-3.
010200 77  CTR-D-12                PICTURE S9(9)    COMPUTATIONAL-3.
010300 77  DIV-XFACT                   PICTURE S9(4) COMPUTATIONAL-3.
010400 01  NE          PICTURE S9(5)   COMPUTATIONAL   VALUE  89.
010500 01  X-TAB.
010600         03  X       OCCURS  91  COMPUTATIONAL-1.
010700 01  Y-TAB.
010800         03  Y       OCCURS  91   COMPUTATIONAL-1.
010900 01  ITYPE       PICTURE  X.
011000 01  NEXX        PICTURE S9(5)   COMPUTATIONAL   VALUE  -1.
011100 01  KSCALE      PICTURE S9(5)   COMPUTATIONAL   VALUE  1.
011200 01  SCALES.
011300     03  SCALOS  OCCURS  6       COMPUTATIONAL-1.
011400 01  KAXIS       PICTURE S9(5)   COMPUTATIONAL   VALUE  0.
011500 01  AXISID      PICTURE  X(72)                  VALUE  SPACES.
011600 01  LINEX       PICTURE S9(5)   COMPUTATIONAL   VALUE  0.
011700 01  TEXT        PICTURE  X                      VALUE  SPACE.
011800 01  KPOS        PICTURE S9(5)   COMPUTATIONAL   VALUE  0.
011900 01  POS                         COMPUTATIONAL-1 VALUE +0.0E+1.
012000 01  CHARTI-SW                   PICTURE  X  VALUE  'N'.
012100 01  TABLE-PRINT.
012200
012300     03  FILLER      OCCURS  300.
012400         05  TABPRT-CTRL-A       PICTURE X.
012500         05  TABPRT-NAME.
012600             07  TABPRT-DESC     PICTURE  X(20).
012700             07  TABPRT-PLOT     PICTURE  X.
012800         05  TABPRT-CTRL-B       PICTURE X.
012900         05  TABPRT-CUMUL        PICTURE XX.
013000         05  TABPRT-DATA         PICTURE X(50).
013100 01  TABLE-PRT-IND   REDEFINES   TABLE-PRINT.
013200
013300     03  FILLER      OCCURS  300.
013400         05  FILLER              PICTURE  X(23).
013500         05  TABPRT-IND          PICTURE S99.
013600         05  FILLER              PICTURE  X(50).
013700
013800 01  TABLE-CUMUL.
013900
014000     03  FILLER      OCCURS  20.
014100         05  TABCUM-01           PICTURE S9(7)   COMPUTATIONAL-3.
014200         05  TABCUM-02           PICTURE S9(7)   COMPUTATIONAL-3.
014300         05  TABCUM-03           PICTURE S9(7)   COMPUTATIONAL-3.
014400         05  TABCUM-04           PICTURE S9(7)   COMPUTATIONAL-3.
014500         05  TABCUM-05           PICTURE S9(7)   COMPUTATIONAL-3.
014600         05  TABCUM-06           PICTURE S9(7)   COMPUTATIONAL-3.
014700         05  TABCUM-07           PICTURE S9(7)   COMPUTATIONAL-3.
014800         05  TABCUM-08           PICTURE S9(7)   COMPUTATIONAL-3.
014900         05  TABCUM-09           PICTURE S9(7)   COMPUTATIONAL-3.
015000         05  TABCUM-10           PICTURE S9(7)   COMPUTATIONAL-3.
015100         05  TABCUM-11           PICTURE S9(7)   COMPUTATIONAL-3.
015200         05  TABCUM-12           PICTURE S9(7)   COMPUTATIONAL-3.
015300
015400 01  TABLE-CHART.
015500
015600     03  FILLER      OCCURS  20.
015700         05  TABCHA-CD           PICTURE  X.
015800         05  TABCHA-01           PICTURE S9(7)   COMPUTATIONAL-3.
015900         05  TABCHA-02           PICTURE S9(7)   COMPUTATIONAL-3.
016000         05  TABCHA-03           PICTURE S9(7)   COMPUTATIONAL-3.
016100         05  TABCHA-04           PICTURE S9(7)   COMPUTATIONAL-3.
016200         05  TABCHA-05           PICTURE S9(7)   COMPUTATIONAL-3.
016300         05  TABCHA-06           PICTURE S9(7)   COMPUTATIONAL-3.
016400         05  TABCHA-07           PICTURE S9(7)   COMPUTATIONAL-3.
016500         05  TABCHA-08           PICTURE S9(7)   COMPUTATIONAL-3.
016600         05  TABCHA-09           PICTURE S9(7)   COMPUTATIONAL-3.
016700         05  TABCHA-10           PICTURE S9(7)   COMPUTATIONAL-3.
016800         05  TABCHA-11           PICTURE S9(7)   COMPUTATIONAL-3.
016900         05  TABCHA-12           PICTURE S9(7)   COMPUTATIONAL-3.
017000
017100 01  SUB-DATA                    PICTURE X(50).
017200 01  TAB-SUB-DATA    REDEFINES  SUB-DATA.
017300     03  FILLER      OCCURS 10.
017400         05  TAB-SUB-OP          PICTURE X.
017500         05  TAB-SUB-TAB         PICTURE X.
017600         05  TAB-SUB-IND         PICTURE 999.
017700
017800 01  PRT-TABLE.
017900     03  PRT-TABSKIP             PICTURE  X.
018000     03  PRT-TABREC              PICTURE  X(80).
018100     03  FILLER                  PICTURE  X(52)  VALUE SPACES.
018200
018300 01  REPORT-LINE.
018400     03  PRT-SKIP                PICTURE  X.
018500     03  PRT-LINE                PICTURE  X(132).
018600
018700     03  PRT-TITLE   REDEFINES   PRT-LINE.
018800         05  TITLE-NAME          PICTURE  X(132).
018900
019000     03  PRT-COL     REDEFINES   PRT-TITLE.
019100         05  FILLER              PICTURE  X(24).
019200         05  COL-01              PICTURE  X(9).
019300         05  COL-02              PICTURE  X(9).
019400         05  COL-03              PICTURE  X(9).
019500         05  COL-04              PICTURE  X(9).
019600         05  COL-05              PICTURE  X(9).
019700         05  COL-06              PICTURE  X(9).
019800         05  COL-07              PICTURE  X(9).
019900         05  COL-08              PICTURE  X(9).
020000         05  COL-09              PICTURE  X(9).
020100         05  COL-10              PICTURE  X(9).
020200         05  COL-11              PICTURE  X(9).
020300         05  COL-12              PICTURE  X(9).
020400
020500     03  PRT-CALCUL  REDEFINES   PRT-COL.
020600         05  CALPRT-NAME.
020700             07  CALPRT-DESC     PICTURE  X(20).
020800             07  FILLER          PICTURE  X.
020900             07  CALPRT-PLOT     PICTURE  X.
021000             07  FILLER          PICTURE  XX.
021100         05  CALPRT-01           PICTURE ZZZZ,ZZZ-   BLANK ZERO.
021200         05  CALPRT-02           PICTURE ZZZZ,ZZZ-   BLANK ZERO.
021300         05  CALPRT-03           PICTURE ZZZZ,ZZZ-   BLANK ZERO.
021400         05  CALPRT-04           PICTURE ZZZZ,ZZZ-   BLANK ZERO.
021500         05  CALPRT-05           PICTURE ZZZZ,ZZZ-   BLANK ZERO.
021600         05  CALPRT-06           PICTURE ZZZZ,ZZZ-   BLANK ZERO.
021700         05  CALPRT-07           PICTURE ZZZZ,ZZZ-   BLANK ZERO.
021800         05  CALPRT-08           PICTURE ZZZZ,ZZZ-   BLANK ZERO.
021900         05  CALPRT-09           PICTURE ZZZZ,ZZZ-   BLANK ZERO.
022000         05  CALPRT-10           PICTURE ZZZZ,ZZZ-   BLANK ZERO.
022100         05  CALPRT-11           PICTURE ZZZZ,ZZZ-   BLANK ZERO.
022200         05  CALPRT-12           PICTURE ZZZZ,ZZZ-   BLANK ZERO.
022300     03  PRT-CALCUL-1DEC  REDEFINES  PRT-CALCUL.
022400         05  FILLER              PICTURE  X(24).
022500         05  CALPRT-1D-01        PICTURE ZZZZZZ.9-   BLANK ZERO.
022600         05  CALPRT-1D-02        PICTURE ZZZZZZ.9-   BLANK ZERO.
022700         05  CALPRT-1D-03        PICTURE ZZZZZZ.9-   BLANK ZERO.
022800         05  CALPRT-1D-04        PICTURE ZZZZZZ.9-   BLANK ZERO.
022900         05  CALPRT-1D-05        PICTURE ZZZZZZ.9-   BLANK ZERO.
023000         05  CALPRT-1D-06        PICTURE ZZZZZZ.9-   BLANK ZERO.
023100         05  CALPRT-1D-07        PICTURE ZZZZZZ.9-   BLANK ZERO.
023200         05  CALPRT-1D-08        PICTURE ZZZZZZ.9-   BLANK ZERO.
023300         05  CALPRT-1D-09        PICTURE ZZZZZZ.9-   BLANK ZERO.
023400         05  CALPRT-1D-10        PICTURE ZZZZZZ.9-   BLANK ZERO.
023500         05  CALPRT-1D-11        PICTURE ZZZZZZ.9-   BLANK ZERO.
023600         05  CALPRT-1D-12        PICTURE ZZZZZZ.9-   BLANK ZERO.
023700 01  OF-LINE-1.
023800     03  SKIP-OF-1               PICTURE  X      VALUE '1'.
023900     03  FILLER                  PICTURE  X(11)  VALUE
024000                 'REPORT NO: '.
024100     03  PRT-REP-CODE            PICTURE  XXX.
024200     03  FILLER                  PICTURE  X      VALUE '-'.
024300     03  PRT-MTH-YTD             PICTURE  X.
024400     03  FILLER                  PICTURE  X      VALUE SPACES.
024500     03  PRT-REP-TYPE            PICTURE  X(12).
024600     03  FILLER                  PICTURE  X(15)  VALUE SPACES.
024700     03  PRT-USER-DESC           PICTURE  X(40)  VALUE
024800         'M.I.S.D.  C A N A R Y  R E P O R T      '.
024900     03  FILLER                  PICTURE  X(21)  VALUE SPACES.
024901     03  FILLER                  PICTURE  X(6)   VALUE 'DATE: '.
024902     03  PRT-RUN-DATE            PICTURE  X(9).
024903     03  FILLER                  PICTURE  X(3)   VALUE SPACES.
025000     03  FILLER                  PICTURE  X(5)   VALUE 'PAGE '.
025100     03  PRT-PAGE                PICTURE  ZZZZ.
025200
025300 01  OF-LINE-1-CTRL  REDEFINES  OF-LINE-1    PICTURE  X(133).
025400
025500 01  OF-LINE-2.
025600     03  SKIP-OF-2               PICTURE  X      VALUE '0'.
025700     03  PRT-LINE-NAME           PICTURE  X(132).
025800 01  OF-LINE-2-CTRL  REDEFINES  OF-LINE-2    PICTURE  X(133).
025900
026000 01  OF-LINE-3.
026100     03  SKIP-OF-3               PICTURE  X  VALUE '0'.
026200     03  FILLER                  PICTURE  X(19)  VALUE SPACES.
026300     03  FILLER                  PICTURE  X(5)   VALUE 'PLOT '.
026400     03  OF-L2-01                PICTURE  X(9).
026500     03  OF-L2-02                PICTURE  X(9).
026600     03  OF-L2-03                PICTURE  X(9).
026700     03  OF-L2-04                PICTURE  X(9).
026800     03  OF-L2-05                PICTURE  X(9).
026900     03  OF-L2-06                PICTURE  X(9).
027000     03  OF-L2-07                PICTURE  X(9).
027100     03  OF-L2-08                PICTURE  X(9).
027200     03  OF-L2-09                PICTURE  X(9).
027300     03  OF-L2-10                PICTURE  X(9).
027400     03  OF-L2-11                PICTURE  X(9).
027500     03  OF-L2-12                PICTURE  X(9).
027600 01  OF-LINE-3-CTRL  REDEFINES  OF-LINE-3    PICTURE  X(133).
027700
027800 01  OF-LINE-4.
027900     03  SKIP-OF-4               PICTURE  X  VALUE ' '.
028000     03  FILLER                  PICTURE  X(19)    VALUE SPACES.
028100     03  FILLER                  PICTURE  X(5)   VALUE 'CAR. '.
028200     03  FILLER                  PICTURE  X(9) VALUE '-------- '.
028300     03  FILLER                  PICTURE  X(9) VALUE '-------- '.
028400     03  FILLER                  PICTURE  X(9) VALUE '-------- '.
028500     03  FILLER                  PICTURE  X(9) VALUE '-------- '.
028600     03  FILLER                  PICTURE  X(9) VALUE '-------- '.
028700     03  FILLER                  PICTURE  X(9) VALUE '-------- '.
028800     03  FILLER                  PICTURE  X(9) VALUE '-------- '.
028900     03  FILLER                  PICTURE  X(9) VALUE '-------- '.
029000     03  FILLER                  PICTURE  X(9) VALUE '-------- '.
029100     03  FILLER                  PICTURE  X(9) VALUE '-------- '.
029200     03  FILLER                  PICTURE  X(9) VALUE '-------- '.
029300     03  FILLER                  PICTURE  X(9) VALUE '-------- '.
029400 01  OF-LINE-4-CTRL  REDEFINES  OF-LINE-4    PICTURE  X(133).
029500
029600 01  CHARTP-LINE-MTH.
029700     03  SKIP-CHARTP-MTH         PICTURE  X      VALUE ' '.
029800     03  FILLER                  PICTURE  X(14)  VALUE SPACES.
029900     03  CHARTP-NAME-MTH.
030000         05  FILLER          PICTURE  X(8)  VALUE  'J       '.
030100         05  FILLER          PICTURE  X(8)  VALUE  'F       '.
030200         05  FILLER          PICTURE  X(8)  VALUE  'M       '.
030300         05  FILLER          PICTURE  X(8)  VALUE  'A       '.
030400         05  FILLER          PICTURE  X(8)  VALUE  'M       '.
030500         05  FILLER          PICTURE  X(8)  VALUE  'J       '.
030600         05  FILLER          PICTURE  X(8)  VALUE  'J       '.
030700         05  FILLER          PICTURE  X(8)  VALUE  'A       '.
030800         05  FILLER          PICTURE  X(8)  VALUE  'S       '.
030900         05  FILLER          PICTURE  X(8)  VALUE  'O       '.
031000         05  FILLER          PICTURE  X(8)  VALUE  'N       '.
031100         05  FILLER          PICTURE  X(1)  VALUE  'D'.
031200     03  FILLER                  PICTURE  X(29)  VALUE SPACES.
031300 01  CHARTP-MTH-CTRL REDEFINES CHARTP-LINE--MTH  PICTURE  X(133).
031400
031500 01  DUMMY-CTR.
031600     03  CTR-00-DECIMALS.
031700             05  R-01        PICTURE  S9(7)    COMPUTATIONAL-3.
031800             05  R-02        PICTURE  S9(7)    COMPUTATIONAL-3.
031900             05  R-03        PICTURE  S9(7)    COMPUTATIONAL-3.
032000             05  R-04        PICTURE  S9(7)    COMPUTATIONAL-3.
032100             05  R-05        PICTURE  S9(7)    COMPUTATIONAL-3.
032200             05  R-06        PICTURE  S9(7)    COMPUTATIONAL-3.
032300             05  R-07        PICTURE  S9(7)    COMPUTATIONAL-3.
032400             05  R-08        PICTURE  S9(7)    COMPUTATIONAL-3.
032500             05  R-09        PICTURE  S9(7)    COMPUTATIONAL-3.
032600             05  R-10        PICTURE  S9(7)    COMPUTATIONAL-3.
032700             05  R-11        PICTURE  S9(7)    COMPUTATIONAL-3.
032800             05  R-12        PICTURE  S9(7)    COMPUTATIONAL-3.
032900     03  CTR-01-DECIMALS   REDEFINES  CTR-00-DECIMALS.
033000             05  R-1D-01     PICTURE  S9(6)V9  COMPUTATIONAL-3.
033100             05  R-1D-02     PICTURE  S9(6)V9  COMPUTATIONAL-3.
033200             05  R-1D-03     PICTURE  S9(6)V9  COMPUTATIONAL-3.
033300             05  R-1D-04     PICTURE  S9(6)V9  COMPUTATIONAL-3.
033400             05  R-1D-05     PICTURE  S9(6)V9  COMPUTATIONAL-3.
033500             05  R-1D-06     PICTURE  S9(6)V9  COMPUTATIONAL-3.
033600             05  R-1D-07     PICTURE  S9(6)V9  COMPUTATIONAL-3.
033700             05  R-1D-08     PICTURE  S9(6)V9  COMPUTATIONAL-3.
033800             05  R-1D-09     PICTURE  S9(6)V9  COMPUTATIONAL-3.
033900             05  R-1D-10     PICTURE  S9(6)V9  COMPUTATIONAL-3.
034000             05  R-1D-11     PICTURE  S9(6)V9  COMPUTATIONAL-3.
034100             05  R-1D-12     PICTURE  S9(6)V9  COMPUTATIONAL-3.
034200
034300 01  DUMMY-TITLE.
034400
034500     03  PRT-REP-MTH             PICTURE  X(12)  VALUE
034600        '(MTH BY MTH)'.
034700     03  PRT-REP-YTD             PICTURE  X(12)  VALUE
034800        '(YTD BY MTH)'.
034900     03  REP-TIT-SAVE            PICTURE  X(8).
035000
035100 LINKAGE SECTION.
035200 01  LINK-TABLE.
035300
035400     03  FILLER      OCCURS 1.
035500         05  TABDET-01           PICTURE S9(7)   COMPUTATIONAL-3.
035600         05  TABDET-02           PICTURE S9(7)   COMPUTATIONAL-3.
035700         05  TABDET-03           PICTURE S9(7)   COMPUTATIONAL-3.
035800         05  TABDET-04           PICTURE S9(7)   COMPUTATIONAL-3.
035900         05  TABDET-05           PICTURE S9(7)   COMPUTATIONAL-3.
036000         05  TABDET-06           PICTURE S9(7)   COMPUTATIONAL-3.
036100         05  TABDET-07           PICTURE S9(7)   COMPUTATIONAL-3.
036200         05  TABDET-08           PICTURE S9(7)   COMPUTATIONAL-3.
036300         05  TABDET-09           PICTURE S9(7)   COMPUTATIONAL-3.
036400         05  TABDET-10           PICTURE S9(7)   COMPUTATIONAL-3.
036500         05  TABDET-11           PICTURE S9(7)   COMPUTATIONAL-3.
036600         05  TABDET-12           PICTURE S9(7)   COMPUTATIONAL-3.
036700 01  LINK-PART1.
036800     03  FILLER  OCCURS 1000.
036900         05  FILLER              PICTURE S9(7)   COMPUTATIONAL-3.
037000 01  LINK-PART2.
037100     03  FILLER  OCCURS 1000.
037200         05  FILLER              PICTURE S9(7)   COMPUTATIONAL-3.
037300 01  LINK-PART3.
037400     03  FILLER  OCCURS 1000.
037500         05  FILLER              PICTURE S9(7)   COMPUTATIONAL-3.
037600 01  LINK-PART4.
037700     03  FILLER  OCCURS 60.
037800         05  FILLER              PICTURE S9(7)   COMPUTATIONAL-3.
037900
038000 01  LINK-DATA.
038100
038200     03  POINTER-TITLE           PICTURE  X.
038300     03  OPCODE                  PICTURE  X.
038400     03  CHART-PRT-REQ           PICTURE  X.
038500     03  RETURN-CODE             PICTURE  X.
038600     03  REP-NUMBER              PICTURE  XXX.
038700     03  REP-MTH-YTD             PICTURE  X.
038800     03  REP-DEC-TOT             PICTURE  X.
038900     03  REP-NBR-YTD             PICTURE  99     COMPUTATIONAL-3.
039000     03  REP-USER-DESC           PICTURE  X(40).
039100     03  REP-DECIMALS            PICTURE  X.
039200     03  REP-TITLE-COLUMNS.
039300         05  REP-TIT-01          PICTURE  X(8).
039400         05  REP-TIT-02          PICTURE  X(8).
039500         05  REP-TIT-03          PICTURE  X(8).
039600         05  REP-TIT-04          PICTURE  X(8).
039700         05  REP-TIT-05          PICTURE  X(8).
039800         05  REP-TIT-06          PICTURE  X(8).
039900         05  REP-TIT-07          PICTURE  X(8).
040000         05  REP-TIT-08          PICTURE  X(8).
040100         05  REP-TIT-09          PICTURE  X(8).
040200         05  REP-TIT-10          PICTURE  X(8).
040300         05  REP-TIT-11          PICTURE  X(8).
040400         05  REP-TIT-12          PICTURE  X(8).
040500     03  REP-TITLE               PICTURE  X(132).
040600
040700 PROCEDURE DIVISION.
040800
040900     ENTER  LINKAGE.
041000     ENTRY 'JPUSER2A' USING  LINK-TABLE  LINK-DATA.
041100     ENTER COBOL.
041200
041300     MOVE  '1'  TO  RETURN-CODE.
041400
041500     IF  OPCODE  =  '2'  GO TO   TREATMENT-ROUTINE.
041600
041700     IF  OPCODE  =  '1'  GO TO   OPEN-ROUTINE.
041800
041900     IF  OPCODE  =  '3'  GO TO   CLOSE-ROUTINE.
042000
042100     MOVE  '2'  TO  RETURN-CODE.
042200
042300 END-OF-TASK.
042400
042500     ENTER LINKAGE.
042600     RETURN.
042700     ENTER COBOL.
042800
042900 OPEN-ROUTINE.
043000
043001     ENTER  LINKAGE.
043002     CALL  'DTERTN'  USING  COBOL-DATE.
043003     ENTER  COBOL.
043004
043005     MOVE  COBOL-DATE  TO  PRT-RUN-DATE.
043006
043100     OPEN  INPUT  TABLE.
043200     OPEN OUTPUT REPOUT.
043300
043400     MOVE  '5'  TO  RETURN-CODE.
043500     MOVE  0  TO  I.
043600     PERFORM OVERFLOW-ROUTINE.
043700
043800 READ-TABLE.
043900
044000     READ  TABLE  AT END  GO TO  END-OPEN-ROUTINE.
044100
044200     MOVE  TABLE-REC  TO  PRT-TABREC.
044300     WRITE  PRINT-LINE  FROM  PRT-TABLE  AFTER  PRT-TABSKIP.
044400
044500     IF  TABREC-CTRL-A  IS EQUAL TO  'N'
044600       GO TO  READ-TABLE.
044700
044800
044900     ADD  1  TO  I.
045000     IF  I  >  300  MOVE '6' TO RETURN-CODE
045100         GO TO  END-OPEN-ROUTINE.
045200     MOVE  TABREC-CTRL-A  TO  TABPRT-CTRL-A (I).
045300     MOVE  TABREC-NAME    TO  TABPRT-NAME   (I).
045400     MOVE  TABREC-CTRL-B  TO  TABPRT-CTRL-B (I).
045500     MOVE  TABREC-CUMUL   TO  TABPRT-CUMUL  (I).
045600     MOVE  TABREC-DATA    TO  TABPRT-DATA   (I).
045700     MOVE  '1'  TO  RETURN-CODE.
045800
045900     GO TO  READ-TABLE.
046000
046100 END-OPEN-ROUTINE.
046200
046300     ADD  1  TO  I.
046400     MOVE  '*'  TO  TABPRT-CTRL-A (I).
046500
046600     CLOSE  TABLE.
046700
046800     GO TO  END-OF-TASK.
046900
047000 CLOSE-ROUTINE.
047100
047200     CLOSE  REPOUT.
047300
047400     GO TO  END-OF-TASK.
047500
047600 TREATMENT-ROUTINE.
047700
047800     PERFORM  ZEROISE-TABCUM.
047900     PERFORM  ZEROISE-TABCHA.
048000
048100     IF  REP-TITLE-COLUMNS IS EQUAL TO  SPACES
048200         MOVE  '  JAN.  '  TO  REP-TIT-01
048300         MOVE  '  FEB.  '  TO  REP-TIT-02
048400         MOVE  '  MAR.  '  TO  REP-TIT-03
048500         MOVE  '  APR.  '  TO  REP-TIT-04
048600         MOVE  '  MAY.  '  TO  REP-TIT-05
048700         MOVE  '  JUN.  '  TO  REP-TIT-06
048800         MOVE  '  JUL.  '  TO  REP-TIT-07
048900         MOVE  '  AUG.  '  TO  REP-TIT-08
049000         MOVE  '  SEP.  '  TO  REP-TIT-09
049100         MOVE  '  OCT.  '  TO  REP-TIT-10
049200         MOVE  '  NOV.  '  TO  REP-TIT-11
049300         MOVE  '  DEC.  '  TO  REP-TIT-12.
049400     MOVE  REP-TIT-12  TO  REP-TIT-SAVE.
049500
049600     IF  REP-MTH-YTD  =  'M'  PERFORM  ACCUM-DEC
049700         ELSE  PERFORM  ACCUM-MONTH.
049800
049900     PERFORM  OVERFLOW-ROUTINE  THRU  OVERFLOW-ROUTINE-END.
050000
050100     MOVE  SPACES  TO  REPORT-LINE.
050200     MOVE  0  TO  J.
050300
050400 READ-TABPRT.
050500
050600     ADD  1  TO  J   MOVE  'Y'  TO  TEST-PRT.
050700     MOVE  SPACES  TO  PRT-LINE.
050800
050900     IF  TABPRT-CTRL-A (J)  =  '*'
051000         PERFORM  CHARTP-SECTION.
051100
051200     IF  TABPRT-CTRL-A (J)  IS  EQUAL  TO  '*'
051300         MOVE  REP-TIT-SAVE  TO  REP-TIT-12
051400         GO TO  END-OF-TASK.
051500
051600     IF  TABPRT-CTRL-A (J) IS EQUAL TO 'C'
051700         PERFORM  CALCUL-LINE.
051800     IF  TABPRT-CTRL-A (J) IS EQUAL TO 'T'
051900         PERFORM  TITLE-LINE.
052000     IF  TABPRT-CTRL-A (J) IS EQUAL TO 'D'
052100         PERFORM  DASH-LINE.
052200     IF  TABPRT-CTRL-A (J) IS EQUAL TO 'E'
052300         PERFORM  EQUAL-LINE.
052400     IF  TABPRT-CTRL-A (J) IS EQUAL TO 'B'
052500         PERFORM  BLANK-LINE.
052600     IF  TABPRT-CTRL-A (J)  IS EQUAL TO  'S'
052700         PERFORM  OVERFLOW-ROUTINE  THRU  OVERFLOW-ROUTINE-END.
052800
052900     IF  TABPRT-CTRL-B (J)  IS EQUAL TO  'C'
053000         MOVE  'N'  TO  TEST-PRT.
053100
053200     IF  TEST-PRT  IS EQUAL TO  'Y'
053300         PERFORM  PRINT-LINE-PRO.
053400
053500     GO TO  READ-TABPRT.
053600
053700 OVERFLOW-ROUTINE.
053800
053900     MOVE  REP-NUMBER TO  PRT-REP-CODE.
054000     MOVE  REP-MTH-YTD  TO  PRT-MTH-YTD.
054100     IF  REP-USER-DESC  IS NOT EQUAL TO  SPACES
054200         MOVE  REP-USER-DESC  TO  PRT-USER-DESC.
054300     ADD  1  TO  CTR-PAGE.
054400     MOVE  CTR-PAGE  TO  PRT-PAGE.
054500     WRITE  PRINT-LINE  FROM  OF-LINE-1  AFTER   SKIP-OF-1.
054600     MOVE   REP-TITLE  TO  PRT-LINE-NAME
054700     WRITE  PRINT-LINE  FROM  OF-LINE-2  AFTER   SKIP-OF-2.
054800
054900 OVERFLOW-ROUTINE-PART-2.
055000
055100     MOVE  REP-TIT-01  TO  OF-L2-01.
055200     MOVE  REP-TIT-02  TO  OF-L2-02.
055300     MOVE  REP-TIT-03  TO  OF-L2-03.
055400     MOVE  REP-TIT-04  TO  OF-L2-04.
055500     MOVE  REP-TIT-05  TO  OF-L2-05.
055600     MOVE  REP-TIT-06  TO  OF-L2-06.
055700     MOVE  REP-TIT-07  TO  OF-L2-07.
055800     MOVE  REP-TIT-08  TO  OF-L2-08.
055900     MOVE  REP-TIT-09  TO  OF-L2-09.
056000     MOVE  REP-TIT-10  TO  OF-L2-10.
056100     MOVE  REP-TIT-11  TO  OF-L2-11.
056200     MOVE  REP-TIT-12  TO  OF-L2-12.
056300     WRITE  PRINT-LINE  FROM  OF-LINE-3  AFTER   SKIP-OF-3.
056400     WRITE  PRINT-LINE  FROM  OF-LINE-4  AFTER   SKIP-OF-4.
056500     MOVE  SPACES  TO  PRINT-LINE.
056600     WRITE  PRINT-LINE  AFTER  PRINT-LINE-SKIP.
056700
056800     MOVE  0  TO  CTR-LINE.
056900
057000 OVERFLOW-ROUTINE-END.
057100
057200 PRINT-LINE-PRO.
057300
057400     IF  CTR-LINE  >  52
057500         PERFORM  OVERFLOW-ROUTINE  THRU  OVERFLOW-ROUTINE-END.
057600
057700     WRITE  PRINT-LINE  FROM  REPORT-LINE  AFTER  PRT-SKIP.
057800
057900     MOVE  SPACES  TO  REPORT-LINE.
058000
058100     ADD  1  TO  CTR-LINE.
058200
058300 TITLE-LINE.
058400
058500     MOVE  ' '   TO  PRT-SKIP.
058600     MOVE  TABPRT-NAME (J)  TO  TITLE-NAME.
058700
058800 DASH-LINE.
058900
059000     MOVE  ' '   TO  PRT-SKIP.
059100     MOVE  DASH  TO  COL-01.
059200     MOVE  DASH  TO  COL-02.
059300     MOVE  DASH  TO  COL-03.
059400     MOVE  DASH  TO  COL-04.
059500     MOVE  DASH  TO  COL-05.
059600     MOVE  DASH  TO  COL-06.
059700     MOVE  DASH  TO  COL-07.
059800     MOVE  DASH  TO  COL-08.
059900     MOVE  DASH  TO  COL-09.
060000     MOVE  DASH  TO  COL-10.
060100     MOVE  DASH  TO  COL-11.
060200     MOVE  DASH  TO  COL-12.
060300
060400 EQUAL-LINE.
060500
060600     MOVE  ' '   TO  PRT-SKIP.
060700     MOVE CEQUAL TO  COL-01.
060800     MOVE CEQUAL TO  COL-02.
060900     MOVE CEQUAL TO  COL-03.
061000     MOVE CEQUAL TO  COL-04.
061100     MOVE CEQUAL TO  COL-05.
061200     MOVE CEQUAL TO  COL-06.
061300     MOVE CEQUAL TO  COL-07.
061400     MOVE CEQUAL TO  COL-08.
061500     MOVE CEQUAL TO  COL-09.
061600     MOVE CEQUAL TO  COL-10.
061700     MOVE CEQUAL TO  COL-11.
061800     MOVE CEQUAL TO  COL-12.
061900
062000 BLANK-LINE.
062100
062200     MOVE  ' '   TO  PRT-SKIP.
062300
062400     MOVE  SPACES  TO  PRT-LINE.
062500
062600 CALCUL-LINE  SECTION.
062700
062800     MOVE  ZERO  TO  R-01.
062900     MOVE  ZERO  TO  R-02.
063000     MOVE  ZERO  TO  R-03.
063100     MOVE  ZERO  TO  R-04.
063200     MOVE  ZERO  TO  R-05.
063300     MOVE  ZERO  TO  R-06.
063400     MOVE  ZERO  TO  R-07.
063500     MOVE  ZERO  TO  R-08.
063600     MOVE  ZERO  TO  R-09.
063700     MOVE  ZERO  TO  R-10.
063800     MOVE  ZERO  TO  R-11.
063900     MOVE  ZERO  TO  R-12.
064000
064100     MOVE  TABPRT-DATA (J)  TO  SUB-DATA.
064200     EXAMINE  SUB-DATA  REPLACING  ALL  ' ' BY '0'.
064300
064400     IF  TABPRT-CUMUL (J)  IS EQUAL TO  'DV'
064500       OR  TABPRT-CUMUL (J)  IS EQUAL TO  'PC'
064600         PERFORM  CALCUL-DIVIDE
064700     ELSE  PERFORM  CALCUL-INDEX.
064800
064900     IF  REP-NBR-YTD  <   2  MOVE  ZERO  TO  R-02.
065000     IF  REP-NBR-YTD  <   3  MOVE  ZERO  TO  R-03.
065100     IF  REP-NBR-YTD  <   4  MOVE  ZERO  TO  R-04.
065200     IF  REP-NBR-YTD  <   5  MOVE  ZERO  TO  R-05.
065300     IF  REP-NBR-YTD  <   6  MOVE  ZERO  TO  R-06.
065400     IF  REP-NBR-YTD  <   7  MOVE  ZERO  TO  R-07.
065500     IF  REP-NBR-YTD  <   8  MOVE  ZERO  TO  R-08.
065600     IF  REP-NBR-YTD  <   9  MOVE  ZERO  TO  R-09.
065700     IF  REP-NBR-YTD  <  10  MOVE  ZERO  TO  R-10.
065800     IF  REP-NBR-YTD  <  11  MOVE  ZERO  TO  R-11.
065900     IF  REP-NBR-YTD  <  12
066000         AND REP-DEC-TOT  IS NOT EQUAL TO  'Y'
066100         MOVE  ZERO  TO  R-12.
066200
066300     IF  TABPRT-PLOT (J)  IS NOT EQUAL TO  ' '
066400         PERFORM  CHART-STORE-SECTION.
066500
066600
066700     IF  TABPRT-CTRL-B (J)  IS EQUAL TO  'B'
066800        AND  R-01   IS EQUAL TO  ZERO
066900        AND  R-02   IS EQUAL TO  ZERO
067000        AND  R-03   IS EQUAL TO  ZERO
067100        AND  R-04   IS EQUAL TO  ZERO
067200        AND  R-05   IS EQUAL TO  ZERO
067300        AND  R-06   IS EQUAL TO  ZERO
067400        AND  R-07   IS EQUAL TO  ZERO
067500        AND  R-08   IS EQUAL TO  ZERO
067600        AND  R-09   IS EQUAL TO  ZERO
067700        AND  R-10   IS EQUAL TO  ZERO
067800        AND  R-11   IS EQUAL TO  ZERO
067900        AND  R-12   IS EQUAL TO  ZERO
068000        MOVE  'N'  TO  TEST-PRT.
068100
068200     MOVE  TABPRT-DESC (J)  TO  CALPRT-DESC.
068300     MOVE  TABPRT-PLOT (J)  TO  CALPRT-PLOT.
068400     IF  TABPRT-CUMUL (J)  =  'DV'
068500       OR  TABPRT-CUMUL (J)  IS EQUAL TO  'PC'
068600     OR   REP-DECIMALS  =  '1'
068700             MOVE  R-1D-01  TO  CALPRT-1D-01
068800             MOVE  R-1D-02  TO  CALPRT-1D-02
068900             MOVE  R-1D-03  TO  CALPRT-1D-03
069000             MOVE  R-1D-04  TO  CALPRT-1D-04
069100             MOVE  R-1D-05  TO  CALPRT-1D-05
069200             MOVE  R-1D-06  TO  CALPRT-1D-06
069300             MOVE  R-1D-07  TO  CALPRT-1D-07
069400             MOVE  R-1D-08  TO  CALPRT-1D-08
069500             MOVE  R-1D-09  TO  CALPRT-1D-09
069600             MOVE  R-1D-10  TO  CALPRT-1D-10
069700             MOVE  R-1D-11  TO  CALPRT-1D-11
069800             MOVE  R-1D-12  TO  CALPRT-1D-12
069900       ELSE  MOVE  R-01  TO  CALPRT-01
070000             MOVE  R-02  TO  CALPRT-02
070100             MOVE  R-03  TO  CALPRT-03
070200             MOVE  R-04  TO  CALPRT-04
070300             MOVE  R-05  TO  CALPRT-05
070400             MOVE  R-06  TO  CALPRT-06
070500             MOVE  R-07  TO  CALPRT-07
070600             MOVE  R-08  TO  CALPRT-08
070700             MOVE  R-09  TO  CALPRT-09
070800             MOVE  R-10  TO  CALPRT-10
070900             MOVE  R-11  TO  CALPRT-11
071000             MOVE  R-12  TO  CALPRT-12.
071100     MOVE  ' '  TO  PRT-SKIP.
071200
071300 CALCUL-LINE-EXIT.  EXIT.
071400
071500 CALCUL-DIVIDE  SECTION.
071600
071700     MOVE  TAB-SUB-IND (1)  TO  K.
071800     MOVE  TAB-SUB-IND (2)  TO  L.
071900
072000     IF TAB-SUB-TAB (1) =  'D'
072100             MOVE  TABDET-01 (K)  TO  CTR-A-01
072200             MOVE  TABDET-02 (K)  TO  CTR-A-02
072300             MOVE  TABDET-03 (K)  TO  CTR-A-03
072400             MOVE  TABDET-04 (K)  TO  CTR-A-04
072500             MOVE  TABDET-05 (K)  TO  CTR-A-05
072600             MOVE  TABDET-06 (K)  TO  CTR-A-06
072700             MOVE  TABDET-07 (K)  TO  CTR-A-07
072800             MOVE  TABDET-08 (K)  TO  CTR-A-08
072900             MOVE  TABDET-09 (K)  TO  CTR-A-09
073000             MOVE  TABDET-10 (K)  TO  CTR-A-10
073100             MOVE  TABDET-11 (K)  TO  CTR-A-11
073200             MOVE  TABDET-12 (K)  TO  CTR-A-12
073300     ELSE    MOVE  TABCUM-01 (K)  TO  CTR-A-01
073400             MOVE  TABCUM-02 (K)  TO  CTR-A-02
073500             MOVE  TABCUM-03 (K)  TO  CTR-A-03
073600             MOVE  TABCUM-04 (K)  TO  CTR-A-04
073700             MOVE  TABCUM-05 (K)  TO  CTR-A-05
073800             MOVE  TABCUM-06 (K)  TO  CTR-A-06
073900             MOVE  TABCUM-07 (K)  TO  CTR-A-07
074000             MOVE  TABCUM-08 (K)  TO  CTR-A-08
074100             MOVE  TABCUM-09 (K)  TO  CTR-A-09
074200             MOVE  TABCUM-10 (K)  TO  CTR-A-10
074300             MOVE  TABCUM-11 (K)  TO  CTR-A-11
074400             MOVE  TABCUM-12 (K)  TO  CTR-A-12.
074500
074600     IF TAB-SUB-TAB (2) =  'D'
074700             MOVE  TABDET-01 (L)  TO  CTR-B-01
074800             MOVE  TABDET-02 (L)  TO  CTR-B-02
074900             MOVE  TABDET-03 (L)  TO  CTR-B-03
075000             MOVE  TABDET-04 (L)  TO  CTR-B-04
075100             MOVE  TABDET-05 (L)  TO  CTR-B-05
075200             MOVE  TABDET-06 (L)  TO  CTR-B-06
075300             MOVE  TABDET-07 (L)  TO  CTR-B-07
075400             MOVE  TABDET-08 (L)  TO  CTR-B-08
075500             MOVE  TABDET-09 (L)  TO  CTR-B-09
075600             MOVE  TABDET-10 (L)  TO  CTR-B-10
075700             MOVE  TABDET-11 (L)  TO  CTR-B-11
075800             MOVE  TABDET-12 (L)  TO  CTR-B-12
075900     ELSE    MOVE  TABCUM-01 (L)  TO  CTR-B-01
076000             MOVE  TABCUM-02 (L)  TO  CTR-B-02
076100             MOVE  TABCUM-03 (L)  TO  CTR-B-03
076200             MOVE  TABCUM-04 (L)  TO  CTR-B-04
076300             MOVE  TABCUM-05 (L)  TO  CTR-B-05
076400             MOVE  TABCUM-06 (L)  TO  CTR-B-06
076500             MOVE  TABCUM-07 (L)  TO  CTR-B-07
076600             MOVE  TABCUM-08 (L)  TO  CTR-B-08
076700             MOVE  TABCUM-09 (L)  TO  CTR-B-09
076800             MOVE  TABCUM-10 (L)  TO  CTR-B-10
076900             MOVE  TABCUM-11 (L)  TO  CTR-B-11
077000             MOVE  TABCUM-12 (L)  TO  CTR-B-12.
077100
077200     MOVE  1  TO  DIV-XFACT.
077300     IF  TABPRT-CUMUL (J)  IS EQUAL TO  'PC'
077400         MOVE  100  TO  DIV-XFACT.
077500     IF  CTR-B-01  IS NOT EQUAL TO  ZERO
077600     MULTIPLY  DIV-XFACT  BY  CTR-A-01  GIVING  CTR-D-01
077700     DIVIDE CTR-B-01 INTO CTR-D-01 GIVING  R-1D-01  ROUNDED.
077800     IF  CTR-B-02  IS NOT EQUAL TO  ZERO
077900     MULTIPLY  DIV-XFACT  BY  CTR-A-02  GIVING  CTR-D-02
078000     DIVIDE CTR-B-02 INTO CTR-D-02 GIVING  R-1D-02  ROUNDED.
078100     IF  CTR-B-03  IS NOT EQUAL TO  ZERO
078200     MULTIPLY  DIV-XFACT  BY  CTR-A-03  GIVING  CTR-D-03
078300     DIVIDE CTR-B-03 INTO CTR-D-03 GIVING  R-1D-03  ROUNDED.
078400     IF  CTR-B-04  IS NOT EQUAL TO  ZERO
078500     MULTIPLY  DIV-XFACT  BY  CTR-A-04  GIVING  CTR-D-04
078600     DIVIDE CTR-B-04 INTO CTR-D-04 GIVING  R-1D-04  ROUNDED.
078700     IF  CTR-B-05  IS NOT EQUAL TO  ZERO
078800     MULTIPLY  DIV-XFACT  BY  CTR-A-05  GIVING  CTR-D-05
078900     DIVIDE CTR-B-05 INTO CTR-D-05 GIVING  R-1D-05  ROUNDED.
079000     IF  CTR-B-06  IS NOT EQUAL TO  ZERO
079100     MULTIPLY  DIV-XFACT  BY  CTR-A-06  GIVING  CTR-D-06
079200     DIVIDE CTR-B-06 INTO CTR-D-06 GIVING  R-1D-06  ROUNDED.
079300     IF  CTR-B-07  IS NOT EQUAL TO  ZERO
079400     MULTIPLY  DIV-XFACT  BY  CTR-A-07  GIVING  CTR-D-07
079500     DIVIDE CTR-B-07 INTO CTR-D-07 GIVING  R-1D-07  ROUNDED.
079600     IF  CTR-B-08  IS NOT EQUAL TO  ZERO
079700     MULTIPLY  DIV-XFACT  BY  CTR-A-08  GIVING  CTR-D-08
079800     DIVIDE CTR-B-08 INTO CTR-D-08 GIVING  R-1D-08  ROUNDED.
079900     IF  CTR-B-09  IS NOT EQUAL TO  ZERO
080000     MULTIPLY  DIV-XFACT  BY  CTR-A-09  GIVING  CTR-D-09
080100     DIVIDE CTR-B-09 INTO CTR-D-09 GIVING  R-1D-09  ROUNDED.
080200     IF  CTR-B-10  IS NOT EQUAL TO  ZERO
080300     MULTIPLY  DIV-XFACT  BY  CTR-A-10  GIVING  CTR-D-10
080400     DIVIDE CTR-B-10 INTO CTR-D-10 GIVING  R-1D-10  ROUNDED.
080500     IF  CTR-B-11  IS NOT EQUAL TO  ZERO
080600     MULTIPLY  DIV-XFACT  BY  CTR-A-11  GIVING  CTR-D-11
080700     DIVIDE CTR-B-11 INTO CTR-D-11 GIVING  R-1D-11  ROUNDED.
080800     IF  CTR-B-12  IS NOT EQUAL TO  ZERO
080900     MULTIPLY  DIV-XFACT  BY  CTR-A-12  GIVING  CTR-D-12
081000     DIVIDE CTR-B-12 INTO CTR-D-12 GIVING  R-1D-12  ROUNDED.
081100
081200 CALCUL-DIVIDE-EXIT.  EXIT.
081300
081400 CALCUL-INDEX  SECTION.
081500
081600     MOVE  0  TO  K.
081700
081800 INDEX-LOOP.
081900
082000     ADD  1  TO  K.
082100     IF  K  >  10  GO TO  TEST-CUMUL.
082200     IF TAB-SUB-IND (K) IS EQUAL TO ZERO GO TO  INDEX-LOOP.
082300     MOVE  TAB-SUB-IND (K)  TO  L.
082400
082500     IF  TAB-SUB-OP (K)  IS EQUAL TO  '-'  GO TO  CALCUL-SUB.
082600
082700     IF  TAB-SUB-TAB (K) = 'D'
082800             ADD  TABDET-01 (L)  TO  R-01
082900             ADD  TABDET-02 (L)  TO  R-02
083000             ADD  TABDET-03 (L)  TO  R-03
083100             ADD  TABDET-04 (L)  TO  R-04
083200             ADD  TABDET-05 (L)  TO  R-05
083300             ADD  TABDET-06 (L)  TO  R-06
083400             ADD  TABDET-07 (L)  TO  R-07
083500             ADD  TABDET-08 (L)  TO  R-08
083600             ADD  TABDET-09 (L)  TO  R-09
083700             ADD  TABDET-10 (L)  TO  R-10
083800             ADD  TABDET-11 (L)  TO  R-11
083900             ADD  TABDET-12 (L)  TO  R-12
084000     ELSE    ADD  TABCUM-01 (L)  TO  R-01
084100             ADD  TABCUM-02 (L)  TO  R-02
084200             ADD  TABCUM-03 (L)  TO  R-03
084300             ADD  TABCUM-04 (L)  TO  R-04
084400             ADD  TABCUM-05 (L)  TO  R-05
084500             ADD  TABCUM-06 (L)  TO  R-06
084600             ADD  TABCUM-07 (L)  TO  R-07
084700             ADD  TABCUM-08 (L)  TO  R-08
084800             ADD  TABCUM-09 (L)  TO  R-09
084900             ADD  TABCUM-10 (L)  TO  R-10
085000             ADD  TABCUM-11 (L)  TO  R-11
085100             ADD  TABCUM-12 (L)  TO  R-12.
085200
085300     GO TO  INDEX-LOOP.
085400
085500 CALCUL-SUB.
085600
085700     IF  TAB-SUB-TAB (K) = 'D'
085800             SUBTRACT  TABDET-01 (L)  FROM  R-01
085900             SUBTRACT  TABDET-02 (L)  FROM  R-02
086000             SUBTRACT  TABDET-03 (L)  FROM  R-03
086100             SUBTRACT  TABDET-04 (L)  FROM  R-04
086200             SUBTRACT  TABDET-05 (L)  FROM  R-05
086300             SUBTRACT  TABDET-06 (L)  FROM  R-06
086400             SUBTRACT  TABDET-07 (L)  FROM  R-07
086500             SUBTRACT  TABDET-08 (L)  FROM  R-08
086600             SUBTRACT  TABDET-09 (L)  FROM  R-09
086700             SUBTRACT  TABDET-10 (L)  FROM  R-10
086800             SUBTRACT  TABDET-11 (L)  FROM  R-11
086900             SUBTRACT  TABDET-12 (L)  FROM  R-12
087000     ELSE    SUBTRACT  TABCUM-01 (L)  FROM  R-01
087100             SUBTRACT  TABCUM-02 (L)  FROM  R-02
087200             SUBTRACT  TABCUM-03 (L)  FROM  R-03
087300             SUBTRACT  TABCUM-04 (L)  FROM  R-04
087400             SUBTRACT  TABCUM-05 (L)  FROM  R-05
087500             SUBTRACT  TABCUM-06 (L)  FROM  R-06
087600             SUBTRACT  TABCUM-07 (L)  FROM  R-07
087700             SUBTRACT  TABCUM-08 (L)  FROM  R-08
087800             SUBTRACT  TABCUM-09 (L)  FROM  R-09
087900             SUBTRACT  TABCUM-10 (L)  FROM  R-10
088000             SUBTRACT  TABCUM-11 (L)  FROM  R-11
088100             SUBTRACT  TABCUM-12 (L)  FROM  R-12.
088200
088300     GO TO  INDEX-LOOP.
088400
088500 TEST-CUMUL.
088600
088700     EXAMINE  TABPRT-CUMUL (J)  REPLACING ALL ' ' BY '0'.
088800
088900     IF  TABPRT-CUMUL (J)  IS LESS THAN  '01'
089000         GO TO  CALCUL-INDEX-EXIT.
089100
089200     MOVE  TABPRT-IND (J)  TO  L.
089300
089400     ADD  R-01  TO  TABCUM-01 (L).
089500     ADD  R-02  TO  TABCUM-02 (L).
089600     ADD  R-03  TO  TABCUM-03 (L).
089700     ADD  R-04  TO  TABCUM-04 (L).
089800     ADD  R-05  TO  TABCUM-05 (L).
089900     ADD  R-06  TO  TABCUM-06 (L).
090000     ADD  R-07  TO  TABCUM-07 (L).
090100     ADD  R-08  TO  TABCUM-08 (L).
090200     ADD  R-09  TO  TABCUM-09 (L).
090300     ADD  R-10  TO  TABCUM-10 (L).
090400     ADD  R-11  TO  TABCUM-11 (L).
090500     ADD  R-12  TO  TABCUM-12 (L).
090600
090700 CALCUL-INDEX-EXIT.  EXIT.
090800
090900 ZEROISE-TABCUM  SECTION.
091000
091100     MOVE  0  TO  I.
091200
091300 ZEROISE-TABCUM-LOOP.
091400
091500     ADD  1  TO  I.
091600     IF  I  >  20  GO TO  ZEROISE-TABCUM-EXIT.
091700
091800     MOVE ZERO  TO  TABCUM-01 (I).
091900     MOVE ZERO  TO  TABCUM-02 (I).
092000     MOVE ZERO  TO  TABCUM-03 (I).
092100     MOVE ZERO  TO  TABCUM-04 (I).
092200     MOVE ZERO  TO  TABCUM-05 (I).
092300     MOVE ZERO  TO  TABCUM-06 (I).
092400     MOVE ZERO  TO  TABCUM-07 (I).
092500     MOVE ZERO  TO  TABCUM-08 (I).
092600     MOVE ZERO  TO  TABCUM-09 (I).
092700     MOVE ZERO  TO  TABCUM-10 (I).
092800     MOVE ZERO  TO  TABCUM-11 (I).
092900     MOVE ZERO  TO  TABCUM-12 (I).
093000     GO TO  ZEROISE-TABCUM-LOOP.
093100
093200 ZEROISE-TABCUM-EXIT. EXIT.
093300
093400 ZEROISE-TABCHA  SECTION.
093500
093600     MOVE  0  TO  I.
093700
093800 ZEROISE-TABCHA-LOOP.
093900
094000     ADD  1  TO  I.
094100     IF  I  >  20  GO TO  ZEROISE-TABCHA-EXIT.
094200
094300     MOVE ' '   TO  TABCHA-CD (I).
094400     MOVE ZERO  TO  TABCHA-01 (I).
094500     MOVE ZERO  TO  TABCHA-02 (I).
094600     MOVE ZERO  TO  TABCHA-03 (I).
094700     MOVE ZERO  TO  TABCHA-04 (I).
094800     MOVE ZERO  TO  TABCHA-05 (I).
094900     MOVE ZERO  TO  TABCHA-06 (I).
095000     MOVE ZERO  TO  TABCHA-07 (I).
095100     MOVE ZERO  TO  TABCHA-08 (I).
095200     MOVE ZERO  TO  TABCHA-09 (I).
095300     MOVE ZERO  TO  TABCHA-10 (I).
095400     MOVE ZERO  TO  TABCHA-11 (I).
095500     MOVE ZERO  TO  TABCHA-12 (I).
095600     GO TO  ZEROISE-TABCHA-LOOP.
095700
095800 ZEROISE-TABCHA-EXIT. EXIT.
095900
096000 ACCUM-MONTH  SECTION.
096100
096200     MOVE  PRT-REP-YTD  TO  PRT-REP-TYPE.
096300     MOVE  0  TO  K.
096400
096500 ACCUM-MONTH-LOOP.
096600
096700     ADD  1  TO  K.
096800     IF  K  >  250  GO TO   ACCUM-MONTH-END.
096900
097000     IF  REP-NBR-YTD  >   1
097100     ADD  TABDET-01 (K)  TO  TABDET-02 (K).
097200     IF  REP-NBR-YTD  >   2
097300     ADD  TABDET-02 (K)  TO  TABDET-03 (K).
097400     IF  REP-NBR-YTD  >   3
097500     ADD  TABDET-03 (K)  TO  TABDET-04 (K).
097600     IF  REP-NBR-YTD  >   4
097700     ADD  TABDET-04 (K)  TO  TABDET-05 (K).
097800     IF  REP-NBR-YTD  >   5
097900     ADD  TABDET-05 (K)  TO  TABDET-06 (K).
098000     IF  REP-NBR-YTD  >   6
098100     ADD  TABDET-06 (K)  TO  TABDET-07 (K).
098200     IF  REP-NBR-YTD  >   7
098300     ADD  TABDET-07 (K)  TO  TABDET-08 (K).
098400     IF  REP-NBR-YTD  >   8
098500     ADD  TABDET-08 (K)  TO  TABDET-09 (K).
098600     IF  REP-NBR-YTD  >   9
098700     ADD  TABDET-09 (K)  TO  TABDET-10 (K).
098800     IF  REP-NBR-YTD  >  10
098900     ADD  TABDET-10 (K)  TO  TABDET-11 (K).
099000     IF  REP-NBR-YTD  >  11
099100         AND REP-DEC-TOT  IS NOT EQUAL TO  'Y'
099200     ADD  TABDET-11 (K)  TO  TABDET-12 (K).
099300     IF  REP-NBR-YTD  <  12
099400         MOVE  ZERO  TO  TABDET-12 (K).
099500     GO TO  ACCUM-MONTH-LOOP.
099600
099700 ACCUM-MONTH-END.  EXIT.
099800
099900 ACCUM-DEC   SECTION.
100000
100100     MOVE  PRT-REP-MTH  TO  PRT-REP-TYPE.
100200
100300     IF  REP-DEC-TOT  IS NOT EQUAL TO  'Y'  GO TO  ACCUM-DEC-END.
100400
100500     MOVE  '  TOT.  '  TO  REP-TIT-12.
100600     MOVE  0  TO  K.
100700
100800 ACCUM-DEC-LOOP.
100900
101000     ADD  1  TO  K.
101100     IF  K  >  256  GO TO  ACCUM-DEC-END.
101200
101300     IF  K  >  250  GO TO  ACCUM-DEC-INVEST.
101400
101500     ADD  TABDET-01 (K)  TO  TABDET-12 (K).
101600     ADD  TABDET-02 (K)  TO  TABDET-12 (K).
101700     ADD  TABDET-03 (K)  TO  TABDET-12 (K).
101800     ADD  TABDET-04 (K)  TO  TABDET-12 (K).
101900     ADD  TABDET-05 (K)  TO  TABDET-12 (K).
102000     ADD  TABDET-06 (K)  TO  TABDET-12 (K).
102100     ADD  TABDET-07 (K)  TO  TABDET-12 (K).
102200     ADD  TABDET-08 (K)  TO  TABDET-12 (K).
102300     ADD  TABDET-09 (K)  TO  TABDET-12 (K).
102400     ADD  TABDET-10 (K)  TO  TABDET-12 (K).
102500     ADD  TABDET-11 (K)  TO  TABDET-12 (K).
102600
102700     GO TO  ACCUM-DEC-LOOP.
102800
102900 ACCUM-DEC-INVEST.
103000
103100     IF  REP-NBR-YTD  =   1
103200     MOVE TABDET-01 (K)  TO  TABDET-12 (K).
103300     IF  REP-NBR-YTD  =   2
103400     MOVE TABDET-02 (K)  TO  TABDET-12 (K).
103500     IF  REP-NBR-YTD  =   3
103600     MOVE TABDET-03 (K)  TO  TABDET-12 (K).
103700     IF  REP-NBR-YTD  =   4
103800     MOVE TABDET-04 (K)  TO  TABDET-12 (K).
103900     IF  REP-NBR-YTD  =   5
104000     MOVE TABDET-05 (K)  TO  TABDET-12 (K).
104100     IF  REP-NBR-YTD  =   6
104200     MOVE TABDET-06 (K)  TO  TABDET-12 (K).
104300     IF  REP-NBR-YTD  =   7
104400     MOVE TABDET-07 (K)  TO  TABDET-12 (K).
104500     IF  REP-NBR-YTD  =   8
104600     MOVE TABDET-08 (K)  TO  TABDET-12 (K).
104700     IF  REP-NBR-YTD  =   9
104800     MOVE TABDET-09 (K)  TO  TABDET-12 (K).
104900     IF  REP-NBR-YTD  =  10
105000     MOVE TABDET-10 (K)  TO  TABDET-12 (K).
105100     IF  REP-NBR-YTD  =  11
105200     MOVE TABDET-11 (K)  TO  TABDET-12 (K).
105300
105400     GO TO  ACCUM-DEC-LOOP.
105500
105600 ACCUM-DEC-END.  EXIT.
105700
105800 CHART-STORE-SECTION  SECTION.
105900
106000     IF  CHART-PRT-REQ IS NOT EQUAL TO 'Y'
106100         GO TO  CHART-STORE-SECTION-END.
106200
106300     MOVE  0  TO  K.
106400
106500 CHART-STORE-LOOP.
106600
106700     ADD  1  TO  K.
106800     IF  K  >  20  GO TO  CHART-STORE-SECTION-END.
106900
107000     IF  TABCHA-CD (K)  =  TABPRT-PLOT (J)
107100         GO TO CHART-STORE-SECTION-END.
107200
107300     IF  TABCHA-CD (K)  IS NOT EQUAL TO  ' '
107400         GO TO CHART-STORE-LOOP.
107500
107600     MOVE  TABPRT-PLOT (J)  TO  TABCHA-CD (K).
107700     MOVE  R-01             TO  TABCHA-01 (K).
107800     MOVE  R-02             TO  TABCHA-02 (K).
107900     MOVE  R-03             TO  TABCHA-03 (K).
108000     MOVE  R-04             TO  TABCHA-04 (K).
108100     MOVE  R-05             TO  TABCHA-05 (K).
108200     MOVE  R-06             TO  TABCHA-06 (K).
108300     MOVE  R-07             TO  TABCHA-07 (K).
108400     MOVE  R-08             TO  TABCHA-08 (K).
108500     MOVE  R-09             TO  TABCHA-09 (K).
108600     MOVE  R-10             TO  TABCHA-10 (K).
108700     MOVE  R-11             TO  TABCHA-11 (K).
108800     MOVE  R-12             TO  TABCHA-12 (K).
108900
109000 CHART-STORE-SECTION-END. EXIT.
109100
109200 CHARTI-SECTION  SECTION.
109300
109400     IF  CHART-PRT-REQ IS NOT EQUAL TO 'Y'
109500         GO TO  CHARTI-SECTION-END.
109600
109700     MOVE  0  TO  K.
109800
109900 CHARTI-LOOP.
110000
110100     ADD  1  TO  K.
110200     IF  K  >  91  GO TO  CHARTI-LOOP-END.
110300
110400     MOVE  K  TO  X (K).
110500     MOVE  0  TO  Y (K).
110600
110700     GO TO  CHARTI-LOOP.
110800
110900 CHARTI-LOOP-END.
111000
111100     MOVE  -1  TO  KSCALE.
111200     MOVE   9  TO  SCALOS (1).
111300     MOVE   0  TO  SCALOS (2).
111400     MOVE  91  TO  SCALOS (3).
111500     MOVE   8  TO  SCALOS (4).
111600     MOVE   0  TO  SCALOS (5).
111700     MOVE   0  TO  SCALOS (6).
111800
111900     MOVE  0  TO  K.
112000
112100 CHARTI-MAX-LOOP.
112200
112300     ADD  1  TO  K.
112400     IF  K  >  20  GO TO  CHARTI-MAX-LOOP-END.
112500
112600     IF  TABCHA-CD (K)  =  ' '  GO TO  CHARTI-MAX-LOOP-END.
112700
112800     IF TABCHA-01 (K)  >  SCALOS (6)
112900       MOVE TABCHA-01 (K)  TO  SCALOS (6).
113000     IF TABCHA-02 (K)  >  SCALOS (6)
113100       MOVE TABCHA-02 (K)  TO  SCALOS (6).
113200     IF TABCHA-03 (K)  >  SCALOS (6)
113300       MOVE TABCHA-03 (K)  TO  SCALOS (6).
113400     IF TABCHA-04 (K)  >  SCALOS (6)
113500       MOVE TABCHA-04 (K)  TO  SCALOS (6).
113600     IF TABCHA-05 (K)  >  SCALOS (6)
113700       MOVE TABCHA-05 (K)  TO  SCALOS (6).
113800     IF TABCHA-06 (K)  >  SCALOS (6)
113900       MOVE TABCHA-06 (K)  TO  SCALOS (6).
114000     IF TABCHA-07 (K)  >  SCALOS (6)
114100       MOVE TABCHA-07 (K)  TO  SCALOS (6).
114200     IF TABCHA-08 (K)  >  SCALOS (6)
114300       MOVE TABCHA-08 (K)  TO  SCALOS (6).
114400     IF TABCHA-09 (K)  >  SCALOS (6)
114500       MOVE TABCHA-09 (K)  TO  SCALOS (6).
114600     IF TABCHA-10 (K)  >  SCALOS (6)
114700       MOVE TABCHA-10 (K)  TO  SCALOS (6).
114800     IF TABCHA-11 (K)  >  SCALOS (6)
114900       MOVE TABCHA-11 (K)  TO  SCALOS (6).
115000     IF TABCHA-12 (K)  >  SCALOS (6)
115100       MOVE TABCHA-12 (K)  TO  SCALOS (6).
115200
115300     GO TO  CHARTI-MAX-LOOP.
115400
115500 CHARTI-MAX-LOOP-END.
115600
115700
115800     ENTER  LINKAGE.
115900     CALL  'CHARTI' USING  NEXX KSCALE SCALES KAXIS AXISID LINEX
116000                          TEXT KPOS POS.
116100     ENTER  COBOL.
116200
116300 CHARTI-SECTION-END.  EXIT.
116400
116500 CHART-SECTION  SECTION.
116600
116700     IF  CHART-PRT-REQ IS NOT EQUAL TO 'Y'
116800         GO TO  CHART-SECTION-END.
116900
117000     MOVE  0  TO  K.
117100
117200 CHART-SETUP-LOOP.
117300
117400     ADD  1  TO  K.
117500     IF  K  >  20  GO TO  CHART-SECTION-END.
117600
117700     IF  TABCHA-CD (K)  =  ' '  GO TO  CHART-SECTION-END.
117800
117900     MOVE  TABCHA-CD (K)  TO  ITYPE.
118000
118100     MOVE  TABCHA-01 (K)  TO  Y (1).
118200     IF  REP-NBR-YTD  >   1
118300     MOVE  TABCHA-02 (K)  TO  Y (9).
118400     IF  REP-NBR-YTD  >   2
118500     MOVE  TABCHA-03 (K)  TO  Y (17).
118600     IF  REP-NBR-YTD  >   3
118700     MOVE  TABCHA-04 (K)  TO  Y (25).
118800     IF  REP-NBR-YTD  >   4
118900     MOVE  TABCHA-05 (K)  TO  Y (33).
119000     IF  REP-NBR-YTD  >   5
119100     MOVE  TABCHA-06 (K)  TO  Y (41).
119200     IF  REP-NBR-YTD  >   6
119300     MOVE  TABCHA-07 (K)  TO  Y (49).
119400     IF  REP-NBR-YTD  >   7
119500     MOVE  TABCHA-08 (K)  TO  Y (57).
119600     IF  REP-NBR-YTD  >   8
119700     MOVE  TABCHA-09 (K)  TO  Y (65).
119800     IF  REP-NBR-YTD  >   9
119900     MOVE  TABCHA-10 (K)  TO  Y (73).
120000     IF  REP-NBR-YTD  >  10
120100     MOVE  TABCHA-11 (K)  TO  Y (81).
120200     IF  REP-NBR-YTD  >  11
120300     MOVE  TABCHA-12 (K)  TO  Y (89).
120400
120500     MOVE  1  TO  M.
120600     MOVE  0  TO  N.
120700
120800 CHART-LOOP-1.
120900
121000     ADD  1  TO  M.
121100     ADD  1  TO  N.
121200     IF  M  >  REP-NBR-YTD  GO TO  CHART-LOOP-END.
121300     IF  M  >  12           GO TO  CHART-LOOP-END.
121400
121500     MOVE  N  TO  O.
121600     ADD  8  TO  O.
121700     MOVE  Y (O)  TO  Y-DIF.
121800     SUBTRACT  Y (N)  FROM  Y-DIF.
121900     DIVIDE  7  INTO  Y-DIF  GIVING  Y-GAP.
122000
122100     MOVE  0  TO  O.
122200
122300 CHART-LOOP-2.
122400
122500     ADD  1  TO  O.
122600     IF  O  >  7  GO TO  CHART-LOOP-1.
122700
122800     MOVE  Y (N)  TO  Y-DIF.
122900     ADD  1  TO  N.
123000     MOVE  Y-DIF  TO  Y (N).
123100     ADD  Y-GAP  TO   Y (N).
123200
123300     GO TO  CHART-LOOP-2.
123400
123500 CHART-LOOP-END.
123600
123700     ENTER  LINKAGE.
123800     CALL  'CHART'  USING  NE  X-TAB  Y-TAB  ITYPE.
123900     ENTER  COBOL.
124000
124100     GO TO CHART-SETUP-LOOP.
124200
124300 CHART-SECTION-END.  EXIT.
124400
124500 CHARTP-SECTION  SECTION.
124600
124700     IF  CHART-PRT-REQ IS NOT EQUAL TO 'Y'
124800         GO TO  CHARTP-SECTION-END.
124900
125000     PERFORM  CHARTI-SECTION.
125100
125200     PERFORM  CHART-SECTION.
125300
125400     PERFORM  OVERFLOW-ROUTINE.
125500
125600     ENTER  LINKAGE.
125700     CALL  'CHARTP'.
125800     ENTER  COBOL.
125900
126000     WRITE PRINT-LINE FROM CHARTP-LINE-MTH.
126100
126200 CHARTP-SECTION-END.  EXIT.
126300
126400 END-PROGRAM  SECTION.
