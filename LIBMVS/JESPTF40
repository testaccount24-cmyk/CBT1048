./ CHANGE NAME=HASPINIT                    PTF AZ15293                  M0000000
         MVC   DCTNO+1(2),=XL4'00'     RESET ROUTE CODE AND OP FLAG     M4662000
./ CHANGE NAME=HASPPRPU                    PTF AZ14412                  Q0000000
         XC    PBUFADDR,PBUFADDR       CLEAR PRIMARY BUFFER ADDR        Q1076500
./ CHANGE NAME=HASPPRPU                    PTF OZ19494  J. NOLS NOV.77  Q0000000
*        THIS LINE REMOVED BY APAR NUMBER OZ19494               OZ19494 Q2074000
         SPACE 2                                                OZ19494 Q2082005
*       THIS AREA OF CODE WILL FORCE A THREE PAGES BACKSPACE    OZ19494 Q2082010
*        IN THE EVENT OF A DATA SET RESTART FOR A REMOTE.       OZ19494 Q2082015
*        THE NUMBER OF PAGES BACKSPACED CAN BE ADJUSTED         OZ19494 Q2082020
*        BY CHANGING THE LITERAL AT SEQUENCE NO Q2082450.       OZ19494 Q2082025
*        THE USER SHOULD BE AWARE THAT THIS CODE WILL CAUSE     OZ19494 Q2082030
*        REMOTE RESTARTS TO BE SLOWER.                          OZ19494 Q2082035
         SPACE 1                                                OZ19494 Q2082040
         TM    PCKJOE,$JOECKV      DATA SET WARM START          OZ19494 Q2082050
         BZ    PDSETUP             BRANCH IF NOT                OZ19494 Q2082100
         TM    PCEID,PCELCLID      TEST PROCESSOR TYPE          OZ19494 Q2082150
         BO    PDSETUP             BRANCH IF LOCAL              OZ19494 Q2082200
         MVC   PCEJMTTR,PDBMTTR    USE CKPT JOE                 OZ19494 Q2082250
         MVI   PBUFSKIP,0          BUF OFFSET FOR RESTART       OZ19494 Q2082300
         L     R1,PDDBPGCT         GET CURRENT PAGE             OZ19494 Q2082350
         N     R1,=X'7FFFFFFF'     FORCE POSITIVE               OZ19494 Q2082400
         S     R1,=F'3'            RECOMPUTE BUF OFFSET         OZ19494 Q2082450
         BNP   *+8                 BRANCH IF NEGATIVE           OZ19494 Q2082500
         ST    R1,PDDBSKIP         SAVE NEW SKIP COUNT          OZ19494 Q2082550
         XC    PDDBPGCT,PDDBPGCT   CLEAR DS PAGE COUNT          OZ19494 Q2082600
         SPACE 1                                                OZ19494 Q2082650
         DROP  PC2                 SUSPEND PDDB ADDRESSABILITY  OZ19494 Q2082700
         SPACE 1                                                OZ19494 Q2082750
PDSETUP  DS    0H                                               OZ19494 Q2092500
./ CHANGE NAME=HASPPRPU                    PTF AZ15275 J. NOLS AUG.77   Q0000000
* THIS AND NEXT 4 LINES DELETED BY APAR NUMBER ====>            AZ15275 Q4549000
*              TO CAUSE $I TO RESTART                           AZ15275 Q4550000
*              AT LAST CHECKPOINT,                              AZ15275 Q4551000
*              TO AVOID LOST OUTPUT OF                          AZ15275 Q4552000
*              REMOTE PRINTERS INTERRUPTED.                     AZ15275 Q4553000
./ CHANGE NAME=HASPCOMM                                                 K0000000
CCJSAVE  EQU   $REGSAVE   REGISTER SAVE AREA                    OZ15839 K5982000
./ CHANGE NAME=HASPRTAM                                                 S0000000
*        THIS LINE REMOVED BY APAR ===>                      * @OZ10379 S0086000
         CLI   PCEID+1,PCEMLMID   LINE MANAGER                  OZ15830 S0352100
         BE    MBTAMXIT             YES,EXIT                    OZ15830 S0352200
         L      R0,PCER0           RELOAD CALLERS BUFFER ADDR  @OZ14415 S0458600
         BCTR  ML,0   FOR LINE LENGTH                           OZ19490 S0586800
         BCTR  ML,0   ADJUST LEGTH FOR MOVE                     OZ19490 S0606800
         LR    ML,0   RESTORE LENGTH FOR COMPRESS               OZ19490 S0607200
MBCNXOPC OC    MDCTDCT,MDCTDCT     IGNORE CONSOLE INPUT        @OZ11766 S0924000
         BZ    MBCNXEND             IF NO RMT SIGNED ON        @OZ11766 S0924100
         L     R0,$MCONPCE         GET ADDR OF RMT CONSOLE PCE @OZ11766 S0924200
         TM    BUFTYPE-BUFDSECT(R1),BUFTP+BUFIOB TEST ASSUMPTN @OZ15298 S0926000
         BO    MBCNXOP             VALID, SKIP                 @OZ15298 S0926500
         SPACE 2                                                OZ16689 S0998100
MSOFOUND TM    RATTYPE,DCTPSNA  TEST FOR SNA TERMINAL           OZ16689 S0998200
         BO    MSOILEGL    BR IF YES, DISALLOW SIGNON           OZ16689 S0998300
*                         THIS LINE DELETED BY APAR NUMBER      OZ16689 S0999000
         TM    BUFTYPE-BUFDSECT(R15),BUFTP+BUFRPL TEST BUFTYPE @OZ15298 S1078500
         BO    MABCON              IF SNA -- TRY NEXT BUFFER   @OZ15298 S1079500
         LA    MCODE,0(MCODE)      CLEAR CONSOLE MSG COUNT     @OZ14446 S1157300
         TM    4(R1),X'C0'         LAST CCW OF CHAIN           @OZ11759 S1259700
         BZ    MEXCP1              BRANCH IF END OF CCWS       @OZ11759 S1259800
MSOSAVE1 EQU   MSAVE+8    SIGN ON REGISTER SAVE AREA            OZ15839 S1307500
MSOSAVE2 EQU   MSAVE+12   SIGN ON REGISTER SAVE AREA            OZ15839 S1308000
MSOSAVE3 EQU   MSAVE+16   SIGN ON REGISTER SAVE AREA            OZ15839 S1308500
         LTR   RRC,RRC             TEST REMAINING LENGTH       @OZ15298 S1432550
         BZ    MVGNOLEN            NO DECREMENT IF ZERO        @OZ15298 S1432560
         BCTR  RRC,0               RESTORE ACTUAL DATA LENGTH  @OZ15298 S1432600
MVGNOLEN ST    RRC,RPLRLEN         UPDATE RPL DATA LENGTH AND  @OZ15298 S1432700
         ST    RRB,RPLAREA          CURRENT BUFFER POINTER     @OZ15298 S1432800
         BO    MVTAMXEX            YES, EXIT WITH EOF          @OZ15298 S1444000
         ST    RRC,RPLRLEN         UPDATE RPL DATA LENGTH AND  @OZ15298 S1550200
         ST    RRB,RPLAREA          CURRENT BUFFER POINTER     @OZ15298 S1550300
         BR    ML                  RETURN TO CALLER            @OZ12271 S1828000
         SLR   RNUM,RBY1           DECREASE DUP FACTOR BY 1    @OZ11807 S2110800
         TM    RPLTYPE,BUFTP+BUFRPL TEST BUFFER TYPE           @OZ15298 S2725000
         BNO   MVFREEC1            GET NEXT BUFFER IF BSC      @OZ15298 S2725500
         SRL   R0,17     HALVE INBOUND LIMIT VALUE              OZ16674 S2784000
         N     R1,=X'0000FFFF'   TRIM CURRENT COUNT             OZ16674 S2784200
         CLR   R1,R0    COMPARE CNT TO 1/2 OF LIMIT             OZ16674 S2784500
         BH    MVFREPRG    IF CNT GT 1/2 OF LIMIT      STILL    OZ16674 S2785000
*                CONGESTED,  DON'T   'RESETS R'                 OZ16674 S2785500
         NI    ICESTAT,255-ICERCVSP   SHOW CONTINUE             OZ16674 S2786100
         L     MBUF,DCTBUFAD       PURGE ANY BUFFER            @OZ12271 S2937530
         BAL   ML,MVFREPRG          THE REMOTE DCT MAY OWN     @OZ12271 S2937560
         LA    ML,MVTAMXAB         ABORT CURRENT $EXTP CALL    @OZ11753 S2937600
         EJECT                                                 @OZ12271 S2938000
         SPACE 1                                               @OZ12271 S2939500
         BNZ   MVRSTRM0   IF YIELDING TO CONTENTION,            OZ18229 S2964500
*                               ABORT PROCESS OR                OZ18229 S2965000
         LA    R0,VXIDGBUF+VSEQGIBB    ELSE SEND                OZ18229 S2965100
         L     WA,$MLLMPCE   NULL RU (BB+EB) UNDER              OZ18229 S2965200
         B     MICEREQ2        THE LINE MANAGER                 OZ18229 S2965300
         BZ    *+8                 BRANCH IF NOT BEGIN BRACKET @OZ10385 S3047000
*        THIS LINE REMOVED BY APAR ===>                      * @OZ10385 S3048000
         DC    AL1(MVDBKBBP-MVDBK)  BB  EB OUTB = BB/EB PENDING@OZ10385 S3053500
*        THIS LINE REMOVED BY APAR ===>                      * @OZ12271 S3059000
MVDBKBBP OI    SHWFLAGS,ICEBBPND   SET 'BEGIN BRACKET PENDING' @OZ10385 S3060100
         SPACE 1                                               @OZ10385 S3060200
         BO    MVDBKIN1            BR IF SECONDARY MAY SEND EB @OZ10385 S3060600
         B     MVDX4004            FAIL IF SECNDRY CANT SEND EB@OZ10385CS3061000
*        THIS LINE REMOVED BY APAR ===>                      * @OZ12271 S3062000
MVDBKINB OI    SHWFLAGS,ICEINBRK   BB/-EB, GO IN BRCKT IMMED.  @OZ10385 S3062100
         SPACE 1                                               @OZ10385 S3062200
MVDBKIN1 TM    BINCMNP,BINBRAK     TEST COMMON NAU PROTOCOLS   @OZ10385 S3062500
         IC    R15,MVDDS(R15)  INDEX TO OFFSET TABLE            OZ17485 S3105500
         TM    FMHSEL,FMHMEDIA  TEST FMH DESTINATION            OZ17485 S3105600
         BNZ   MVDDS(R15)   NOT CONSOLE,ENTER ROUTINE           OZ17485 S3105700
         TM    RPLCHN,RPLONLY    ELSE,TEST ONLYCHAIN            OZ17485 S3105800
         BO    MVDDS(R15) BR IF YES, HANDLE CONSOLE             OZ17485 S3105900
         B     MVDX0811   IF NOT ONLY IN CHAIN,FAIL             OZ17485 S3106000
MVDDS    DC    AL1(MVDDSRES-MVDDS)   BACK TO STREAM             OZ17485 S3107000
*              THIS LINE WAS DELETED BY APAR NUMBER             OZ17485 S3111500
MVDX2002 BAL   R15,MVDXNRSP        SEND NEGATIVE RESPONSE & RTN@OZ10382 S3159500
         DC    AL1(RPLSTATO,X'02',0,0) 'CHAIN STATE ERROR' CODE@OZ10382 S3159600
         SPACE 1                                               @OZ10382 S3159700
MVDX2003 BAL   R15,MVDXNRSP        SEND NEGATIVE RESPONSE & RTN@OZ10382 S3160000
         DC    AL1(RPLSTATO,X'03',0,0) 'BRACKET STATE ERR' CODE@OZ10382 S3160100
         SPACE 1                                               @OZ10382 S3160200
MVDX2004 BAL   R15,MVDXNRSP        SEND NEGATIVE RESPONSE & RTN@OZ10382 S3160500
*        THIS LINE REMOVED BY APAR ===>                      * @OZ10382 S3161000
         DC    AL1(RPLSTATO,X'04',0,0) 'DIRECTION ERROR' CODE  @OZ10382 S3161500
         LR    WA,ML               SAVE 1ST LEVEL RETURN ADDR. @OZ11754 S3223000
         ICM   WA,8,SHWCNTRL        WITH D.F.C. TYPE INDEX     @OZ11754 S3223500
         BAL   ML,MVFRESPD         SEND +RSP AND FREE BUFFER   @OZ11754 S3224000
         LR    ML,WA               RESTORE 1ST LVL RETURN ADDR.@OZ11754 S3224500
         SRL   WA,24               ISOLATE D.F.C. TYPE INDEX   @OZ11754 S3225000
MVDFCNC2 LA    R1,ICERCVST   POINT TO RECEIVE STAT BYTE         OZ17485 S3263500
         TM    ICESTAT,ICEALLOC      TEST FOR ALLOCATED         OZ17485 S3263600
         BZ    MVRSTATC       BR IF NO, RESCIND PENDING FMH     OZ17485 S3263700
         OI    DCTFLAGS,DCTDELET+DCTRSTRT   PRCSR ABORT         OZ17485 S3264000
         TM    BUFTYPE-BUFDSECT(R1),BUFTP+BUFIOB TEST ASSUMPTN @OZ15298 S3296000
         BO    MVDCNSL2            VALID, SKIP NEXT            @OZ15298 S3296500
*        THIS LINE REMOVED BY APAR ===>                      * @OZ14402 S3370000
SCWTSINK DS    0F                  TEMPORARY SAVEWORD, 'RSINK' @OZ14402 S3371800
         LA    MDCT,0(,MDCT)       PURIFY DCT ADDRESSS         @OZ12296 S3601100
         LA    MDCT,0(,MDCT)       PURIFY DCT ADDRESSS         @OZ12296 S3605100
         NI    DCTFLAGS,DCTLOGAL   RESET FLAGS -EXCEPT LOGGING @OZ12273 S3624500
         NI    DCTFLAGS,DCTLOGAL   RESET FLAGS -EXCEPT LOGGING @OZ12273 S3671000
         SPACE 1                                                OZ15843 S3689400
         L     R1,DCTBUFAD  LOAD BUFFER ADDR IN R1              OZ15843 S3689500
         LTR   R1,R1          TEST BUFFER ADDRESS               OZ15843 S3689600
         BZ    MBSCNFB  ZERO  -  DON'T FREE BUFFER              OZ15843 S3689700
         $FREEBUF (R1)    FREE THE BUFFER                       OZ15843 S3689800
MBSCNFB  DS    0H                                               OZ15843 S3689850
         SPACE 1                                                OZ15843 S3689900
         SPACE 1                                               @OZ14442 S3689950
MICEGICD TM    ICEFLAGS,ICECHDIR   TEST FOR CD ALREADY PENDING @OZ11809 S3848300
         BO    MVFREPRG            BR IF YES-- FREE ANY BUFFER @OZ11809 S3848400
         LA    R14,VSEQGICD        SET CD RU CODE IN ICE       @OZ11809 S3848500
         L     R1,$MWORK           GET MESSAGE WORK AREA ADDR  @OZ10384 S3955100
         MVC   0(L'MDSCMSG,R1),MDSCMSG  MOVE MSG TO WORK AREA  @OZ10384 S3955300
         MVC   MDSCRMT-MDSCMSG(L'MDSCRMT,R1),RATNAME AND RMTID @OZ10384 S3955400
         DROP  WA                  RELEASE RAT ADDRESSABILITY  @OZ10384 S3956100
         B     MICEROFF            AND SIGN OFF REMOTE         @OZ10384 S3959000
         SPACE 1                                               @OZ10384 S3959500
*        THIS LINE REMOVED BY APAR ===>                      * @OZ10384 S3960000
*        THIS LINE REMOVED BY APAR ===>                      * @OZ10384 S3960500
*        THIS LINE REMOVED BY APAR ===>                      * @OZ10384 S3961000
*        THIS LINE REMOVED BY APAR ===>                      * @OZ10384 S3961500
MICEDOFF L     R1,MSNAIDL          GET IDLE SNA LINE CHAIN PTR @OZ10384 S3962000
MICEROFF $QSUSE                    REQ ACCESS TO SHARED QUEUES @OZ10384 S3964000
         TM    BUFTYPE,BUFTP+BUFIOB CHECK BUFFER TYPE          @OZ15298 S4055000
         BH    MRETRY  RETRY IF NOT YET EXPIRED                 OZ15840 S4157500
         BE    MRSTLINE            RESTART LINE IF YES         @OZ10359 S4436000
*                     THIS LINE WAS DELETED BY APAR NUMBER      OZ15839 S4482500
*                     THIS LINE WAS DELETED BY APAR NUMBER      OZ15839 S4483000
*                     THIS LINE WAS DELETED BY APAR NUMBER      OZ15839 S4483500
*                     THIS LINE WAS DELETED BY APAR NUMBER      OZ15839 S4484000
*                     THIS LINE WAS DELETED BY APAR NUMBER      OZ15839 S4484500
*                     THIS LINE WAS DELETED BY APAR NUMBER      OZ15839 S4485000
         CLI   MDCTIMOK,255  WAS MODEM ON HOOK                  OZ18200 S4494700
         DC    A(MSNAPBUG)         LOGIC OR TIMING ERROR  +20  @OZ15262 S4551200
MSNAINVL EQU   *-MSNAPTAB          HIGHER = LOGIC ERROR   +24  @OZ15262 S4551500
*                      THIS LINE WAS DELETED BY APAR NUMBER     OZ16674 S4579000
*                      THIS LINE WAS DELETED BY APAR NUMBER     OZ16674 S4579500
*                      THIS LINE WAS DELETED BY APAR NUMBER     OZ16674 S4580000
         SPACE 1                                                OZ16674 S4592700
MSNAPSCA BR    WA          JUST DISPOSE OF THE BUFFER           OZ16674 S4593000
         BNE   *+16                ACCEPT, IF BID REFUSED      @OZ12297 S4615500
         CLI   RPLRTNCD,USFENVER   TEST RPL RETURN CODE        @OZ15262 S4723600
         BE    MSNAPENV            BRANCH IF ENVIRONMENT ERROR @OZ15262 S4723700
         EJECT                                                 @OZ15262 S4723800
*                                                              @OZ15262 S4723900
*                            LOGIC ERRORS DIRECTORY            @OZ15262 S4724000
*                                                              @OZ15262 S4724100
         SPACE 1                                               @OZ15262 S4724200
         CNOP  0,4                 ALIGN TABLE OF FULLWORD     @OZ15262 S4724300
MSNAPBUG LA    R14,RPLFDB2         POINT TO RPL FDBK2 CODE     @OZ15262 S4724400
         BAL   R15,MSNAPDIR        LOOK UP IN DIRECTORY        @OZ15262 S4724500
         SPACE 1                                               @OZ15262 S4724600
*                            CODES MUST APPEAR IN SEQUENCE     @OZ15262 S4724700
         SPACE 1                                               @OZ15262 S4724800
         DC    AL1(USFSINVC),AL3(R01-1) ALL LOWER ARE ERRORS   @OZ15262 S4724900
         DC    AL1(USFSDFR),AL3(MSNAPFLX-1) NO SDT   - FLUSH   @OZ15262 S4725000
         DC    XL1'FF',AL3(R01-1) ALL OTHERS ARE LOGIC ERRORS  @OZ15262 S4725100
* THIS CARD REMOVES APAR OZ11808, SUPERSEDED BY OZ15262        @OZ15262 S4725500
         DC    AL1(USFSBFAL),AL3(MSNAXVTM-1) TERM UNAVAIL/BIND @OZ15262CS4731500
         DC    AL1(USFTAPUA),AL3(R01-1) APPL PASSD LGN REJECT  @OZ15262CS4732500
         DC    AL1(USFVTHAL),AL3(MSNAXVTM-1) Z NET,QUICK CMND  @OZ15262CS4733500
         DC    AL1(USFILRS),AL3(R01-1) INCOMPAT VTAM/NCP DEFN  @OZ15262CS4734500
         DC    AL1(USFPCF),AL3(MSNAXCLS-1) PERM CHNL/LINK FAIL @OZ15262CS4735500
         DC    AL1(USFANS),AL3(MSNAXVTM-1) AUTO NCP SHUTDOWN   @OZ15262CS4737000
         DC    AL1(USFVOFOC),AL3(MSNAXCLS) CANCLD BY VARY DISC @OZ11804 S4737700
*                                     (OPNDST, SEND, RESETSR,  @OZ11804 S4737800
*                                     SESSIONC) - ISSUE CLSDST @OZ11804 S4737900
         DC    AL1(USFDISCO),AL3(R01-1) CNCLD BY VARY/DIAL DISC@OZ15262CS4738000
         DC    AL1(USFUTSCR),AL3(MSNAXCLS-1) UNCOND TERMINATE  @OZ15262CS4739000
         DC    AL1(USFSYERR),AL3(MSNAXVTM-1) VTAM LOGIC ERROR  @OZ15262CS4740500
         DC    AL1(USFDIDIL),AL3(MSNAXVTM-1) DIAL IN/OUT DISC  @OZ15262CS4742000
         DC    AL1(USFVTMNA),AL3(MSNAXVTM-1) VTAM INACT TO JES2@OZ15262CS4743000
         DC    XL1'FF',AL3(R01-1) OTHER CODES ARE LOGIC ERRORS @OZ15262 S4744000
         EJECT                                                 @OZ15262 S4756500
         BNE   MSNALINV            REJECT LOGON REQUEST IF NOT @OZ12295 S4817000
         NI    DCTFLAGS,DCTLOGAL   RESET FLAGS -EXCEPT LOGGING @OZ12273 S4891500
         STH   R1,ICERULEN         SET MAXIMUN R.U. LENGTH     @OZ13246 S4905200
         CLI   RATNUMPU,0  TEST FOR REMOTE PUNCHES              OZ18238 S4907100
         BE    MSNALPUN    NONE,   BR   BIND FOR NO CARDS       OZ18238 S4907200
         OI    19(R15),X'40'    INDICATE CARD OUTPUT            OZ18238 S4907300
MSNALPUN TM    RATFEAT,DCTPPRES    COMPRESSION SELECTED         OZ18238 S4907500
*        THIS LINE REMOVED BY APAR ===>                      * @OZ13246 S4932500
         SRL   R1,4(R15)           FORM 4-BIT MANTISSA         @OZ11810 S4948000
         DC    AL1(0)              SLU SEND PACING COUNT       @OZ15285 S4973000
         DC    B'10000000'     DOCUMENT FORMAT ONLY             OZ18238 S4982500
         DC    AL1(1)              SLU SEND PACING FIXED       @OZ15285 S5001000
         ST    WE,RCPDCTL          SET LINE DCT ADDRESS ...    @OZ15298 S5772200
         ST    WA,RCPDCTBF          BUFFER ADDRESS AND ...     @OZ15298 S5772300
         MVI   RCPTSTAT,0            AND STATUS FLAGS          @OZ15298 S5772400
         MVI   RCPTSEL,FMHCNSLE    SET MEDIUM TO INBOUND CONSLE@OZ10380 S5774200
*        THIS LINE REMOVED BY APAR ===>                      * @OZ15298 S5780000
*        THIS LINE REMOVED BY APAR ===>                      * @OZ15298 S5780500
*        THIS LINE REMOVED BY APAR ===>                      * @OZ15298 S5781000
         EJECT                                                 @OZ15298 S5783600
MCICO    MVI   RCPMAXLR,L'CMBMSG   SET TO READ MAX CMD LENGTH  @OZ15298 S5786500
MCINGET  LA    R1,RCPDCT           INSURE DCT ADDRESSABILITY   @OZ15298 S5786600
         LA    WC,RCPIN            RELOAD PHONY CMB POINT      @OZ15298 S5787000
         BM    MCINCLOS            CLOSE IF EOF                @OZ15298 S5788500
MCINBEOF LA    R1,CMBMSG+L'CMBMSG-1 POINT OT LAST CHARACTER    @OZ15298 S5789000
         TM    MDCTTYPE,DCTPSNA    CHECK DEVICE TYPE           @OZ15298 S5792000
         BO    MCINGET             BR IF SNA, TRY ANOTHER GET  @OZ15298 S5792100
         B     MCIN                GO TRY NEXT BUFFER          @OZ15298 S5792200
         SPACE 1                                               @OZ15298 S5796500
         TM    MDCTTYPE,DCTPSNA    TEST DEVICE TYPE            @OZ15298 S5797000
         BNO   MCINP               BR IF NOT SNA -PROCESS CMB  @OZ15298 S5797500
         L     R1,RPLRLEN-RPLDSECT(,WA)   GET RPL DATA LENGTH  @OZ15298 S5798000
         LTR   R1,R1               CHECK FOR ADDITIONAL DATA   @OZ15298 S5798500
         BNZ   MCISNREQ            BR IF MORE TO REQUEUE RPL   @OZ15298 S5799000
         OI    RCPTSTAT,DCTEOF     SHOW CLOSE EOF WAS REACHED  @OZ15298 S5799500
*        THIS LINE REMOVED BY APAR ===>                      * @OZ15298 S5800000
*        THIS LINE REMOVED BY APAR ===>                      * @OZ15298 S5800500
*        THIS LINE REMOVED BY APAR ===>                      * @OZ15298 S5801000
*        THIS LINE REMOVED BY APAR ===>                      * @OZ15298 S5801500
*        CLOSE REMOTE CONSOLE AND QUEUE MESSAGE                @OZ15298 S5803000
         LA    R1,RCPDCT           RELOAD CONSOLE DCT ADDRESS  @OZ15298 S5804100
         $EXTP CLOSE,(R1)          CLOSE CONSOLE               @OZ15298 S5804200
         B     MCINP               PROCESS CURRENT CMB         @OZ15298 S5804300
         EJECT                                                 @OZ15298 S5804400
***************************************************************@OZ15298 S5804500
*                                                              @OZ15298 S5804600
*        CLOSE REMOTE CONSOLE - GET NEXT QUEUED BUFFER         @OZ15298 S5804700
*                                                              @OZ15298 S5804800
***************************************************************@OZ15298 S5804900
MCINCLOS TM    MDCTTYPE,DCTPSNA    TEST DEVICE TYPE            @OZ15298 S5805000
         BZ    MCINBEOF            IGNORE EOF IF NOT SNA       @OZ15298 S5805500
         $EXTP CLOSE,(R1)          CLOSE REMOTE CONSOLE        @OZ15298 S5805700
         B     MCIN                GO PROCESS MORE INPUT       @OZ15298 S5806000
         SPACE 1                                               @OZ15298 S5806100
************************************************************** @OZ15298 S5806200
*                                                              @OZ15298 S5806300
*        RE-QUEUE INCOMPLETE SNA BUFFERS                       @OZ15298 S5806400
*                                                              @OZ15298 S5806500
************************************************************** @OZ15298 S5806600
MCISNREQ MVC   RPLNEXT-RPLDSECT(4,WA),0(WB)  RE-QUEUE ...      @OZ15298 S5806700
         ST    WA,0(,WB)                      INCOMPLETE RPL   @OZ15298 S5806800
         DROP  WE                  RELEASE DCT ADDRESSABILTY   @OZ15298 S5806900
         B     MCIN                GET MORE INPUT              @OZ15298 S5812000
         NI    MDCTSTAT,255-DCTSINON-DCTSOFF  SHOW ACB CLOSED   OZ14417 S6331600
VEXITLIC LTR   MICE,MICE   CHECK FOR EMPTY ICE TRAY             OZ18228 S6374500
         BNE   VEXITLIC       RETRY IF FAILED                   OZ18228 S6376500
         MVI   RPLREQ,RPLCLOSE     SHOW CLSDST REQUEST TYPE    @OZ10381 S6390500
         MVI   RPLEXTDS,RPLNIB     INDICATE NIB POINTER SET    @OZ10381 S6392500
         MVI   NIBID,NIBIDD        INITIALIZE NIB ID FIELD     @OZ10381 S6394600
         MVI   NIBLEN,NIBLNIB      INITIALIZE NIB LENGTH FIELD @OZ10381 S6394700
         MVC   NIBMODE(8),=CL8'RECORD'  SHOW RECORD MODE IN NIB@OZ10381 S6394800
         MVI   NIBPROCD,PRORPLC    SHOW RPL PROC OPTION        @OZ10381 S6394900
         LA    R13,RPLSAVEA      PROVIDE SAVE AREA TO VTAM      OZ16674 S6512200
         L     R1,PSATOLD-PSADSECT  PICK UP OLD TCB ADDRESS    @OZ10379 S6616000
         LTR   R1,R1               TEST FOR NO TCB ADDR PRESENT@OZ10379 S6616500
         BZ    VPOSTLCK            SKIP MODESETS IF IN SRB MODE@OZ10379 S6617000
./ CHANGE NAME=$DCT                                                     CD000000
MDCTRFXE EQU   *     END OF RMT DCT FOUND. EXT                  OZ15839 CD114500
./ CHANGE NAME=$HCT                                                     DT000000
$REGSAVE DC    16A(0)      NON REENTRANT REG SAVE AREA          OZ15839 DT391500
$MSAVE   DC    5A(0)       RTAM REGISTER SAVE AREA              OZ15839 DT392000
         DC    A(0)     RESERVED FOR FUTURE USE                 OZ15839 DT392500
./ CHANGE NAME=$MLMWORK                                                 EV000000
         DS    0F     ALIGN TO FULLWORD                         OZ15839 EV088200
MSONDCT  DS    CL(MDCTRFXE-DCTDSECT)     BASIC DUMMY RMT DCT    OZ15839 EV088400
MSONDCTB EQU   MSONDCT+DCTBUFAD-DCTDSECT  BUFFER ADDRESS        OZ15839 EV088600
MSONDCTD EQU   MSONDCT+DCTDCB-DCTDSECT    LINE DCT ADDRESS      OZ15839 EV088800
MSONDCTV EQU   MSONDCT+DCTDEVTP-DCTDSECT    DEVICE TYPE         OZ15839 EV089000
MSONDCTT EQU   MSONDCT+MDCTTYPE-DCTDSECT  TERMINAL TYPE         OZ15839 EV089200
./       CHANGE NAME=HRTPSYS3                                   OZ19480 X0000000
         $JNH  BINAKB              TEST FOR TIMEOUT             OZ19480 X6096000
./       CHANGE NAME=HRTPSYS3                                   OZ13263 X0000000
*        THIS LINE DELETED BY APAR NUMBER OZ13263               OZ13263 X3540000
*        THIS LINE DELETED BY APAR NUMBER OZ13263               OZ13263 X3542000
*        THIS LINE DELETED BY APAR NUMBER OZ13263               OZ13263 X3544000
./       CHANGE NAME=HASPCOMM                                   OZ14905 K0000000
CSXNLNE  TM    DCTDEVTP,DCTRJE+DCTPRPU TEST DEVICE TYPE         OZ14905 K3445500
         BO    CSXPOST             SKIP WORK POST IF RPR-RPU    OZ14905 K3445600
         TM    DCTSTAT,DCTINUSE    TEST DEVICE STATUS           OZ14905 K3445700
         BO    CSXPOST             SKIP WORK POST IF IN USE     OZ14905 K3445800
         L     WA,DCTPCE           GET PCE ADDRESS FROM DCT     OZ14905 K3445900
