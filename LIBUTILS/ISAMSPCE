      READ (1,98) ITYPE,LRECL,IDL,KL,NUMREC,MI,IPERCT
   98 FORMAT (3(I4,4X),I2,4X,I6,4X,I1,4X,I3)
      IF (ITYPE-2301) 80,50,45
   45 IF (ITYPE-2321) 50,50,80
   50 IF (KL) 85,110,100
  100 ITYPE=ITYPE+5
  110 ITYPE=ITYPE-2300
      GO TO (0102,0202,0302,80,80,0101,0201,0301,80,80,1102,80,80,1402,
     X80,1101,80,80,1401,80,2102,80,80,80,80,2101),ITYPE
 1101 BN=20+KL+IDL
      BI=81+1.049*(KL+IDL)
      TC=3625
      CT=10
      EN=30+KL
      EI=81+1.049*(KL+10)
      RI=81+1.049*(KL+10+LRECL)
      GO TO 10
 1102 BN=IDL
      BI=61+1.049*IDL
      TC=3625
      CT=10
      EN=10
      EI=71.49
      RI=71.49+LRECL
      GO TO 10
 1401 BN=45+KL+IDL
      BI=146+1.043*(KL+IDL)
      TC=7294
      CT=20
      EN=55+KL
      EI=146+1.043*(KL+10)
      RI=146+1.043*(KL+10+LRECL)
      GO TO 10
 1402 BN=IDL
      BI=101+1.043*IDL
      TC=7294
      CT=20
      EN=10
      EI=111.43
      RI=111.43+LRECL
      GO TO 10
 0201 BN=20+KL+IDL
      BI=81+1.049*(KL+IDL)
      TC=4984
      CT=46
      EN=30+KL
      EI=81+1.049*(KL+10)
      RI=81+1.049*(KL+10+LRECL)
      GO TO 10
 0202 BN=IDL
      BI=61+1.049*IDL
      TC=4984
      CT=46
      EN=10
      EI=71.49
      RI=71.49+LRECL
      GO TO 10
 0301 BN=38+KL+IDL
      BI=146+KL+IDL
      TC=4892
      CT=10
      EN=48+KL
      EI=156+KL
      RI=156+KL+LRECL
      GO TO 10
 0302 BN=IDL
      BI=108+IDL
      TC=4892
      CT=10
      EN=10
      EI=118
      RI=118+LRECL
      GO TO 10
 0101 BN=53+KL+IDL
      BI=186+KL+IDL
      TC=20483
      CT=8
      EN=63+KL
      EI=196+KL
      RI=196+KL+LRECL
      GO TO 10
 0102 BN=IDL
      BI=133+IDL
      TC=20483
      CT=8
      EN=10
      EI=143
      RI=143+LRECL
      GO TO 10
 2101 BN=16+KL+IDL
      BI=100+1.049*(KL+IDL)
      TC=2000
      CT=20
      EN=26+KL
      EI=100+1.049*(KL+10)
      RI=100+1.049*(KL+10+LRECL)
      GO TO 10
 2102 BN=IDL
      BI=84+1.049*IDL
      TC=2000
      CT=20
      EN=10
      EI=94.49
      RI=94.49+LRECL
   10 IBT=1+(TC-BN)/BI
      T=NUMREC/(IBT*(1.*IDL/LRECL))
      RN=EN+LRECL
      IOT=1+(TC-RN)/RI
      IOFT=NUMREC/1000.*IPERCT/IOT+0.999
      IOC=CT/(T/IOFT)+0.999
      IT=1+(TC-EN)/EI
      IC=(2*CT+1)/(IT+2)+0.999
      PC=CT-IOC-IC
      C=T/PC
      CI=(C+1)/IT
      IF (MI) 120,3,120
  120 IF(CI-3) 3,3,125
  125 M=(CI/3+1)/IT+0.999
      IF(M-3) 130,130,1
  130 MM=0
      MMM=0
      GO TO 2
    3 M=0
      MM=0
      MMM=0
      GO TO 2
    1 MM=(M/3.+1)/IT+0.999
      IF(MM-3) 4,4,140
    4 MMM=0
      GO TO 2
  140 MMM=(MM/3.+1)/IT+0.999
    2 MINDX=M+MM+MMM
      ICYLR=C+MINDX/CT+0.999
   75 WRITE (3,76) ICYLR,T,CI,MINDX,IOFT
   76 FORMAT (9X,'TOTAL CYLINDERS REQUIRED = ',I4/9X,'PRIME DATA = ',
     XF8.2,' TRACKS   '/9X,'CYLINDER INDEX = ',F4.0,' TRACKS'/9X,
     X'MASTER INDEX   = ',I2,' TRACKS'/9X,'OVERFLOW TRACKS = ',I4,
     X' TRACKS')
      GO TO 99
   80 WRITE (3,81)
   81 FORMAT (22H INCORRECT DEVICE TYPE)
      GO TO 99
   85 WRITE (3,86)
   86 FORMAT (18H INVALID KEYLENGTH)
   99 STOP
      END
