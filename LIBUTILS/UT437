001    IDENTIFICATION DIVISION.
002    PROGRAM-ID.    'UT437'.
003    AUTHOR.        PMF.
004    DATE-WRITTEN.  20 JAN 72.
005    REMARKS.  TO AVOID LOADING N TRAYS OF CARDS MORE THAN ONCE
006    ENVIRONMENT DIVISION.
007    CONFIGURATION SECTION.
008    SOURCE-COMPUTER. IBM-360.
009    OBJECT-COMPUTER. IBM-360.
010    INPUT-OUTPUT SECTION.
011    FILE-CONTROL.
012        SELECT INF ASSIGN TO 'SYSUT1'   UTILITY.
013        SELECT INC ASSIGN TO 'SYSIN'    UTILITY.
014        SELECT OTF ASSIGN TO 'SYSUT2'   UTILITY.
015        SELECT OTP ASSIGN TO 'SYSPRINT' UTILITY.
016    DATA DIVISION.
017    FILE SECTION.
018    FD  INF
019        RECORDING F
020        BLOCK 0 RECORDS
021        LABEL RECORDS STANDARD
022        DATA RECORD INREC.
023    01  FILLER PICTURE X(80).
024    FD  INC
025        RECORDING F
026        BLOCK 1 RECORDS
027        LABEL RECORDS STANDARD
028        DATA RECORD INCARD.
029    01  FILLER      PICTURE X(80).
035    FD  OTF
036        RECORDING F
037        BLOCK 0 RECORDS
038        LABEL RECORDS STANDARD
039        DATA RECORD OTREC.
040    01  OTREC PICTURE X(80).
041    FD  OTP
042        RECORDING F
043        BLOCK 1 RECORDS
044        LABEL RECORDS STANDARD
045        DATA RECORD PRLINE.
046    01  PRLINE PICTURE X(133).
047    WORKING-STORAGE SECTION.
048    77  RECOUNT PICTURE 99999 VALUE ZERO.
049    77  INCOUNT PICTURE 99999 VALUE ZERO.
0491   77  I       PICTURE 99999 VALUE ZERO.
0492   77  J       PICTURE 99999 VALUE ZERO.
050    77  ONE     PICTURE 99999 VALUE 1.
051    77  LCNT    PICTURE 99999 VALUE 56.
052    77  SPACER  PICTURE X.
0521   01  INREC PICTURE X(80).
0522   01  INCARD.
0523       03  INSEQ   PICTURE 99999.
0524       03  INSEX   PICTURE XXXXX REDEFINES INSEQ.
0525       03  INALPHA PICTURE X.
0526       03   INSEQX PICTURE XXXXX.
0527       03   INSEQ2 PICTURE 99999 REDEFINES INSEQX.
0528       03   FILLER PICTURE X(69).
053    01  PRINTX.
054        03  FILLER PICTURE X(20) VALUE SPACE.
055        03  PRSEQ   PICTURE 99999.
056        03  FILLER   PICTURE XXXXX VALUE SPACE.
057        03  PRCARD   PICTURE X(80).
058    01  HEADA.
059        03 FILLER PICTURE X(30) VALUE '                     SEQ.'.
060        03 FILLER   PICTURE X(80) VALUE '0--------1---------2--------
061   -    '-3---------4---------5---------6---------7---------8'.
062    01  HEADB.
063        03  FILLER PICTURE X(30) VALUE '                      NO.'.
064        03  FILLER  PICTURE X(80) VALUE '1234567890123456789012345678
065   -    '9012345678901234567890123456789012345678901234567890'.
066    PROCEDURE DIVISION.
067    INITX.
068        OPEN INPUT INF.
069        OPEN INPUT INC.
070        OPEN OUTPUT OTF.
071        OPEN OUTPUT OTP.
072        READ INF INTO INREC AT END GO TO P1.
073        ADD ONE TO INCOUNT.
074        READ INC INTO INCARD AT END MOVE 99999 TO INSEQ.
075    A1. IF INCOUNT = INSEQ GO TO B1.
076        MOVE INREC TO OTREC, PRCARD.
077        ADD ONE TO LCNT.
078        ADD ONE TO RECOUNT.
079        MOVE RECOUNT TO PRSEQ.
080        PERFORM X1.
081        WRITE OTREC.
082        READ INF INTO INREC AT END GO TO C1.
083        ADD ONE TO INCOUNT.
084        GO TO A1.
085    B1. IF INALPHA = 'A' GO TO B2.
086        IF INALPHA = 'R' GO TO B3.
087    B13. READ INF INTO INREC AT END GO TO C15.
088        ADD ONE TO INCOUNT.
089        IF INSEQX = SPACE GO TO B15.
090        IF INCOUNT > INSEQ2 GO TO B15.
091        GO TO B13.
092    B15. READ INC INTO INCARD AT END MOVE 99999 TO INSEQ.
093        GO TO A1.
0931   B2.  IF INSEQX = SPACE MOVE 1 TO J ELSE MOVE INSEQ2 TO J.
0932       MOVE ZERO TO I.
0933   B25. ADD 1 TO I.
0934       IF I > J GO TO B27.
094        READ INC INTO INCARD AT END MOVE 99999 TO INSEQ GO TO A1.
095        MOVE INCARD TO OTREC, PRCARD.
096        ADD ONE TO LCNT.
097        ADD ONE TO RECOUNT.
098        MOVE RECOUNT TO PRSEQ.
099        PERFORM X1.
100        WRITE OTREC.
1001       GO TO B25.
101    B27. READ INC INTO INCARD AT END MOVE 99999 TO INSEQ.
102        GO TO A1.
10301  B3. READ INC INTO INCARD AT END MOVE 99999 TO INSEQ GO TO A1.
10302      MOVE INCARD TO OTREC, PRCARD.
10303      ADD ONE TO LCNT.
10304      ADD ONE TO RECOUNT.
10305      MOVE RECOUNT TO PRSEQ.
10306      PERFORM X1.
10307      WRITE OTREC.
10307      READ INC INTO INCARD AT END MOVE 99999 TO INSEQ.
104        READ INF INTO INREC AT END GO TO C1.
105        ADD ONE TO INCOUNT.
106        GO TO A1.
1065   C15. READ INC INTO INCARD AT END MOVE 99999 TO INSEQ GO TO C1.
107    C1. IF INSEX = '99999' GO TO Z1.
108        READ INC INTO INCARD AT END MOVE 99999 TO INSEQ GO TO C1.
109        MOVE INCARD TO OTREC, PRCARD.
110        ADD ONE TO LCNT.
111        ADD ONE TO RECOUNT.
112        MOVE RECOUNT TO PRSEQ.
113        PERFORM X1.
114        WRITE OTREC.
116        GO TO C1.
117    P1. READ INC INTO INCARD AT END GO TO Z1.
118        MOVE INCARD TO OTREC, PRCARD.
119        ADD ONE TO LCNT.
120        ADD ONE TO RECOUNT.
121        MOVE RECOUNT TO PRSEQ.
122        PERFORM X1.
123        WRITE OTREC.
124        GO TO P1.
125    X1. IF LCNT > 55
126            MOVE '1' TO SPACER
127            MOVE HEADA TO PRLINE
128            WRITE PRLINE AFTER SPACER
129            MOVE SPACE TO SPACER
130            MOVE HEADB TO PRLINE
131            WRITE PRLINE AFTER SPACER
132            MOVE SPACE TO PRLINE
133            WRITE PRLINE AFTER SPACER
134            MOVE ZERO TO LCNT.
135        MOVE PRINTX TO PRLINE.
136        WRITE PRLINE AFTER SPACER.
137    Z1. CLOSE INF.
138        CLOSE OTF.
139        CLOSE INC.
140        CLOSE OTP.
141        STOP RUN.
