000100 IDENTIFICATION  DIVISION.
000200
000300 PROGRAM-ID. 'T580P320'.
000400
000500 REMARKS.    THIS SUB-PROGRAM WILL BE CALLED BY RPG
000600             IN ORDER TO CONVERT SMF RECORD HEADER INTO
000700             YYDDD-HHMMSS-TYP CHARACTER FORMAT.
000800
000900 ENVIRONMENT DIVISION.
001000
001100 CONFIGURATION SECTION.
001200 SOURCE-COMPUTER. IBM-360.
001300 OBJECT-COMPUTER. IBM-360.
001400
001500 INPUT-OUTPUT SECTION.
001600 FILE-CONTROL.
001700 DATA DIVISION.
001800 FILE SECTION.
001900 WORKING-STORAGE SECTION.
002000
002100 01  DUMMY.
002200
002300     03  DUMMY-BINARY        PICTURE 9(8)   COMPUTATIONAL.
002400     03  DUMMY-CHAR  REDEFINES  DUMMY-BINARY  PICTURE  XXXX.
002500
002600 01  DUMMY-TIME.
002700     03  TIME-PACK           PICTURE S9(7)  COMPUTATIONAL-3.
002800     03  TIME-HHMMSS         PICTURE S9(5)  COMPUTATIONAL-3.
002900     03  TIME-MMSS           PICTURE S9(5)  COMPUTATIONAL-3.
003000     03  TIME-SS             PICTURE S9(5)  COMPUTATIONAL-3.
003100     03  TIME-CALC           PICTURE S9(5)  COMPUTATIONAL-3.
003200     03  SS                  PICTURE S9(5)  COMPUTATIONAL-3.
003300     03  HH                  PICTURE S9(5)  COMPUTATIONAL-3.
003400     03  MM                  PICTURE S9(5)  COMPUTATIONAL-3.
003500
003600 01  DUMMY-TYPE.
003700     03  REC-IN-BIN          PICTURE 9999 COMPUTATIONAL.
003800     03  REC-IN-CHAR  REDEFINES REC-IN-BIN.
003900         05  FILLER          PICTURE X.
004000         05  REC-IN-TYPE     PICTURE X.
004100     03  REC-OUT-NUM         PICTURE 9999.
004200     03  REC-OUT-CHAR  REDEFINES REC-OUT-NUM.
004300         05  FILLER          PICTURE X.
004400         05  REC-OUT-TYPE    PICTURE XXX.
004500
004600 LINKAGE SECTION.
004700
004800 01  LINK-FIELD2.
004900     03  FIELD2-NOT-USED     PICTURE  X.
005000
005100 01  LINK-FIELD3.
005200     03  FIELD3-POINTER      PICTURE  X.
005300     03  FILLER              PICTURE  X.
005400     03  INPUT-TYPE          PICTURE  X.
005500     03  INPUT-TIME          PICTURE  XXXX.
005600     03  FILLER              PICTURE  X.
005700     03  INPUT-DATE          PICTURE S9(5)  COMPUTATIONAL-3.
005800     03  FILLER              PICTURE  XXXX.
005900
006000 01  LINK-FIELD4.
006100     03  FIELD4-POINTER      PICTURE  X.
006200     03  OUTPUT-DATE         PICTURE  99999.
006300     03  OUTPUT-TIME.
006400         05  OUTPUT-HH       PICTURE  99.
006500         05  OUTPUT-MM       PICTURE  99.
006600         05  OUTPUT-SS       PICTURE  99.
006700     03  OUTPUT-TYPE         PICTURE  999.
006800
006900 PROCEDURE DIVISION.
007000
007100 START-OF-ROUTINE.
007200
007300     ENTER LINKAGE.
007400     ENTRY 'T580A320' USING  LINK-FIELD2
007500                            LINK-FIELD3
007600                            LINK-FIELD4.
007700
007800     ENTER  COBOL.
007900
008000     MOVE  0  TO  REC-IN-BIN.
008100     MOVE  INPUT-TYPE  TO  REC-IN-TYPE.
008200     MOVE  REC-IN-BIN  TO  REC-OUT-NUM.
008300     MOVE  REC-OUT-NUM  TO  OUTPUT-TYPE.
008400
008500     MOVE  INPUT-DATE  TO  OUTPUT-DATE.
008600
008700     MOVE  INPUT-TIME  TO  DUMMY-CHAR.
008800     MOVE  DUMMY-BINARY  TO  TIME-PACK.
008900     MULTIPLY  TIME-PACK   BY  0.01
009000       GIVING  TIME-HHMMSS.
009100     DIVIDE  3600  INTO  TIME-HHMMSS
009200       GIVING  HH.
009300     MULTIPLY  HH  BY  3600
009400       GIVING  TIME-CALC.
009500     SUBTRACT  TIME-CALC  FROM  TIME-HHMMSS
009600       GIVING  TIME-MMSS.
009700     DIVIDE  60  INTO  TIME-MMSS
009800       GIVING  MM.
009900     MULTIPLY  MM  BY  60
010000       GIVING  TIME-CALC.
010100     SUBTRACT  TIME-CALC  FROM  TIME-MMSS
010200       GIVING  TIME-SS.
010300     DIVIDE  1  INTO  TIME-SS
010400       GIVING  SS.
010500
010600     MOVE  HH  TO  OUTPUT-HH.
010700     MOVE  MM  TO  OUTPUT-MM.
010800     MOVE  SS  TO  OUTPUT-SS.
010900
011000 END-OF-ROUTINE.
011100
011200     ENTER LINKAGE.
011300     RETURN.
011400     ENTER COBOL.
011500
011600 END-OF-PROGRAM  SECTION.
