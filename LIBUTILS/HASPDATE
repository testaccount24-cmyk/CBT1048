000100 IDENTIFICATION  DIVISION.
000200
000300 PROGRAM-ID. 'HASPDATE'.
000400
000500 REMARKS.    THIS SUB-PROGRAM WILL BE CALLED BY RPG
000600             IN ORDER TO CONVERT SMF RECORD HEADER INTO
000700             YYDDD-HHMMSS-TYP CHARACTER FORMAT.
000800
000900 ENVIRONMENT DIVISION.
001000
001100 CONFIGURATION SECTION.
001200 SOURCE-COMPUTER. IBM-360.
001300 OBJECT-COMPUTER. IBM-360.
001400
001500 INPUT-OUTPUT SECTION.
001600 FILE-CONTROL.
001700 DATA DIVISION.
001800 FILE SECTION.
001900 WORKING-STORAGE SECTION.
002000
002100 01  DUMMY.
002200
002300     03  DUMMY-BINARY        PICTURE 9(8)   COMPUTATIONAL
002400                                            VALUE ZERO.
002500     03  DUMMY-CHAR-FIL  REDEFINES  DUMMY-BINARY.
002600         05  FILLER          PICTURE  X.
002700         05  DUMMY-CHAR      PICTURE  XXX.
002800
002900 01  DUMMY-TIME.
003000     03  TIME-PACK           PICTURE S9(7)  COMPUTATIONAL-3.
003100     03  TIME-HHMMSS         PICTURE S9(5)  COMPUTATIONAL-3.
003200     03  TIME-MMSS           PICTURE S9(5)  COMPUTATIONAL-3.
003300     03  TIME-SS             PICTURE S9(5)  COMPUTATIONAL-3.
003400     03  TIME-CALC           PICTURE S9(5)  COMPUTATIONAL-3.
003500     03  SS                  PICTURE S9(5)  COMPUTATIONAL-3.
003600     03  HH                  PICTURE S9(5)  COMPUTATIONAL-3.
003700     03  MM                  PICTURE S9(5)  COMPUTATIONAL-3.
003800
003900 LINKAGE SECTION.
004000
004100 01  LINK-FIELD2.
004200     03  FIELD2-NOT-USED     PICTURE  X.
004300
004400 01  LINK-FIELD3.
004500     03  FIELD3-POINTER      PICTURE  X.
004600     03  INPUT-DATE          PICTURE S9(5)  COMPUTATIONAL-3.
004700     03  INPUT-TIME          PICTURE  XXX.
004800
004900 01  LINK-FIELD4.
005000     03  FIELD4-POINTER      PICTURE  X.
005100     03  OUTPUT-DATE         PICTURE  99999.
005200     03  OUTPUT-TIME.
005300         05  OUTPUT-HH       PICTURE  99.
005400         05  OUTPUT-MM       PICTURE  99.
005500         05  OUTPUT-SS       PICTURE  99.
005600
005700 PROCEDURE DIVISION.
005800
005900 START-OF-ROUTINE.
006000
006100     ENTER LINKAGE.
006200     ENTRY 'HASPDATX' USING  LINK-FIELD2
006300                            LINK-FIELD3
006400                            LINK-FIELD4.
006500
006600     ENTER  COBOL.
006700
006800     MOVE  INPUT-DATE  TO  OUTPUT-DATE.
006900
007000     MOVE  0  TO  DUMMY-BINARY.
007100     MOVE  INPUT-TIME  TO  DUMMY-CHAR.
007200     MOVE  DUMMY-BINARY  TO  TIME-PACK.
007300     MULTIPLY  TIME-PACK   BY  0.01
007400       GIVING  TIME-HHMMSS.
007500     DIVIDE  3600  INTO  TIME-HHMMSS
007600       GIVING  HH.
007700     MULTIPLY  HH  BY  3600
007800       GIVING  TIME-CALC.
007900     SUBTRACT  TIME-CALC  FROM  TIME-HHMMSS
008000       GIVING  TIME-MMSS.
008100     DIVIDE  60  INTO  TIME-MMSS
008200       GIVING  MM.
008300     MULTIPLY  MM  BY  60
008400       GIVING  TIME-CALC.
008500     SUBTRACT  TIME-CALC  FROM  TIME-MMSS
008600       GIVING  TIME-SS.
008700     DIVIDE  1  INTO  TIME-SS
008800       GIVING  SS.
008900
009000     MOVE  HH  TO  OUTPUT-HH.
009100     MOVE  MM  TO  OUTPUT-MM.
009200     MOVE  SS  TO  OUTPUT-SS.
009300
009400 END-OF-ROUTINE.
009500
009600     ENTER LINKAGE.
009700     RETURN.
009800     ENTER COBOL.
009900
010000 END-OF-PROGRAM  SECTION.
